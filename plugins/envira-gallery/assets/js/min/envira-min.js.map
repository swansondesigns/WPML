{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./assets/js/envira.js","webpack:///./assets/js/gallery-init.js","webpack:///./assets/js/gallery-link.js","webpack:///./assets/js/lib/enviraJustifiedGallery-extensions.js","webpack:///./assets/js/lib/enviraLazy.js","webpack:///./assets/js/lib/envirabox-fullscreen.js","webpack:///./assets/js/lib/envirabox-guestures.js","webpack:///./assets/js/lib/envirabox-media.js","webpack:///./assets/js/lib/envirabox-slideshow.js","webpack:///./assets/js/lib/envirabox-thumbs.js","webpack:///./assets/js/lib/envirabox-wheel.js","webpack:///./assets/js/lib/envirabox.js","webpack:///./assets/js/lib/enviratope-item.js","webpack:///./assets/js/lib/imagesloaded.js","webpack:///./assets/js/lib/isotope.js","webpack:///./assets/js/lib/jquery.justifiedGallery.js","webpack:///./assets/js/lib/layout-mode.js","webpack:///./assets/js/lib/layout-modes/fit-rows.js","webpack:///./assets/js/lib/layout-modes/masonry.js","webpack:///./assets/js/lib/layout-modes/vertical.js","webpack:///./assets/js/lib/mousewheel.js","webpack:///./assets/js/lib/pollyfills.js","webpack:///./node_modules/desandro-matches-selector/matches-selector.js","webpack:///./node_modules/ev-emitter/ev-emitter.js","webpack:///./node_modules/fizzy-ui-utils/utils.js","webpack:///./node_modules/get-size/get-size.js","webpack:///./node_modules/masonry-layout/masonry.js","webpack:///./node_modules/outlayer/item.js","webpack:///./node_modules/outlayer/outlayer.js","webpack:///external \"jQuery\""],"names":["envira_galleries","window","envira_links","$","document","Envira","Envira_Link","envira_gallery","on","e","stopPropagation","envira_galleries_total","each","$this","$id","data","$envira_galleries","$envira_images","$envira_lightbox","$suffix_id","undefined","parseInt","trigger","debug","console","log","location","pathname","replace","hostname","envirabox","close","event","envira_container","image_id","video_id","gallery_id","find","length","hasClass","closest","delay","show","envira_lazy_width","width","ratio1","naturalHeight","naturalWidth","ratio2","ratio","padding_bottom","parent","div_envira_lazy","caption_height","height","css","attr","div_overlay","laidOutItems","jQuery","id","images","lightbox","self","envirabox_config","initImage","init","get_config","justified","preventDefault","load_images","scroll","enviratopes","one","enviraLazy","run","enviraImagesLoaded","done","setTimeout","enviratope","progress","enviraJustifiedGallery","rowHeight","is_mobile","maxRowHeight","waitThumbnailsLoad","selector","lastRow","border","margins","envira_isotopes_config","itemSelector","masonry","columnWidth","touch_general","vertical","momentum","thumbs_hide_on_open","thumbs_rowHeight","thumbs","autoStart","hideOnClose","position","get_lightbox_config","slideshow","speed","fullscreen","animationEffect","transitionEffect","lightbox_images","overlay_divs","lightbox_options","loop","margin","gutter","keyboard","arrows","arrow_position","infobar","toolbar","idleTime","smallBtn","protect","image","preload","animationDuration","btnTpl","zoomOpacity","transitionDuration","baseTpl","spinnerTpl","errorTpl","fullScreen","touch","hash","insideCap","capPosition","capTitleShow","media","youtube","params","autoplay","wheel","slideShow","mobile","clickContent","current","clickSlide","dblclickContent","dblclickSlide","clickOutside","dblclickOutside","videoPlayPause","videoProgressBar","videoPlaybackTime","videoVideoLength","videoVolumeControls","videoControlBar","videoFullscreen","videoDownload","videoPlayIcon","onInit","instance","beforeLoad","afterLoad","beforeShow","lightbox_theme","currIndex","hide","Object","keys","group","afterShow","prepend","prepend_cap","prependTo","$content","keypress","indexOf","keyCode","html","opts","caption","beforeClose","afterClose","onActivate","onDeactivate","the_images","i","video","embed_url","src","push","newIndex","$images","stopImmediatePropagation","index","found","entries","forEach","entry","key","value","prop","open","test","navigator","userAgent","module","exports","type","format","url","rez","param","video_defaults","youtube_playlist","matcher","autohide","fs","rel","hd","wmode","enablejsapi","html5","paramPlace","thumb","vimeo","show_title","show_byline","show_portrait","muted","api","metacafe","dailymotion","additionalInfos","facebook","subtype","instagram","instagram_tv","instagram_video","wistia","twitch","videopress","self_hosted","pdf","link","urlParams","o","provider","extend","n","el","match","substring","split","m","p","decodeURIComponent","call","item","videos_autoplay","iframe","scrolling","contentProvider","sorted_ids","sorting_factor","gallery_sort","sorting_factor_data","active","getInstance","val","justifiedGallery","fn","EnviraJustifiedGallery","obj","apply","arguments","displayEntryCaption","$entry","$image","imgFromEntry","settings","captions","$imgCaption","captionFromEntry","revised_caption","text","isValidCaption","after","cssAnimation","stop","fadeTo","captionSettings","nonVisibleOpacity","imgCaptionHeight","addCaptionEventsHandlers","removeCaptionEventsHandlers","hasWebPSupport","windowWidth","windowHeight","justifiedReady","galleryClass","hasIntersectionObserverSupport","IntersectionObserver","isVisible","element","innerWidth","documentElement","clientWidth","body","innerHeight","clientHeight","rect","getBoundingClientRect","elementTop","top","elementLeft","left","elementWidth","elementHeight","exists","updateElement","container","options","getAttribute","trim","temp","optionsCount","j","option","spaceIndex","lastIndexOf","optionImage","optionWidth","substr","add","sort","a","b","containerWidth","offsetWidth","devicePixelRatio","bestSelectedOption","optionData","lastSetOption","fireEvent","Image","addEventListener","setAttribute","handler","Function","bind","onload","not","the_image","firstElementChild","the_container","image_src","item_id","onerror","error","updateWindowSize","setGalleryClass","theClass","alert","update","elements","unknownHeight","elementsCount","parentNode","ll_delay","ll_initial","myVar","querySelectorAll","createElement","updateIntersectionObservers","responsivelyLazyObserverAttached","intersectionObserver","observe","intersectionRatio","target","tagName","toLowerCase","img","querySelector","requestAnimationFrameFunction","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","callback","hasChange","runIfHasChange","setChanged","updateParentNodesScrollListeners","responsivelyLazyScrollAttached","attachEvents","resizeTimeout","clearTimeout","MutationObserver","observer","childList","subtree","readyState","fnMap","ret","defaults","FullScreen","request","elem","requestFullscreen","ALLOW_KEYBOARD_INPUT","exit","exitFullscreen","toggle","isFullscreen","Boolean","fullscreenElement","enabled","fullscreenEnabled","$container","$button","$refs","keycode","fullscreenchange","isAnimating","requestAFrame","oRequestAnimationFrame","cancelAFrame","cancelAnimationFrame","webkitCancelAnimationFrame","mozCancelAnimationFrame","oCancelAnimationFrame","pointers","result","originalEvent","touches","changedTouches","pageX","x","y","pageY","clientX","clientY","distance","point2","point1","what","Math","sqrt","pow","isClickable","$el","is","isFunction","get","onclick","atts","attributes","nodeName","hasScrollbars","overflowY","getComputedStyle","overflowX","scrollHeight","horizontal","scrollWidth","isScrollable","Guestures","$bg","bg","$stage","stage","destroy","proxy","prototype","off","ontouchstart","$target","isTouchDevice","isClosing","button","offset","startPoints","isSliding","canTap","canPan","isMobile","canvasWidth","round","$slide","canvasHeight","startTime","Date","getTime","distanceX","distanceY","isPanning","isSwiping","isZooming","sliderStartPos","sliderLastPos","contentStartPos","getTranslate","contentLastPos","addClass","hasError","isLoaded","$ghost","centerPointStartX","scrollLeft","centerPointStartY","scrollTop","percentageOfImageAtPinchPointX","percentageOfImageAtPinchPointY","startDistanceBetweenFingers","ontouchmove","newPoints","onSwipe","onPan","onZoom","swiping","angle","abs","atan2","PI","slides","slide","inTransition","pos","SlideShow","isActive","requestId","currPos","setTranslate","newOffsetX","newOffsetY","newPos","limitMovement","scaleX","scaleY","newWidth","newHeight","minTranslateX","minTranslateY","maxTranslateX","maxTranslateY","currentOffsetX","currentOffsetY","max","min","limitPosition","currentWidth","currentHeight","endDistanceBetweenFingers","pinchRatio","floor","translateFromZoomingX","translateFromZoomingY","centerPointEndX","centerPointEndY","translateFromTranslatingX","translateFromTranslatingY","ontouchend","dMs","panning","zooming","endPoints","removeClass","onTap","velocityX","velocityY","speedX","endPanning","endZooming","endSwiping","animate","opacity","previous","next","jumpTo","reset","scaleToFit","scaleToActual","content","tapX","tapY","where","process","prefix","action","startEvent","toggleControls","isScaledDown","has","tapped","gmap_place","gmap_search","url_to_check","$thumb","slideClass","timer","set","idleSecondsCounter","showControls","clear","start","i18n","lang","PLAY_STOP","isComplete","PLAY_START","firstRun","activeElement","hidden","FancyThumbs","$grid","$list","handled","first","second","create","list","$the_height","thumbnail_play_icon","$row","appendTo","tmpImg","$parent","thumbWidth","outerWidth","thumbHeight","outerHeight","widthRatio","heightRatio","focus","children","filter","toggleClass","Thumbs","modal","prevTime","currTime","deltaY","deltaX","wheelDelta","detail","info","stuff","buttons","ajax","tpl","genericDiv","baseClass","download","exif","arrowLeft","arrowRight","parentEl","autoFocus","backFocus","trapFocus","axis","noop","CLOSE","NEXT","PREV","ERROR","FULL_SCREEN","THUMBS","$W","$D","called","isQuery","hasOwnProperty","transitionEnd","t","transitions","style","forceRedraw","offsetHeight","mergeOpts","opts1","opts2","isArray","EnviraBox","prevIndex","prevPos","createGroup","$lastFocus","blur","testWidth","buttonStr","firstItemOpts","append","translate","remove","activate","str","arr","items","makeArray","$item","srcParts","isPlainObject","srcset","$orig","videoFormat","charAt","title","shift","addEvents","removeEvents","which","isIdle","idleInterval","setInterval","hideControls","clearInterval","duration","currentPos","transitionProps","groupLen","createSlide","updateControls","isMoved","forcedDuration","isNumeric","loadSlide","removeAttr","complete","revealContent","updateSlide","$what","imgPos","posX","posY","newImgWidth","newImgHeight","updateCursor","end","getFitPos","imgWidth","imgHeight","minRatio","nextWidth","nextHeight","isZoomable","fitPos","ajaxLoad","isLoading","setImage","setVideo","setIframe","setGenericDiv","setContent","setError","showLoading","success","textStatus","jqXHR","abort","hideLoading","empty","style_width","style_height","videoWidthHeight","videoControls","videoControlsList","videoClasses","videoWidth","videoHeight","itemID","enviraItemId","output","posterImage","videoPlaceholder","playsInline","videoPlaysInline","video_source","pxRatio","map","postfix","setBigImage","$img","timouts","$iframe","css_width","css_height","isReady","$contents","$body","contents","ignore","frameWidth","ceil","frameHeight","$genericDiv","$placeholder","insertAfter","nodeType","$smallBtn","$spinner","effect","effectClassName","getThumbPos","isElementVisible","elementRect","parentRects","visibleInAllParents","parentElement","every","parentRect","visiblePixelX","right","visiblePixelY","bottom","thumbPos","slidePos","ownerDocument","parseFloat","siblings","prev","uid","d","cleanUp","name","args","Array","slice","unshift","force","$caption","$title","isHiddenControls","version","command","all","createTouch","use3d","div","getPropertyValue","documentMode","matrix","eq","transRegex","transRez","exec","props","transform","to","leaveAnimationName","propertyName","_run","currentTarget","factory","define","Outlayer","Item","proto","_create","layout","itemGUID","sortData","updateSortData","isIgnored","random","getSortData","sorters","_sorters","sorter","_destroy","display","global","EvEmitter","eventName","listener","events","_events","listeners","once","onceEvents","_onceEvents","onceListeners","splice","emitEvent","isOnce","ary","EnviraImagesLoaded","onAlways","getImages","jqDeferred","Deferred","check","addElementImages","addImage","background","addElementBackgroundImages","elementNodeTypes","childImgs","child","reURL","matches","backgroundImage","addBackground","loadingImage","LoadingImage","Background","_this","progressedCount","hasAnyBroken","onProgress","message","notify","jqMethod","getIsImageComplete","confirm","proxyImage","pendingSrc","currentSrc","handleEvent","method","unbindEvents","removeEventListener","makeJQueryPlugin","promise","arraySlice","logError","jQueryBridget","namespace","PluginClass","arg0","methodCall","plainCall","$elems","methodName","returnValue","pluginMethodStr","_init","updateJQuery","bridget","getStyleSize","num","isValid","isNaN","measurements","measurementsLength","getZeroSize","size","measurement","getStyle","isSetup","isBoxSizeOuter","setup","padding","borderStyle","borderWidth","boxSizing","appendChild","getSize","removeChild","isBorderBox","paddingWidth","paddingLeft","paddingRight","paddingHeight","paddingTop","paddingBottom","marginWidth","marginLeft","marginRight","marginHeight","marginTop","marginBottom","borderLeftWidth","borderRightWidth","borderHeight","borderTopWidth","borderBottomWidth","isBorderBoxSizeOuter","styleWidth","styleHeight","matchesMethod","ElemProto","Element","matchesSelector","prefixes","utils","modulo","removeFrom","getParent","getQueryElement","filterFindElements","elems","ffElems","HTMLElement","childElems","debounceMethod","_class","threshold","timeoutName","timeout","docReady","toDashed","$1","$2","htmlInit","WidgetClass","dashedNamespace","dataAttr","dataAttrElems","jsDashElems","concat","dataOptionsAttr","JSON","parse","className","isEmptyObj","docElemStyle","transitionProperty","transition","transformProperty","transitionEndEvent","WebkitTransition","vendorProperties","transitionDelay","constructor","_transn","ingProperties","clean","onEnd","elemStyle","supportedProp","getPosition","isOriginLeft","_getOption","isOriginTop","xValue","yValue","layoutSize","layoutPosition","xPadding","xProperty","xResetProperty","getXValue","yPadding","yProperty","yResetProperty","getYValue","isHorizontal","percentPosition","_transitionTo","curX","curY","compareX","compareY","didNotMove","setPosition","isTransitioning","transX","transY","transitionStyle","onTransitionEnd","isCleaning","goTo","moveTo","_nonTransition","_removeStyles","_transition","from","h","enableTransition","toDashedAll","staggerDelay","onwebkitTransitionEnd","ontransitionend","onotransitionend","dashedVendorProperties","disableTransition","removeTransitionStyles","cleanStyle","cleanTransitionStyle","stagger","removeElem","reveal","isHidden","transitionEndProperty","getHideRevealTransitionEndProperty","onRevealTransitionEnd","hiddenStyle","visibleStyle","styleProperty","optionStyle","onHideTransitionEnd","GUID","instances","queryElement","$element","outlayerGUID","isInitLayout","containerStyle","initLayout","originLeft","originTop","resize","resizeContainer","oldOption","compatOptions","layoutInstant","reloadItems","stamps","stamp","canBindResize","bindResize","_itemize","itemElems","_filterFindItemElements","getItemElements","_resetLayout","_manageStamps","isInstant","_isLayoutInited","layoutItems","_getMeasurement","_getItemsForLayout","_layoutItems","_postLayout","_emitCompleteOnItems","queue","_getItemLayoutPosition","isLayoutInstant","_processLayoutQueue","updateStagger","_positionItem","getMilliseconds","isResizingContainer","_getContainerSize","_setContainerMeasure","measure","isWidth","elemSize","onComplete","dispatchEvent","count","doneCount","tick","emitArgs","$event","Event","getItem","unignore","_find","unstamp","_getBoundingRect","_manageStamp","boundingRect","_boundingRect","_getElementOffset","thisRect","isResizeBound","unbindResize","onresize","needsResizeLayout","hasSizes","addItems","appended","prepended","previousItems","revealItemElements","getItems","hideItemElements","removeItems","removeData","Layout","subclass","Parent","SubClass","msUnits","ms","s","time","unit","mult","LayoutMode","filteredItems","facadeMethods","needsVerticalResizeLayout","getColumnWidth","getSegmentSize","getRowHeight","segment","segmentName","outerSize","firstItemSize","getFirstItemSize","firstItem","modes","Mode","Masonry","fitWidth","measureColumns","colYs","cols","maxY","getContainerWidth","firstItemElem","excess","mathMethod","isFitWidth","remainder","colSpan","colGroup","_getColGroup","minimumY","shortColIndex","setHeight","setSpan","groupCount","groupColYs","stampSize","firstX","lastX","firstCol","lastCol","stampMaxY","_getContainerFitWidth","unusedCols","previousWidth","MasonryMode","keepModeMethods","FitRows","itemWidth","Vertical","horizontalAlignment","String","Enviratope","layoutMode","isJQueryFiltering","sortAscending","_getSorters","sortHistory","_initLayoutMode","_updateItemsSortData","initialOpts","arrange","_layout","_getIsInstant","filtered","_filter","_bindArrangeComplete","_isInstant","_noTransition","_hideReveal","_sort","needReveal","needHide","isLayoutComplete","isHideComplete","isRevealComplete","arrangeParallelCallback","hiddenMatched","visibleUnmatched","_getFilterTest","isMatched","mungeSorter","len","query","attrMatch","getValue","getValueGetter","parser","sortDataParsers","getChildText","textContent","sortByOpt","sortBy","sortBys","itemSorter","getItemSorter","sortAsc","itemA","itemB","isAscending","direction","_mode","mode","Error","_filterRevealAdded","insert","filteredInsertItems","_remove","shuffle","getFilteredItemElements","hasScrollBar","JustifiedGallery","$gallery","checkSettings","imgAnalyzerTimeout","buildingRow","entriesBuff","aspectRatio","lastAnalyzedIndex","yield","flushed","retrieveMaxRowHeight","suffixRanges","retrieveSuffixRanges","offY","rows","spinner","phase","timeSlot","intervalId","checkWidthIntervalId","galleryWidth","getSuffix","longestSide","sizeRangeSuffixes","removeSuffix","suffix","endsWith","getUsedSuffix","si","newSrc","imageSrc","newImageSrc","thumbnailPath","matchRes","extension","ext","showImg","imagesAnimationDuration","extractImgSrcFromImage","displayEntry","loadNewImage","onImageEvent","onEntryMouseEnterForCaption","eventObject","visibleOpacity","onEntryMouseLeaveForCaption","captionMouseEvents","mouseenter","mouseleave","prepareBuildingRow","isLastRow","imgAspectRatio","newImgW","newImgH","justify","minHeight","availableWidth","defaultRowHeight","justifiable","justifyThreshold","fixedHeight","clearBuildingRow","flushRow","buildingRowRes","offX","isPercentage","galleryHeightToSet","getSpinnerHeight","scrollBarOn","checkWidth","refreshSensitivity","rewind","startImgAnalyzer","refreshTime","isSpinnerActive","stopLoadingSpinnerAnimation","detach","startLoadingSpinnerAnimation","spinnerContext","$spinnerPoints","updateEntries","norewind","toArray","modifyEntries","filterArray","resetFilters","sortArray","randomize","shuffleArray","insertToGallery","that","functionToApply","lastEntries","_","analyzeImages","isForResize","stopImgAnalyzerStarter","onLoad","onError","memImage","$memImage","imagesToLoad","skippedImages","loadImg","checkOrConvertNumber","settingContainer","settingName","checkSizeRangesSuffixes","rangeIdx","newSizeRngSuffixes","numIdx","newMaxRowHeight","lastRowModes","join","updateSettings","newSettings","arg","gallery","controller","isotope","toFix","toBind","nullLowestDeltaTimeout","lowestDelta","fixHooks","mouseHooks","special","mousewheel","onmousewheel","getLineHeight","getPageHeight","teardown","$elem","adjustOldDeltas","normalizeOffset","unmousewheel","unbind","orgEvent","delta","absDelta","offsetX","offsetY","fix","wheelDeltaY","wheelDeltaX","HORIZONTAL_AXIS","deltaMode","lineHeight","pageHeight","shouldAdjustOldDeltas","deltaFactor","nullLowestDelta","dispatch","handle","ownProps","resArray"],"mappings":"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ACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA,CAAC;;;;;;;;;;;;AC/GD;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AAAA;AACL,GAAG,QAYH;;AAEA,CAAC;;AAED;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,kBAAkB,gBAAgB;AAClC;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,uBAAuB;AACzC;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL,GAAG;AACH;;AAEA;;AAEA;;AAEA,CAAC;;;;;;;;;;;;AC7OD;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AAAA;AACL,GAAG,QAMH;;AAEA,CAAC;AACD;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,wBAAwB;AACxC;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA,gBAAgB,wBAAwB;AACxC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA,CAAC;;;;;;;;;;;;AChND;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CACA;AAAA;AAAA;AAAA;AACA,GAAG,QAYH;;AAEA,CAAC;;AAED;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,kBAAkB,eAAe;AACjC;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,YAAY;AAC9C;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,aAAa,OAAO;AACpB,eAAe,MAAM;AACrB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,oBAAoB,gBAAgB;AACpC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,2BAA2B,cAAc;AACzC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,CAAC;;;;;;;;;;;;AC9OD;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CACA;AAAA;AAAA;AAAA,oGACA;AACA,GAAG,QAaH;;AAEA,CAAC;AACD;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;AAGA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,qBAAqB;AACrB,aAAa;AACb;AACA;;AAEA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,WAAW,OAAO;AAClB,WAAW,SAAS;AACpB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB,aAAa,QAAQ;AACrB,aAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,YAAY,cAAc;AAC1B;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA,YAAY,cAAc;;AAE1B;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,YAAY,cAAc;;AAE1B;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA,cAAc,kBAAkB;AAChC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;;AAEA,CAAC;;;;;;;;;;;;ACziBD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CACA;AACA;AACA;AAAA,oGACA;AACA,GAAG,QAkBH;;AAEA,CAAC;AACD;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;;AAGA;AACA,WAAW,gBAAgB;AAC3B,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,iCAAiC;AACjC;;AAEA;AACA;AACA,iCAAiC;AACjC,yBAAyB;;AAEzB;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA,WAAW,iCAAiC;AAC5C,aAAa,MAAM;AACnB;AACA;;AAEA;AACA;;AAEA;AACA;AACA,gBAAgB,sBAAsB;AACtC;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,WAAW,iCAAiC;AAC5C,aAAa,MAAM;AACnB;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa,MAAM;AACnB;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,WAAW,MAAM;AACjB,aAAa,MAAM;AACnB;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA,WAAW,MAAM;AACjB,WAAW,QAAQ;AACnB;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;AACA;AACA,WAAW,cAAc;AACzB,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,WAAW,MAAM;AACjB;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,cAAc;AACzB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB;AACA;;AAEA;AACA,WAAW,OAAO;AAClB,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,MAAM;AACjB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,MAAM;AACjB,WAAW,MAAM;AACjB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;;;AAGA;AACA;AACA;AACA,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,oCAAoC;AAC/C;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,4BAA4B;AACvC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA,WAAW,oCAAoC;AAC/C,aAAa,MAAM;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,WAAW,QAAQ;AACnB;AACA;;AAEA;AACA;AACA,WAAW,QAAQ;AACnB,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,WAAW,6BAA6B;AACxC,aAAa,MAAM;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,6BAA6B;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,6BAA6B;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,wBAAwB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA,WAAW,wBAAwB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA,WAAW,MAAM,GAAG,QAAQ,GAAG,SAAS;AACxC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,MAAM,GAAG,QAAQ,GAAG,SAAS;AACxC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,QAAQ;AACnB,WAAW,SAAS;AACpB,aAAa,cAAc;AAC3B;AACA;AACA;AACA,gBAAgB,uBAAuB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,MAAM;AACjB,aAAa,MAAM;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;AACA;AACA,WAAW,6BAA6B;AACxC;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;;AAEA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA,WAAW,QAAQ;AACnB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;;;AAGA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA,oCAAoC;AACpC;AACA,yCAAyC;;AAEzC;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA,CAAC;;;;;;;;;;;;AC16BD,wB","file":"envira-min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./assets/js/envira.js\");\n","import './lib/pollyfills.js';\nimport './lib/mousewheel.js';\nimport './lib/jquery.justifiedGallery.js';\nimport './lib/enviraJustifiedGallery-extensions.js';\nimport './lib/isotope.js';\nimport './lib/imagesloaded.js';\nimport './lib/envirabox.js';\nimport './lib/envirabox-fullscreen.js';\nimport './lib/envirabox-media.js';\nimport './lib/envirabox-wheel.js';\nimport './lib/envirabox-guestures.js';\nimport './lib/envirabox-thumbs.js';\nimport './lib/envirabox-slideshow.js';\n\nimport Envira from './gallery-init.js';\nimport Envira_Link from './gallery-link.js';\n\nvar envira_galleries = window.envira_galleries || {},\n\tenvira_links     = window.envira_links || {};\n\n; (function ($, window, document, Envira, Envira_Link, envira_gallery, envira_galleries) {\n\n\t$(\n\t\tfunction () {\n\n\t\t\twindow.envira_galleries = envira_galleries;\n\t\t\twindow.envira_links     = envira_links;\n\n\t\t\t$( document ).on(\n\t\t\t\t'envira_load',\n\t\t\t\tfunction (e) {\n\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t\tenvira_galleries           = {};\n\t\t\t\t\tenvira_links               = {};\n\t\t\t\t\tvar envira_galleries_total = [];\n\n\t\t\t\t\t$( '.envira-gallery-public' ).each(\n\t\t\t\t\t\tfunction () {\n\n\t\t\t\t\t\t\tlet $this         = $( this ),\n\t\t\t\t\t\t\t$id               = $this.data( 'envira-id' ),\n\t\t\t\t\t\t\t$envira_galleries = $this.data( 'gallery-config' ),\n\t\t\t\t\t\t\t$envira_images    = $this.data( 'gallery-images' ),\n\t\t\t\t\t\t\t$envira_lightbox  = $this.data( 'lightbox-theme' ),\n\t\t\t\t\t\t\t$suffix_id        = '';\n\n\t\t\t\t\t\t\t// check to see if multiple duplicate ids exist, and if so add a suffix to make each unique (and therefore get init)\n\t\t\t\t\t\t\tif (envira_galleries_total[$envira_galleries['gallery_id']] !== undefined) {\n\t\t\t\t\t\t\t\t$suffix_id = '_' + (envira_galleries_total[$envira_galleries['gallery_id']] ? parseInt( envira_galleries_total[$envira_galleries['gallery_id']] ) + 1 : 2);\n\t\t\t\t\t\t\t\tenvira_galleries_total[$envira_galleries['gallery_id']] = (parseInt( envira_galleries_total[$envira_galleries['gallery_id']] ) + 1);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tenvira_galleries_total[$envira_galleries['gallery_id']] = 1;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tenvira_galleries[$envira_galleries['gallery_id']] = new Envira( $envira_galleries['gallery_id'] + $suffix_id, $envira_galleries, $envira_images, $envira_lightbox );\n\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\n\t\t\t\t\t$( '.envira-gallery-links' ).each(\n\t\t\t\t\t\tfunction () {\n\n\t\t\t\t\t\t\tlet $this         = $( this ),\n\t\t\t\t\t\t\t$envira_galleries = $this.data( 'gallery-config' ),\n\t\t\t\t\t\t\t$envira_images    = $this.data( 'gallery-images' ),\n\t\t\t\t\t\t\t$envira_lightbox  = $this.data( 'lightbox-theme' );\n\n\t\t\t\t\t\t\tif (envira_links[$envira_galleries['gallery_id']] === undefined) {\n\n\t\t\t\t\t\t\t\tenvira_links[$envira_galleries['gallery_id']] = new Envira_Link( $envira_galleries, $envira_images, $envira_lightbox );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\n\t\t\t\t\t$( document ).trigger( 'envira_loaded', [envira_galleries, envira_links] );\n\n\t\t\t\t}\n\t\t\t);\n\n\t\t\t$( document ).trigger( 'envira_load' );\n\n\t\t\tif (envira_gallery.debug !== undefined && envira_gallery.debug) {\n\n\t\t\t\tconsole.log( envira_links );\n\t\t\t\tconsole.log( envira_galleries );\n\n\t\t\t}\n\n\t\t\t$( 'body' ).on(\n\t\t\t\t'click',\n\t\t\t\t'div.envirabox-title a[href*=\"#\"]:not([href=\"#\"])',\n\t\t\t\tfunction (e) {\n\n\t\t\t\t\tif (location.pathname.replace( /^\\//, '' ) == this.pathname.replace( /^\\//, '' ) && location.hostname == this.hostname) {\n\t\t\t\t\t\t$.envirabox.close();\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t);\n\n\t\t\t// `$('#envira-gallery-wrap-' + event.gallery_id).find('iframe').closest('div.envira-gallery-item-inner').find( 'div.envira-gallery-position-overlay' ).delay( 100 ).show();\n\t\t\t/* setup lazy load event */\n\t\t\t$( document ).on(\n\t\t\t\t\"envira_image_lazy_load_complete\",\n\t\t\t\tfunction (event) {\n\n\t\t\t\t\tlet envira_container = '';\n\n\t\t\t\t\tif (event !== undefined && ((event.image_id !== undefined && event.image_id !== null) || (event.video_id !== undefined && event.video_id !== null))) {\n\n\t\t\t\t\t\tif ($( '#envira-gallery-wrap-' + event.gallery_id ).find( '#' + event.video_id + ' iframe' ).length > 0) {\n\t\t\t\t\t\t\tenvira_container = $( '#envira-gallery-wrap-' + event.gallery_id ).find( '#' + event.video_id + ' iframe' );\n\t\t\t\t\t\t} else if ($( '#envira-gallery-wrap-' + event.gallery_id ).find( '#' + event.video_id + ' video' ).length > 0) {\n\t\t\t\t\t\t\tenvira_container = $( '#envira-gallery-wrap-' + event.gallery_id ).find( '#' + event.video_id + ' video' );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tenvira_container = $( '#envira-gallery-wrap-' + event.gallery_id ).find( 'img#' + event.image_id );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (envira_container === undefined || envira_container === '') {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ($( '#envira-gallery-wrap-' + event.gallery_id ).find( 'div.envira-gallery-public' ).hasClass( 'envira-gallery-0-columns' )) {\n\n\t\t\t\t\t\t\t/* this is an automatic gallery */\n\t\t\t\t\t\t\t$( envira_container ).closest( 'div.envira-gallery-item-inner' ).find( 'div.envira-gallery-position-overlay' ).delay( 100 ).show();\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t/* this is a legacy gallery */\n\t\t\t\t\t\t\t$( envira_container ).closest( 'div.envira-gallery-item-inner' ).find( 'div.envira-gallery-position-overlay' ).delay( 100 ).show();\n\n\t\t\t\t\t\t\t/* re-do the padding bottom */\n\t\t\t\t\t\t\t/* $padding_bottom = ( $output_height / $output_width ) * 100; */\n\n\t\t\t\t\t\t\tvar envira_lazy_width = $( envira_container ).closest( 'div.envira-gallery-item-inner' ).find( '.envira-lazy' ).width();\n\t\t\t\t\t\t\tvar ratio1            = (event.naturalHeight / event.naturalWidth);\n\t\t\t\t\t\t\tvar ratio2            = (event.naturalHeight / envira_lazy_width);\n\n\t\t\t\t\t\t\tif (ratio2 < ratio1) {\n\t\t\t\t\t\t\t\tvar ratio = ratio2;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tvar ratio = ratio1;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tvar padding_bottom = ratio * 100;\n\t\t\t\t\t\t\tif (envira_container.closest( 'div.envira-gallery-public' ).parent().hasClass( 'envira-gallery-theme-sleek' )) {\n\t\t\t\t\t\t\t\t// add additional padding for this theme\n\t\t\t\t\t\t\t\tpadding_bottom = padding_bottom + 2;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tvar div_envira_lazy = $( envira_container ).closest( 'div.envira-gallery-item-inner' ).find( 'div.envira-lazy' );\n\t\t\t\t\t\t\tvar caption_height  = div_envira_lazy.closest( 'div.envira-gallery-item-inner' ).find( '.envira-gallery-captioned-data' ).height();\n\t\t\t\t\t\t\tif ($( envira_container ).closest( 'div.envira-gallery-item' ).hasClass( 'enviratope-item' )) {\n\t\t\t\t\t\t\t\tdiv_envira_lazy.css( 'padding-bottom', padding_bottom + '%' ).attr( 'data-envira-changed', 'true' );\n\t\t\t\t\t\t\t\tvar div_overlay = $( envira_container ).closest( 'div.envira-gallery-item-inner' ).find( '.envira-gallery-position-overlay.envira-gallery-bottom-right' );\n\t\t\t\t\t\t\t\tdiv_overlay.css( 'bottom', caption_height );\n\t\t\t\t\t\t\t\tdiv_overlay = $( envira_container ).closest( 'div.envira-gallery-item-inner' ).find( '.envira-gallery-position-overlay.envira-gallery-bottom-left' );\n\t\t\t\t\t\t\t\tdiv_overlay.css( 'bottom', caption_height );\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tdiv_envira_lazy.css( 'height', 'auto' ).css( 'padding-bottom', '10px' ).attr( 'data-envira-changed', 'true' );\n\t\t\t\t\t\t\t\tvar div_overlay = $( envira_container ).closest( 'div.envira-gallery-item-inner' ).find( '.envira-gallery-position-overlay.envira-gallery-bottom-right' );\n\t\t\t\t\t\t\t\tdiv_overlay.css( 'bottom', caption_height + 10 );\n\t\t\t\t\t\t\t\tdiv_overlay = $( envira_container ).closest( 'div.envira-gallery-item-inner' ).find( '.envira-gallery-position-overlay.envira-gallery-bottom-left' );\n\t\t\t\t\t\t\t\tdiv_overlay.css( 'bottom', caption_height + 10 );\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t$( envira_container ).closest( 'div.envira-gallery-item-inner' ).find( 'span.envira-title' ).delay( 1000 ).css( 'visibility', 'visible' );\n\t\t\t\t\t\t\t$( envira_container ).closest( 'div.envira-gallery-item-inner' ).find( 'span.envira-caption' ).delay( 1000 ).css( 'visibility', 'visible' );\n\n\t\t\t\t\t\t\tif (window[\"envira_container_\" + event.gallery_id] !== undefined) {\n\n\t\t\t\t\t\t\t\tif ($( '#envira-gallery-' + event.gallery_id ).hasClass( 'enviratope' )) {\n\n\t\t\t\t\t\t\t\t\twindow[\"envira_container_\" + event.gallery_id].on(\n\t\t\t\t\t\t\t\t\t\t'layoutComplete',\n\t\t\t\t\t\t\t\t\t\tfunction (event, laidOutItems) {\n\n\t\t\t\t\t\t\t\t\t\t\t$( envira_container ).closest( 'div.envira-gallery-item-inner' ).find( 'span.envira-title' ).delay( 1000 ).css( 'visibility', 'visible' );\n\t\t\t\t\t\t\t\t\t\t\t$( envira_container ).closest( 'div.envira-gallery-item-inner' ).find( 'span.envira-caption' ).delay( 1000 ).css( 'visibility', 'visible' );\n\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\n\t\t}\n\t);\n\n})( jQuery, window, document, Envira, Envira_Link, envira_gallery, envira_galleries );\n","import enviraLazy from './lib/enviraLazy.js';\n\nclass Envira {\n\n\t/**\n\t * Constructor function for Envira.\n\t *\n\t * @since 1.7.1\n\t */\n\tconstructor(id, data, images, lightbox) {\n\n\t\tvar self = this;\n\n\t\t//Setup our Vars\n\t\tself.data = data;\n\t\tself.images = images;\n\t\tself.id = id;\n\t\tself.envirabox_config = lightbox;\n\t\tself.initImage = false;\n\n\t\t//Log if ENVIRA_DEBUG enabled\n\t\tself.log(self.data);\n\t\tself.log(self.images);\n\t\tself.log(self.envirabox_config);\n\t\tself.log(self.id);\n\n\t\t//self init\n\t\tself.init();\n\n\t}\n\n\t/**\n\t * Initizlize the proper scripts based on settings.\n\t *\n\t * @since 1.7.1\n\t */\n\tinit() {\n\n\t\tvar self = this;\n\n\t\t//Justified Gallery Setup\n\t\tif (parseInt(self.get_config('columns')) == 0 ) {\n\n\t\t\tself.justified();\n\n\t\t\tif (self.get_config('lazy_loading')) {\n\n\t\t\t\t$(document).on('envira_pagination_ajax_load_completed', function () {\n\n\t\t\t\t\t$('#envira-gallery-' + self.id).on('jg.complete', function (e) {\n\n\t\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\t\tself.load_images();\n\n\t\t\t\t\t});\n\n\t\t\t\t});\n\n\t\t\t\tself.load_images();\n\n\t\t\t}\n\n\n\t\t\t$(document).trigger('envira_gallery_api_justified', self.data);\n\n\t\t}\n\n\t\t//Lazy loading setup\n\t\tif (self.get_config('lazy_loading')) {\n\n\t\t\tself.load_images();\n\n\t\t\t$(window).scroll(function (e) {\n\n\t\t\t\tself.load_images();\n\n\t\t\t});\n\n\t\t}\n\n\t\t//Enviratope Setup\n\t\tif (parseInt(self.get_config('columns')) > 0 && self.get_config('isotope')) {\n\n\t\t\tself.enviratopes();\n\t\t\t//Lazy loading setup\n\t\t\tif (self.get_config('lazy_loading')) {\n\n\t\t\t\t$('#envira-gallery-' + self.id).one('layoutComplete', function (e, laidOutItems) {\n\n\t\t\t\t\tself.load_images();\n\n\t\t\t\t});\n\n\t\t\t}\n\t\t} else if (parseInt(self.get_config('columns')) > 0) {\n\n\t\t\tself.load_images();\n\n\t\t}\n\n\t\t//Lightbox setup\n\t\tif (self.get_config('lightbox_enabled') || self.get_config('lightbox')) {\n\n\t\t\tself.lightbox();\n\n\t\t}\n\n\t\t$(document).trigger('envira_gallery_api_init', self);\n\n\t}\n\n\t/**\n\t * LazyLoading\n\t *\n\t * @since 1.7.1\n\t */\n\tload_images() {\n\n\t\tvar self = this;\n\n\t\tself.log('running: ' + '#envira-gallery-' + self.id);\n\n\t\tenviraLazy.run('#envira-gallery-' + self.id);\n\n\t\tif ($('#envira-gallery-' + self.id).hasClass('enviratope')) {\n\n\t\t\t$('#envira-gallery-' + self.id).enviraImagesLoaded()\n\t\t\t\t.done(function () {\n\n\t\t\t\t\tsetTimeout(\n\t\t\t\t\t\tfunction () {\n\t\t\t\t\t\t\t$('#envira-gallery-' + self.id).enviratope('layout');\n\t\t\t\t\t\t\tself.log('done: ' + '#envira-gallery-' + self.id);\n\t\t\t\t\t\t}, 500);\n\n\n\t\t\t\t})\n\t\t\t\t.progress(function () {\n\t\t\t\t\t$('#envira-gallery-' + self.id).enviratope('layout');\n\t\t\t\t\tself.log('progress: ' + '#envira-gallery-' + self.id);\n\t\t\t\t});\n\n\t\t}\n\n\t}\n\n\t/**\n\t * Outputs the gallery init script in the footer.\n\t *\n\t * @since 1.7.1\n\t */\n\tjustified() {\n\n\t\tvar self = this;\n\n\t\t$('#envira-gallery-' + self.id).enviraJustifiedGallery({\n\t\t\trowHeight: self.is_mobile() ? this.get_config('mobile_justified_row_height') : this.get_config('justified_row_height'),\n\t\t\tmaxRowHeight: -1,\n\t\t\twaitThumbnailsLoad: true,\n\t\t\tselector: '> div > div',\n\t\t\tlastRow: this.get_config('justified_last_row'),\n\t\t\tborder: 0,\n\t\t\tmargins: this.get_config('justified_margins'),\n\t\t});\n\n\t\t$(document).trigger('envira_gallery_api_start_justified', self);\n\n\t\t$('#envira-gallery-' + this.id).css('opacity', '1');\n\n\t}\n\n\tjustified_norewind() {\n\n\t\t$('#envira-gallery-' + self.id).enviraJustifiedGallery('norewind');\n\n\t}\n\t/**\n\t * Outputs the gallery init script in the footer.\n\t *\n\t * @since 1.7.1\n\t */\n\tenviratopes() {\n\n\t\tvar self = this;\n\n\n\t\tvar envira_isotopes_config = {\n\n\t\t\titemSelector: '.envira-gallery-item',\n\t\t\tmasonry: {\n\t\t\t\tcolumnWidth: '.envira-gallery-item'\n\t\t\t}\n\n\t\t};\n\t\t$(document).trigger('envira_gallery_api_enviratope_config', [self]);\n\n\t\t// Initialize Isotope\n\t\t$('#envira-gallery-' + self.id).enviratope(envira_isotopes_config);\n\t\t// Re-layout Isotope when each image loads\n\t\t$('#envira-gallery-' + self.id).enviraImagesLoaded()\n\t\t\t.done(function () {\n\t\t\t\t$('#envira-gallery-' + self.id).enviratope('layout');\n\t\t\t})\n\t\t\t.progress(function () {\n\t\t\t\t$('#envira-gallery-' + self.id).enviratope('layout');\n\t\t\t});\n\t\t$(document).trigger('envira_gallery_api_enviratope', [self]);\n\n\t}\n\t/**\n\t * Outputs the gallery init script in the footer.\n\t *\n\t * @since 1.7.1\n\t */\n\tlightbox() {\n\n\t\tvar self = this,\n\t\t\ttouch_general = self.get_config('mobile_touchwipe_close') ? { vertical: true, momentum: true } : { vertical: false, momentum: false },\n\t\t\tthumbs_hide_on_open = self.get_config('thumbnails_hide') ? self.get_config('thumbnails_hide') : true,\n\t\t\tthumbs_rowHeight = self.is_mobile() ? this.get_config('mobile_thumbnails_height') : this.get_config('thumbnails_height'),\n\t\t\tthumbs = self.get_config('thumbnails') ? { autoStart: thumbs_hide_on_open, hideOnClose: true, position: self.get_lightbox_config('thumbs_position'), rowHeight: thumbs_rowHeight } : false,\n\t\t\tslideshow = self.get_config('slideshow') ? { autoStart: self.get_config('autoplay'), speed: self.get_config('ss_speed') } : false,\n\t\t\tfullscreen = self.get_config('fullscreen') && self.get_config('open_fullscreen') ? { autoStart: true } : true,\n\t\t\tanimationEffect = self.get_config('lightbox_open_close_effect') == 'zomm-in-out' ? 'zoom-in-out' : self.get_config('lightbox_open_close_effect'),\n\t\t\ttransitionEffect = self.get_config('effect') == 'zomm-in-out' ? 'zoom' : self.get_config('effect'),\n\t\t\tlightbox_images = [],\n\t\t\toverlay_divs = '';\n\t\tself.lightbox_options = {\n\t\t\tselector: '[data-envirabox=\"' + self.id + '\"]',\n\t\t\tloop: self.get_config('loop'), // Enable infinite gallery navigation\n\t\t\tmargin: self.get_lightbox_config('margins'), // Space around image, ignored if zoomed-in or viewport width is smaller than 800px\n\t\t\tgutter: self.get_lightbox_config('gutter'), // Horizontal space between slides\n\t\t\tkeyboard: self.get_config('keyboard'), // Enable keyboard navigation\n\t\t\tarrows: self.get_lightbox_config('arrows'), // Should display navigation arrows at the screen edges\n\t\t\tarrow_position: self.get_lightbox_config('arrow_position'),\n\t\t\tinfobar: self.get_lightbox_config('infobar'), // Should display infobar (counter and arrows at the top)\n\t\t\ttoolbar: self.get_lightbox_config('toolbar'), // Should display toolbar (buttons at the top)\n\t\t\tidleTime: self.get_lightbox_config('idle_time') ? self.get_lightbox_config('idle_time') : false, // by default there shouldn't be any, otherwise value is in seconds\n\t\t\tsmallBtn: self.get_lightbox_config('show_smallbtn'),\n\t\t\tprotect: false, // Disable right-click and use simple image protection for images\n\t\t\timage: { preload: false },\n\t\t\tanimationEffect: animationEffect,\n\t\t\tanimationDuration: self.get_lightbox_config('animation_duration') ? self.get_lightbox_config('animation_duration') : 300, // Duration in ms for open/close animation\n\t\t\tbtnTpl: {\n\t\t\t\tsmallBtn: self.get_lightbox_config('small_btn_template'),\n\t\t\t},\n\t\t\tzoomOpacity: 'auto',\n\t\t\ttransitionEffect: transitionEffect, // Transition effect between slides\n\t\t\ttransitionDuration: self.get_lightbox_config('transition_duration') ? self.get_lightbox_config('transition_duration') : 200, // Duration in ms for transition animation\n\t\t\tbaseTpl: self.get_lightbox_config('base_template'), // Base template for layout\n\t\t\tspinnerTpl: '<div class=\"envirabox-loading\"></div>', // Loading indicator template\n\t\t\terrorTpl: self.get_lightbox_config('error_template'), // Error message template\n\t\t\tfullScreen: self.get_config('fullscreen') ? fullscreen : false,\n\t\t\ttouch: touch_general, // Set `touch: false` to disable dragging/swiping\n\t\t\thash: false,\n\t\t\tinsideCap: self.get_lightbox_config('inner_caption'),\n\t\t\tcapPosition: self.get_lightbox_config('caption_position'),\n\t\t\tcapTitleShow: self.get_config('lightbox_title_caption') && self.get_config('lightbox_title_caption') != 'none' && self.get_config('lightbox_title_caption') != '0' ? self.get_config('lightbox_title_caption') : false,\n\t\t\tmedia: {\n\t\t\t\tyoutube: {\n\t\t\t\t\tparams: {\n\t\t\t\t\t\tautoplay: 0\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\twheel: this.get_config('mousewheel') == false ? false : true,\n\t\t\tslideShow: slideshow,\n\t\t\tthumbs: thumbs,\n\t\t\tmobile: {\n\t\t\t\tclickContent: function (current, event) {\n\t\t\t\t\treturn self.get_lightbox_config('click_content') ? self.get_lightbox_config('click_content') : 'toggleControls';\n\t\t\t\t},\n\t\t\t\tclickSlide: function (current, event) {\n\t\t\t\t\treturn self.get_lightbox_config('click_slide') ? self.get_lightbox_config('click_slide') : 'close'; // clicked on the slide\n\t\t\t\t},\n\t\t\t\tdblclickContent: false,\n\t\t\t\tdblclickSlide: false,\n\t\t\t},\n\t\t\t// Clicked on the content\n\t\t\tclickContent: self.get_lightbox_config('click_content') ? self.get_lightbox_config('click_content') : 'toggleControls', // clicked on the image itself\n\t\t\tclickSlide: self.get_lightbox_config('click_slide') ? self.get_lightbox_config('click_slide') : 'close', // clicked on the slide\n\t\t\tclickOutside: self.get_lightbox_config('click_outside') ? self.get_lightbox_config('click_outside') : 'toggleControls', // clicked on the background (backdrop) element\n\n\t\t\t// Same as previous two, but for double click\n\t\t\tdblclickContent: false,\n\t\t\tdblclickSlide: false,\n\t\t\tdblclickOutside: false,\n\n\t\t\t// Video settings\n\t\t\tvideoPlayPause: self.get_config('videos_playpause') ? true : false,\n\t\t\tvideoProgressBar: self.get_config('videos_progress') ? true : false,\n\t\t\tvideoPlaybackTime: self.get_config('videos_current') ? true : false,\n\t\t\tvideoVideoLength: self.get_config('videos_duration') ? true : false,\n\t\t\tvideoVolumeControls: self.get_config('videos_volume') ? true : false,\n\t\t\tvideoControlBar: self.get_config('videos_controls') ? true : false,\n\t\t\tvideoFullscreen: self.get_config('videos_fullscreen') ? true : false,\n\t\t\tvideoDownload: self.get_config('videos_download') ? true : false,\n\t\t\tvideoPlayIcon: self.get_config('videos_play_icon_thumbnails') ? true : false,\n\n\t\t\t// Callbacks\n\t\t\t//==========\n\t\t\tonInit: function (instance, current) {\n\n\t\t\t\tself.initImage = true;\n\n\t\t\t\t$(document).trigger('envirabox_api_on_init', [self, instance, current]);\n\n\t\t\t},\n\n\t\t\tbeforeLoad: function (instance, current) {\n\n\t\t\t\t$(document).trigger('envirabox_api_before_load', [self, instance, current]);\n\n\t\t\t},\n\n\t\t\tafterLoad: function (instance, current) {\n\n\t\t\t\t$(document).trigger('envirabox_api_after_load', [self, instance, current]);\n\n\t\t\t},\n\n\t\t\tbeforeShow: function (instance, current) {\n\n\t\t\t\tif (self.data.lightbox_theme == 'base' && overlay_divs == '' && $('.envirabox-position-overlay').length > 0) {\n\t\t\t\t\toverlay_divs = $('.envirabox-position-overlay');\n\t\t\t\t}\n\n\t\t\t\tself.initImage = false;\n\n\t\t\t\tif (self.get_config('loop') === 0 && instance.currIndex == 0) {\n\t\t\t\t\t// hide the back navigation arrow\n\t\t\t\t\t$('.envirabox-slide--current a.envirabox-prev').hide();\n\t\t\t\t} else {\n\t\t\t\t\t$('.envirabox-slide--current a.envirabox-prev').show();\n\t\t\t\t}\n\n\t\t\t\tif (self.get_config('loop') === 0 && instance.currIndex == (Object.keys(instance.group).length - 1)) {\n\t\t\t\t\t// hide the next navigation arrow\n\t\t\t\t\t$('.envirabox-slide--current a.envirabox-next').hide();\n\t\t\t\t} else {\n\t\t\t\t\t$('.envirabox-slide--current a.envirabox-next').show();\n\t\t\t\t}\n\n\t\t\t\t$(document).trigger('envirabox_api_before_show', [self, instance, current]);\n\n\t\t\t},\n\n\t\t\tafterShow: function (instance, current) {\n\n\t\t\t\tif (prepend == undefined || prepend_cap == undefined) {\n\n\t\t\t\t\tvar prepend = false,\n\t\t\t\t\t\tprepend_cap = false;\n\n\t\t\t\t}\n\n\t\t\t\tif (prepend != true) {\n\n\t\t\t\t\t$('.envirabox-position-overlay').each(function () {\n\t\t\t\t\t\t$(this).prependTo(current.$content);\n\t\t\t\t\t});\n\n\t\t\t\t\tprepend = true;\n\t\t\t\t}\n\n\t\t\t\tif (self.get_config('loop') === 0 && instance.currIndex == 0) {\n\t\t\t\t\t// hide the back navigation arrow\n\t\t\t\t\t$('.envirabox-outer a.envirabox-prev').hide();\n\t\t\t\t} else {\n\t\t\t\t\t$('.envirabox-outer a.envirabox-prev').show();\n\t\t\t\t}\n\n\t\t\t\tif (self.get_config('loop') === 0 && instance.currIndex == (Object.keys(instance.group).length - 1)) {\n\t\t\t\t\t// hide the next navigation arrow\n\t\t\t\t\t$('.envirabox-outer a.envirabox-next').hide();\n\t\t\t\t} else {\n\t\t\t\t\t$('.envirabox-outer a.envirabox-next').show();\n\t\t\t\t}\n\n\t\t\t\t/* support older galleries or if someone overrides the keyboard configuration via a filter, etc. */\n\n\t\t\t\tif (self.get_config('keyboard') !== undefined && self.get_config('keyboard') === 0) {\n\n\t\t\t\t\t$(window).keypress(function (event) {\n\n\t\t\t\t\t\tif ([32, 37, 38, 39, 40].indexOf(event.keyCode) > -1) {\n\t\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t});\n\n\t\t\t\t}\n\n\t\t\t\t/* legacy theme we hide certain elements initially to prevent user seeing them for a second in the upper left until the CSS fully loads */\n\n\t\t\t\t$('.envirabox-slide--current .envirabox-title').css('visibility', 'visible');\n\t\t\t\tif ($('.envirabox-slide--current .envirabox-caption').length > 0 && $('.envirabox-slide--current .envirabox-caption').html().length > 0) {\n\t\t\t\t\t$('.envirabox-slide--current .envirabox-caption').css('visibility', 'visible');\n\t\t\t\t\t$('.envirabox-slide--current .envirabox-caption-wrap').css('visibility', 'visible');\n\t\t\t\t} else {\n\t\t\t\t\t$('.envirabox-slide--current .envirabox-caption').css('visibility', 'hidden');\n\t\t\t\t\t$('.envirabox-slide--current .envirabox-caption-wrap').css('visibility', 'hidden');\n\t\t\t\t}\n\n\n\t\t\t\t$('.envirabox-navigation').show();\n\t\t\t\t$('.envirabox-navigation-inside').show();\n\n\t\t\t\t/* if there's overlay divs to show, show them (applies again only to legacy) */\n\n\t\t\t\tif (overlay_divs !== undefined && overlay_divs != '' && $('.envirabox-slide--current .envirabox-image-wrap').length > 0) {\n\t\t\t\t\t$('.envirabox-image-wrap').prepend(overlay_divs);\n\t\t\t\t} else if (overlay_divs !== undefined && overlay_divs != '' && $('.envirabox-slide--current .envirabox-content').length > 0) {\n\t\t\t\t\t$('.envirabox-content').prepend(overlay_divs);\n\t\t\t\t}\n\n\t\t\t\t$(document).trigger('envirabox_api_after_show', [self, instance, current]);\n\n\t\t\t\t/* double check caption */\n\n\t\t\t\tif ( ( instance.opts.capTitleShow !== undefined ) && instance.opts.capTitleShow == 'caption' && current.caption == '' ) {\n\t\t\t\t\t$('.envirabox-caption-wrap .envirabox-caption').css('visibility', 'hidden');\n\t\t\t\t} else {\n\t\t\t\t\t$('.envirabox-caption-wrap .envirabox-caption').css('visibility', 'visible');\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\tbeforeClose: function (instance, current) {\n\n\t\t\t\t$(document).trigger('envirabox_api_before_close', [self, instance, current]);\n\n\t\t\t},\n\t\t\tafterClose: function (instance, current) {\n\n\t\t\t\t$(document).trigger('envirabox_api_after_close', [self, instance, current]);\n\n\t\t\t},\n\n\t\t\tonActivate: function (instance, current) {\n\n\t\t\t\t$(document).trigger('envirabox_api_on_activate', [self, instance, current]);\n\n\t\t\t},\n\t\t\tonDeactivate: function (instance, current) {\n\n\t\t\t\t$(document).trigger('envirabox_api_on_deactivate', [self, instance, current]);\n\n\t\t\t},\n\n\t\t};\n\t\t// Mobile Overrides\n\t\tif (self.is_mobile()) {\n\n\t\t\tif (self.get_config('mobile_thumbnails') !== 1) {\n\t\t\t\tself.lightbox_options.thumbs = false;\n\t\t\t}\n\n\t\t}\n\t\t// Load from json object if load all images is ture\n\t\tif (self.get_lightbox_config('load_all')) {\n\n\t\t\tvar the_images = self.images;\n\n\t\t\tif ( typeof the_images !== 'object' ) {\n\t\t\t\t// this will cause a JS error\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t$.each(the_images, function (i) {\n\t\t\t\tif (this.video !== undefined && this.video.embed_url !== undefined) {\n\t\t\t\t\t// if this is a video, then the lightbox needs the embed url and not an image\n\t\t\t\t\tthis.src = this.video.embed_url;\n\t\t\t\t}\n\t\t\t\tlightbox_images.push(this);\n\t\t\t});\n\n\n\t\t} else {\n\n\t\t\tvar newIndex = 0;\n\t\t\tlet $images = $('.envira-gallery-' + self.id);\n\t\t\t$.each($images, function (i) {\n\t\t\t\tlightbox_images.push(this);\n\t\t\t});\n\n\t\t}\n\n\t\t$('#envira-gallery-wrap-' + self.id + ' .envira-gallery-link').on(\"click\", function (e) {\n\n\t\t\te.preventDefault();\n\t\t\te.stopImmediatePropagation();\n\n\t\t\tvar index = $(this).find('img').data('envira-index'),\n\t\t\t\tsrc = $(this).find('img').attr('src'),\n\t\t\t\tfound = false;\n\n\n\t\t\t// Override index if sorting is random or pagination is on\n\t\t\tif (self.get_config('pagination') === 1 || self.get_config('sort_order') == \"1\" || index === 0) {\n\n\t\t\t\tObject.entries(lightbox_images).forEach((entry) => {\n\t\t\t\t\tconst [key, value] = entry;\n\t\t\t\t\tif ($(value).find('img').prop('src') == src) {\n\t\t\t\t\t\tindex = key;\n\t\t\t\t\t\tfound = true;\n\t\t\t\t\t}\n\n\t\t\t\t});\n\n\t\t\t\tif (found !== true) {\n\n\t\t\t\t\tObject.entries(lightbox_images).forEach((entry) => {\n\t\t\t\t\t\tconst [key, value] = entry;\n\t\t\t\t\t\tif (value == $(this).attr('href')) {\n\t\t\t\t\t\t\tindex = key;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t});\n\n\t\t\t\t}\n\n\t\t\t}\n\n\n\t\t\t$.envirabox.open(lightbox_images, self.lightbox_options, index);\n\n\t\t});\n\n\t\t$(document).trigger('envirabox_lightbox_api', self);\n\n\t}\n\n\t/**\n\t * Get a config option based off of a key.\n\t *\n\t * @since 1.7.1\n\t */\n\tget_config(key) {\n\n\t\treturn this.data[key];\n\n\t}\n\n\t/**\n\t * Helper method to get config by key.\n\t *\n\t * @since 1.7.1\n\t */\n\tget_lightbox_config(key) {\n\n\t\treturn this.envirabox_config[key];\n\n\t}\n\n\t/**\n\t * Helper method to get image from id\n\t *\n\t * @since 1.7.1\n\t */\n\tget_image(id) {\n\n\t\treturn this.images[id];\n\n\t}\n\tis_mobile() {\n\t\tif (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\t/**\n\t * Helper method for logging if ENVIRA_DEBUG is true.\n\t *\n\t * @since 1.7.1\n\t */\n\tlog(log) {\n\n\t\t//Bail if debug or log is not set.\n\t\tif (envira_gallery.debug == undefined || !envira_gallery.debug || log == undefined) {\n\n\t\t\treturn;\n\n\t\t}\n\t\tconsole.log(log);\n\n\t}\n\n}\n\nmodule.exports = Envira;","class Envira_Link {\n\n\tconstructor(data, images, lightbox) {\n\n\t\tvar self = this;\n\n\t\t// Setup our Vars\n\t\tself.data = data;\n\t\tself.images = images;\n\t\tself.id = this.get_config('gallery_id');\n\t\tself.envirabox_config = lightbox;\n\n\t\t// Log if ENVIRA_DEBUG enabled\n\t\tself.log(self.data);\n\t\tself.log(self.images);\n\t\tself.log(self.envirabox_config);\n\t\tself.log(self.id);\n\n\t\tself.init();\n\n\t}\n\n\tinit() {\n\n\t\tvar self = this;\n\n\t\tself.lightbox();\n\n\t}\n\n\t/**\n\t * Outputs the gallery init script in the footer.\n\t *\n\t * @since 1.7.1\n\t */\n\tlightbox() {\n\n\t\tvar self = this,\n\t\t\ttouch = self.get_config('mobile_touchwipe') ? { vertical: true, momentum: true } : true,\n\t\t\tthumbs = self.get_config('thumbnails') ? { autoStart: true, hideOnClose: true, position: self.get_lightbox_config('thumbs_position') } : false,\n\t\t\tslideshow = self.get_config('slideshow') ? { autoStart: self.get_config('autoplay'), speed: self.get_config('ss_speed') } : false,\n\t\t\tfullscreen = self.get_config('fullscreen') && self.get_config('open_fullscreen') ? { autoStart: true } : true,\n\t\t\tanimationEffect = self.get_config('lightbox_open_close_effect') == 'zomm-in-out' ? 'zoom-in-out' : self.get_config('lightbox_open_close_effect'),\n\t\t\ttransitionEffect = self.get_config('effect') == 'zomm-in-out' ? 'zoom' : self.get_config('effect'),\n\t\t\tlightbox_images = [];\n\t\tself.lightbox_options = {\n\t\t\tselector: '[data-envirabox=\"' + self.id + '\"]',\n\t\t\tloop: self.get_config('loop'), // Enable infinite gallery navigation\n\t\t\tmargin: self.get_lightbox_config('margins'), // Space around image, ignored if zoomed-in or viewport width is smaller than 800px\n\t\t\tgutter: self.get_lightbox_config('gutter'), // Horizontal space between slides\n\t\t\tkeyboard: self.get_config('keyboard'), // Enable keyboard navigation\n\t\t\tarrows: self.get_lightbox_config('arrows'), // Should display navigation arrows at the screen edges\n\t\t\tarrow_position: self.get_lightbox_config('arrow_position'),\n\t\t\tinfobar: self.get_lightbox_config('infobar'), // Should display infobar (counter and arrows at the top)\n\t\t\ttoolbar: self.get_lightbox_config('toolbar'), // Should display toolbar (buttons at the top)\n\t\t\tidleTime: self.get_lightbox_config('idle_time') ? self.get_lightbox_config('idle_time') : false, // by default there shouldn't be any, otherwise value is in seconds\n\t\t\tsmallBtn: self.get_lightbox_config('show_smallbtn'),\n\t\t\tprotect: false, // Disable right-click and use simple image protection for images\n\t\t\timage: { preload: false },\n\t\t\tanimationEffect: animationEffect,\n\t\t\tanimationDuration: self.get_lightbox_config('animation_duration') ? self.get_lightbox_config('animation_duration') : 300, // Duration in ms for open/close animation\n\t\t\tbtnTpl: {\n\t\t\t\tsmallBtn: self.get_lightbox_config('small_btn_template'),\n\t\t\t},\n\t\t\tzoomOpacity: 'auto',\n\t\t\ttransitionEffect: transitionEffect, // Transition effect between slides\n\t\t\ttransitionDuration: self.get_lightbox_config('transition_duration') ? self.get_lightbox_config('transition_duration') : 200, // Duration in ms for transition animation\n\t\t\tbaseTpl: self.get_lightbox_config('base_template'), // Base template for layout\n\t\t\tspinnerTpl: '<div class=\"envirabox-loading\"></div>', // Loading indicator template\n\t\t\terrorTpl: self.get_lightbox_config('error_template'), // Error message template\n\t\t\tfullScreen: self.get_config('fullscreen') ? fullscreen : false,\n\t\t\ttouch: touch, // Set `touch: false` to disable dragging/swiping\n\t\t\thash: false,\n\t\t\tinsideCap: self.get_lightbox_config('inner_caption'),\n\t\t\tcapPosition: self.get_lightbox_config('caption_position'),\n\t\t\tcapTitleShow: self.get_config('lightbox_title_caption') && self.get_config('lightbox_title_caption') != 'none' && self.get_config('lightbox_title_caption') != '0' ? self.get_config('lightbox_title_caption') : false,\n\t\t\tmedia: {\n\t\t\t\tyoutube: {\n\t\t\t\t\tparams: {\n\t\t\t\t\t\tautoplay: 0\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\twheel: this.get_config('mousewheel') == false ? false : true,\n\t\t\tslideShow: slideshow,\n\t\t\tthumbs: thumbs,\n\t\t\tmobile: {\n\t\t\t\tclickContent: function (current, event) {\n\t\t\t\t\treturn current.type === 'image' ? 'toggleControls' : false;\n\t\t\t\t},\n\t\t\t\tclickSlide: function (current, event) {\n\t\t\t\t\treturn current.type === 'image' ? 'toggleControls' : 'close';\n\t\t\t\t},\n\t\t\t\tdblclickContent: false,\n\t\t\t\tdblclickSlide: false,\n\t\t\t},\n\t\t\t// Clicked on the content\n\t\t\tclickContent: self.get_lightbox_config('click_content') ? self.get_lightbox_config('click_content') : 'toggleControls', // clicked on the image itself\n\t\t\tclickSlide: self.get_lightbox_config('click_slide') ? self.get_lightbox_config('click_slide') : 'close', // clicked on the slide\n\t\t\tclickOutside: self.get_lightbox_config('click_outside') ? self.get_lightbox_config('click_outside') : 'toggleControls', // clicked on the background (backdrop) element\n\n\t\t\t// Same as previous two, but for double click\n\t\t\tdblclickContent: false,\n\t\t\tdblclickSlide: false,\n\t\t\tdblclickOutside: false,\n\n\t\t\t// Video settings\n\t\t\tvideoPlayPause: self.get_config('videos_playpause') ? true : false,\n\t\t\tvideoProgressBar: self.get_config('videos_progress') ? true : false,\n\t\t\tvideoPlaybackTime: self.get_config('videos_current') ? true : false,\n\t\t\tvideoVideoLength: self.get_config('videos_duration') ? true : false,\n\t\t\tvideoVolumeControls: self.get_config('videos_volume') ? true : false,\n\t\t\tvideoControlBar: self.get_config('videos_controls') ? true : false,\n\t\t\tvideoFullscreen: self.get_config('videos_fullscreen') ? true : false,\n\t\t\tvideoDownload: self.get_config('videos_download') ? true : false,\n\t\t\tvideoPlayIcon: self.get_config('videos_play_icon_thumbnails') ? true : false,\n\n\t\t\t// Callbacks\n\t\t\t// ==========\n\t\t\tonInit: function (instance, current) {\n\n\t\t\t\t$(document).trigger('envirabox_api_on_init', [self, instance, current]);\n\t\t\t},\n\n\t\t\tbeforeLoad: function (instance, current) {\n\n\t\t\t\t$(document).trigger('envirabox_api_before_load', [self, instance, current]);\n\n\t\t\t},\n\t\t\tafterLoad: function (instance, current) {\n\n\t\t\t\t$(document).trigger('envirabox_api_after_load', [self, instance, current]);\n\n\t\t\t},\n\n\t\t\tbeforeShow: function (instance, current) {\n\n\t\t\t\t$(document).trigger('envirabox_api_before_show', [self, instance, current]);\n\n\t\t\t},\n\t\t\tafterShow: function (instance, current) {\n\n\t\t\t\tif (prepend == undefined || prepend_cap == undefined) {\n\n\t\t\t\t\tvar prepend = false,\n\t\t\t\t\t\tprepend_cap = false;\n\n\t\t\t\t}\n\n\t\t\t\tif (prepend != true) {\n\n\t\t\t\t\t$('.envirabox-position-overlay').each(\n\t\t\t\t\t\tfunction () {\n\t\t\t\t\t\t\t$(this).prependTo(current.$content);\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\n\t\t\t\t\tprepend = true;\n\t\t\t\t}\n\n\t\t\t\t/* support older galleries or if someone overrides the keyboard configuration via a filter, etc. */\n\n\t\t\t\tif (self.get_config('keyboard') !== undefined && self.get_config('keyboard') === 0) {\n\n\t\t\t\t\t$(window).keypress(\n\t\t\t\t\t\tfunction (event) {\n\n\t\t\t\t\t\t\tif ([32, 37, 38, 39, 40].indexOf(event.keyCode) > -1) {\n\t\t\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\n\t\t\t\t}\n\n\t\t\t\t/* legacy theme we hide certain elements initially to prevent user seeing them for a second in the upper left until the CSS fully loads */\n\t\t\t\t$('.envirabox-caption').show();\n\t\t\t\t$('.envirabox-navigation').show();\n\t\t\t\t$('.envirabox-navigation-inside').show();\n\n\t\t\t\t$(document).trigger('envirabox_api_after_show', [self, instance, current]);\n\n\t\t\t},\n\n\t\t\tbeforeClose: function (instance, current) {\n\n\t\t\t\t$(document).trigger('envirabox_api_before_close', [self, instance, current]);\n\n\t\t\t},\n\t\t\tafterClose: function (instance, current) {\n\n\t\t\t\t$(document).trigger('envirabox_api_after_close', [self, instance, current]);\n\n\t\t\t},\n\n\t\t\tonActivate: function (instance, current) {\n\n\t\t\t\t$(document).trigger('envirabox_api_on_activate', [self, instance, current]);\n\n\t\t\t},\n\t\t\tonDeactivate: function (instance, current) {\n\n\t\t\t\t$(document).trigger('envirabox_api_on_deactivate', [self, instance, current]);\n\n\t\t\t},\n\n\t\t};\n\n\t\t$(document).trigger('envirabox_options', self);\n\n\t\t// Mobile Overrides\n\t\tif (self.is_mobile()) {\n\n\t\t\tif (self.get_config('mobile_thumbnails') !== 1) {\n\t\t\t\tself.lightbox_options.thumbs = false;\n\t\t\t}\n\n\t\t}\n\n\t\t$.each(\n\t\t\tself.images,\n\t\t\tfunction (i) {\n\n\t\t\t\tlightbox_images.push(this);\n\n\t\t\t\t// Formats matching url to final form\n\t\t\t\tvar format = function (url, rez, params) {\n\t\t\t\t\tif (!url) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tparams = params || '';\n\n\t\t\t\t\tif ($.type(params) === \"object\") {\n\t\t\t\t\t\tparams = $.param(params, true);\n\t\t\t\t\t}\n\n\t\t\t\t\t$.each(\n\t\t\t\t\t\trez,\n\t\t\t\t\t\tfunction (key, value) {\n\t\t\t\t\t\t\turl = url.replace('$' + key, value || '');\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\n\t\t\t\t\tif (params.length) {\n\t\t\t\t\t\turl += (url.indexOf('?') > 0 ? '&' : '?') + params;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn url;\n\t\t\t\t};\n\n\t\t\t\t/* is video? */\n\t\t\t\tvar video_defaults = {\n\t\t\t\t\tyoutube_playlist: {\n\t\t\t\t\t\tmatcher: /^http:\\/\\/(?:www\\.)?youtube\\.com\\/watch\\?((v=[^&\\s]*&list=[^&\\s]*)|(list=[^&\\s]*&v=[^&\\s]*))(&[^&\\s]*)*$/,\n\t\t\t\t\t\tparams: {\n\t\t\t\t\t\t\tautoplay: 1,\n\t\t\t\t\t\t\tautohide: 1,\n\t\t\t\t\t\t\tfs: 1,\n\t\t\t\t\t\t\trel: 0,\n\t\t\t\t\t\t\thd: 1,\n\t\t\t\t\t\t\twmode: 'transparent',\n\t\t\t\t\t\t\tenablejsapi: 1,\n\t\t\t\t\t\t\thtml5: 1\n\t\t\t\t\t\t},\n\t\t\t\t\t\tparamPlace: 8,\n\t\t\t\t\t\ttype: 'iframe',\n\t\t\t\t\t\turl: '//www.youtube.com/embed/videoseries?list=$4',\n\t\t\t\t\t\tthumb: '//img.youtube.com/vi/$4/hqdefault.jpg'\n\t\t\t\t\t},\n\n\t\t\t\t\tyoutube: {\n\t\t\t\t\t\tmatcher: /(youtube\\.com|youtu\\.be|youtube\\-nocookie\\.com)\\/(watch\\?(.*&)?v=|v\\/|u\\/|embed\\/?)?(videoseries\\?list=(.*)|[\\w-]{11}|\\?listType=(.*)&list=(.*))(.*)/i,\n\t\t\t\t\t\tparams: {\n\t\t\t\t\t\t\tautoplay: 1,\n\t\t\t\t\t\t\tautohide: 1,\n\t\t\t\t\t\t\tfs: 1,\n\t\t\t\t\t\t\trel: 0,\n\t\t\t\t\t\t\thd: 1,\n\t\t\t\t\t\t\twmode: 'transparent',\n\t\t\t\t\t\t\tenablejsapi: 1,\n\t\t\t\t\t\t\thtml5: 1\n\t\t\t\t\t\t},\n\t\t\t\t\t\tparamPlace: 8,\n\t\t\t\t\t\ttype: 'iframe',\n\t\t\t\t\t\turl: '//www.youtube.com/embed/$4',\n\t\t\t\t\t\tthumb: '//img.youtube.com/vi/$4/hqdefault.jpg'\n\t\t\t\t\t},\n\n\t\t\t\t\tvimeo: {\n\t\t\t\t\t\tmatcher: /^.+vimeo.com\\/(.*\\/)?([\\d]+)(.*)?/,\n\t\t\t\t\t\tparams: {\n\t\t\t\t\t\t\tautoplay: 1,\n\t\t\t\t\t\t\thd: 1,\n\t\t\t\t\t\t\tshow_title: 1,\n\t\t\t\t\t\t\tshow_byline: 1,\n\t\t\t\t\t\t\tshow_portrait: 0,\n\t\t\t\t\t\t\tfullscreen: 1,\n\t\t\t\t\t\t\tmuted: 1, // not sure is this is a real setting\n\t\t\t\t\t\t\tapi: 1\n\t\t\t\t\t\t},\n\t\t\t\t\t\tparamPlace: 3,\n\t\t\t\t\t\ttype: 'iframe',\n\t\t\t\t\t\turl: '//player.vimeo.com/video/$2'\n\t\t\t\t\t},\n\n\t\t\t\t\tmetacafe: {\n\t\t\t\t\t\tmatcher: /metacafe.com\\/watch\\/(\\d+)\\/(.*)?/,\n\t\t\t\t\t\ttype: 'iframe',\n\t\t\t\t\t\turl: '//www.metacafe.com/embed/$1/?ap=1'\n\t\t\t\t\t},\n\n\t\t\t\t\tdailymotion: {\n\t\t\t\t\t\tmatcher: /dailymotion.com\\/video\\/(.*)\\/?(.*)/,\n\t\t\t\t\t\tparams: {\n\t\t\t\t\t\t\tadditionalInfos: 0,\n\t\t\t\t\t\t\tautoStart: 1\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttype: 'iframe',\n\t\t\t\t\t\turl: '//www.dailymotion.com/embed/video/$1'\n\t\t\t\t\t},\n\n\t\t\t\t\tfacebook: {\n\t\t\t\t\t\tmatcher: /facebook.com\\/facebook\\/videos\\/(.*)\\/?(.*)/,\n\t\t\t\t\t\ttype: 'genericDiv',\n\t\t\t\t\t\tsubtype: 'facebook',\n\t\t\t\t\t\turl: '//www.facebook.com/facebook/videos/$1'\n\t\t\t\t\t},\n\n\t\t\t\t\tinstagram: {\n\t\t\t\t\t\tmatcher: /(instagr\\.am|instagram\\.com)\\/p\\/([a-zA-Z0-9_\\-]+)\\/?/i,\n\t\t\t\t\t\ttype: 'image',\n\t\t\t\t\t\turl: '//$1/p/$2/media/?size=l'\n\t\t\t\t\t},\n\n\t\t\t\t\tinstagram_tv: {\n\t\t\t\t\t\tmatcher: /(instagr\\.am|instagram\\.com)\\/tv\\/([a-zA-Z0-9_\\-]+)\\/?/i,\n\t\t\t\t\t\ttype: 'iframe',\n\t\t\t\t\t\turl: '//$1/p/$2/media/?size=l'\n\t\t\t\t\t},\n\n\t\t\t\t\t// https://scontent-mia3-1.cdninstagram.com/vp/f31edadb32713082be585c276d336aa8/5C66C69A/t50.2886-16/26203486_930585467119082_6733111627396153344_n.mp4?_nc_ht=scontent-mia3-1.cdninstagram.com\n\n\t\t\t\t\tinstagram_video: {\n\t\t\t\t\t\tmatcher: /(cdninstagr\\.am|cdninstagram\\.com)\\/vp\\/([a-zA-Z0-9_\\-]+)\\/?/i,\n\t\t\t\t\t\ttype: 'instagram_video',\n\t\t\t\t\t\turl: '//$1/p/$2/media/?size=l'\n\t\t\t\t\t},\n\n\t\t\t\t\twistia: {\n\t\t\t\t\t\tmatcher: /wistia.com\\/medias\\/(.*)\\/?(.*)/,\n\t\t\t\t\t\ttype: 'iframe',\n\t\t\t\t\t\turl: '//fast.wistia.net/embed/iframe/$1'\n\t\t\t\t\t},\n\n\t\t\t\t\t// Example: //player.twitch.tv/?video=270862436ß\n\t\t\t\t\ttwitch: {\n\t\t\t\t\t\tmatcher: /player.twitch.tv\\/[\\\\?&]video=([^&#]*)/,\n\t\t\t\t\t\ttype: 'iframe',\n\t\t\t\t\t\turl: '//player.twitch.tv/?video=$1'\n\t\t\t\t\t},\n\n\t\t\t\t\t// Example: //videopress.com/v/DK5mLrbr    ?at=1374&loop=1&autoplay=1\n\t\t\t\t\tvideopress: {\n\t\t\t\t\t\tmatcher: /videopress.com\\/v\\/(.*)\\/?(.*)/,\n\t\t\t\t\t\ttype: 'iframe',\n\t\t\t\t\t\turl: '//videopress.com/embed/$1'\n\t\t\t\t\t},\n\n\t\t\t\t\tself_hosted: {\n\t\t\t\t\t\tmatcher: /(.mp4|.flv|.ogv|.webm)/,\n\t\t\t\t\t\ttype: 'video'\n\t\t\t\t\t},\n\n\t\t\t\t\tpdf: {\n\t\t\t\t\t\tmatcher: /(.pdf)/,\n\t\t\t\t\t\ttype: 'iframe'\n\t\t\t\t\t},\n\n\t\t\t\t};\n\n\t\t\t\tvar image = this,\n\t\t\t\turl       = this.link || '',\n\t\t\t\ttype      = false,\n\t\t\t\tsubtype   = false,\n\t\t\t\tmedia,\n\t\t\t\tthumb,\n\t\t\t\trez,\n\t\t\t\tparams,\n\t\t\t\turlParams,\n\t\t\t\to,\n\t\t\t\tprovider  = false,\n\t\t\t\tmedia     = $.extend( true, {}, video_defaults, this.opts.media );\n\n\t\t\t\t// Look for any matching media type\n\t\t\t\t$.each(\n\t\t\t\t\tmedia,\n\t\t\t\t\tfunction (n, el) {\n\t\t\t\t\t\trez = url.match(el.matcher);\n\t\t\t\t\t\to = {};\n\n\t\t\t\t\t\tif ( ! rez || rez === undefined ) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tprovider = n;\n\t\t\t\t\t\ttype = el.type;\n\t\t\t\t\t\tsubtype = el.subtype !== undefined ? el.subtype : false;\n\n\t\t\t\t\t\tif (el.paramPlace && rez[el.paramPlace]) {\n\t\t\t\t\t\t\turlParams = rez[el.paramPlace];\n\n\t\t\t\t\t\t\tif (urlParams[0] == '?') {\n\t\t\t\t\t\t\t\turlParams = urlParams.substring(1);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\turlParams = urlParams.split('&');\n\n\t\t\t\t\t\t\tfor (var m = 0; m < urlParams.length; ++m) {\n\t\t\t\t\t\t\t\tvar p = urlParams[m].split('=', 2);\n\n\t\t\t\t\t\t\t\tif (p.length == 2) {\n\t\t\t\t\t\t\t\t\to[p[0]] = decodeURIComponent(p[1].replace(/\\+/g, \" \"));\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\n\t\t\t\t\t\tif ( el.type !== 'instagram_video' && el.url !== undefined ) {\n\t\t\t\t\t\t\turl = $.type( el.url ) === \"function\" ? el.url.call( this, rez, params, item ) : format( el.url, rez, params );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( url === undefined ) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (self.data.videos_autoplay == 1) {\n\t\t\t\t\t\t\tif (provider === 'vimeo' || provider === 'youtube') {\n\t\t\t\t\t\t\t\turl = url + '/?autoplay=1';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (provider === 'vimeo') {\n\t\t\t\t\t\t\turl = url.replace('&%23', '#');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\t// If it is found, then change content type and update the url\n\t\t\t\tif (type) {\n\t\t\t\t\tthis.video = true;\n\t\t\t\t\tthis.src = url;\n\t\t\t\t\tthis.type = type;\n\t\t\t\t\tthis.subtype = subtype;\n\n\t\t\t\t\tif (type === 'iframe') {\n\t\t\t\t\t\t$.extend(\n\t\t\t\t\t\t\ttrue,\n\t\t\t\t\t\t\tthis.opts,\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tiframe: {\n\t\t\t\t\t\t\t\t\tpreload: true,\n\t\t\t\t\t\t\t\t\tprovider: provider,\n\t\t\t\t\t\t\t\t\tattr: {\n\t\t\t\t\t\t\t\t\t\tscrolling: \"no\"\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tthis.contentProvider = provider;\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// If no content type is found, then set it to `image` as fallback\n\t\t\t\t\tthis.type = 'image';\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t);\n\n\t\t$('#envira-links-' + self.id).on(\n\t\t\t'click',\n\t\t\tfunction (e) {\n\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopImmediatePropagation();\n\n\t\t\t\tvar $this = $(this),\n\t\t\t\t\timages = [],\n\t\t\t\t\t$envira_images = $this.data('gallery-images'),\n\t\t\t\t\tsorted_ids = $this.data('gallery-sort-ids'), // sort by sort ids, not by output of gallery-images, because retaining object key order between unserialisation and serialisation in JavaScript is never guaranteed.\n\t\t\t\t\tsorting_factor = sorted_ids !== undefined && self.data.gallery_sort == 'gallery' ? 'id' : 'image',\n\t\t\t\t\tsorting_factor_data = sorted_ids !== undefined && self.data.gallery_sort == 'gallery' ? sorted_ids : $envira_images,\n\t\t\t\t\tactive = $.envirabox.getInstance();\n\n\t\t\t\t// backup plan in case there isn't sorted_ids, we keep the lightbox_images even though this is probably not sorted\n\t\t\t\tif (sorted_ids !== undefined && sorted_ids != '') {\n\n\t\t\t\t\tlightbox_images = [];\n\n\t\t\t\t\t$.each(\n\t\t\t\t\t\tsorted_ids,\n\t\t\t\t\t\tfunction (i, val) {\n\t\t\t\t\t\t\tlightbox_images.push(sorting_factor_data[val]);\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\n\t\t\t\t}\n\n\t\t\t\tif (active) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t$.envirabox.open( lightbox_images, self.lightbox_options );\n\n\n\t\t\t}\n\t\t);\n\n\t}\n\n\t/**\n\t * Get a config option based off of a key.\n\t *\n\t * @since 1.7.1\n\t */\n\tget_config(key) {\n\n\t\tvar self = this;\n\n\t\treturn self.data[key];\n\n\t}\n\n\t/**\n\t * Helper method to get config by key.\n\t *\n\t * @since 1.7.1\n\t */\n\tget_lightbox_config(key) {\n\n\t\tvar self = this;\n\n\t\treturn self.envirabox_config[key];\n\n\t}\n\n\t/**\n\t * Helper method to get image from id\n\t *\n\t * @since 1.7.1\n\t */\n\tget_image(id) {\n\n\t\tvar self = this;\n\n\t\treturn self.images[id];\n\n\t}\n\tis_mobile() {\n\t\tif (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\t/**\n\t * Helper method for logging if ENVIRA_DEBUG is true.\n\t *\n\t * @since 1.7.1\n\t */\n\tlog(log) {\n\n\t\t// Bail if debug or log is not set.\n\t\tif (envira_gallery.debug == undefined || !envira_gallery.debug || log == undefined) {\n\n\t\t\treturn;\n\n\t\t}\n\t\tconsole.log(log);\n\n\t}\n\n}\n\nmodule.exports = Envira_Link;\n","/*!\n * Justified Gallery / Envira Extensions and Overrides - v3.6.2\n * Copyright (c) 2016 David Bisset, Benjamin Rojas\n * Licensed under the MIT license.\n */\n\n(function ($) {\n\n\tvar justifiedGallery       = $.fn.justifiedGallery,\n\t\tEnviraJustifiedGallery = {};\n\n\t$.fn.enviraJustifiedGallery = function () {\n\n\t\tvar obj                    = justifiedGallery.apply( this, arguments );\n\t\t\tEnviraJustifiedGallery = obj.data( 'jg.controller' );\n\n\t\tif (EnviraJustifiedGallery !== undefined) {\n\n\t\t\tEnviraJustifiedGallery.displayEntryCaption = function ($entry) {\n\n\t\t\t\tvar $image = this.imgFromEntry( $entry );\n\n\t\t\t\tif ($image !== null && this.settings.captions) {\n\n\t\t\t\t\tvar $imgCaption = this.captionFromEntry( $entry );\n\n\t\t\t\t\t// Create it if it doesn't exists\n\t\t\t\t\tif ($imgCaption === null) {\n\n\t\t\t\t\t\tvar caption         = $image.data( 'automatic-caption' ),\n\t\t\t\t\t\t\trevised_caption = '';\n\n\t\t\t\t\t\tif ( caption !== undefined && typeof caption === 'string' ) {\n\n\t\t\t\t\t\t\tcaption         = caption.replace( '<', '&lt;' );\n\t\t\t\t\t\t\trevised_caption = $( '<textarea />' ).html( caption ).text();\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( revised_caption !== undefined ) {\n\t\t\t\t\t\t\tif (this.isValidCaption( revised_caption )) { // Create only we found something\n\t\t\t\t\t\t\t\t$imgCaption = $( '<div class=\"caption\">' + revised_caption + '</div>' );\n\t\t\t\t\t\t\t\t$image.after( $imgCaption );\n\t\t\t\t\t\t\t\t$entry.data( 'jg.createdCaption', true );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Create events (we check again the $imgCaption because it can be still inexistent)\n\t\t\t\t\tif ($imgCaption !== null) {\n\t\t\t\t\t\tif ( ! this.settings.cssAnimation) {\n\t\t\t\t\t\t\t$imgCaption.stop().fadeTo( 0, this.settings.captionSettings.nonVisibleOpacity );\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// Adjust the positioning of overlay buttons so that it doesn't overlap the caption\n\t\t\t\t\t\tvar imgCaptionHeight = $imgCaption.css( 'height' );\n\t\t\t\t\t\t$entry.find( '.envira-gallery-position-overlay.envira-gallery-bottom-left' ).css( 'bottom', imgCaptionHeight );\n\t\t\t\t\t\t$entry.find( '.envira-gallery-position-overlay.envira-gallery-bottom-right' ).css( 'bottom', imgCaptionHeight );\n\t\t\t\t\t\tthis.addCaptionEventsHandlers( $entry );\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthis.removeCaptionEventsHandlers( $entry );\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t\treturn EnviraJustifiedGallery;\n\n\t\t}\n\n\t};\n})( jQuery );\n","/*\n * Responsively Lazy\n * http://ivopetkov.com/b/lazy-load-responsive-images/\n * Copyright 2015-2016, Ivo Petkov\n * Free to use under the MIT license.\n */\nvar\tenviraLazy = (function () {\n\n\tvar hasWebPSupport                 = false,\n\t\twindowWidth                    = null,\n\t\twindowHeight                   = null,\n\t\tjustifiedReady                 = false,\n\t\tgalleryClass                   = false,\n\t\thasIntersectionObserverSupport = typeof IntersectionObserver !== 'undefined';\n\n\tvar isVisible = function (element) {\n\n\t\tif (windowWidth === null) {\n\n\t\t\twindowWidth  = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;\n\t\t\twindowHeight = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight;\n\n\t\t\tif (windowWidth === null) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\tvar rect = element.getBoundingClientRect();\n\n\t\tvar elementTop    = rect.top;\n\t\tvar elementLeft   = rect.left;\n\t\tvar elementWidth  = rect.width;\n\t\tvar elementHeight = rect.height;\n\t\tvar test          = elementTop < windowHeight && elementTop + elementHeight > 0 && elementLeft < windowWidth && elementLeft + elementWidth > 0;\n\n\t\tif ( test === false ) {\n\t\t}\n\t\treturn test;\n\n\t};\n\n\tjQuery.fn.exists = function(){return this.length > 0;}\n\n\tvar updateElement = function (container, element) {\n\t\tvar options = element.getAttribute( 'data-envira-srcset' );\n\t\tif (options !== null) {\n\t\t\toptions = options.trim();\n\t\t\tif (options.length > 0) {\n\t\t\t\toptions          = options.split( ',' );\n\t\t\t\tvar temp         = [];\n\t\t\t\tvar optionsCount = options.length;\n\t\t\t\tfor (var j = 0; j < optionsCount; j++) {\n\t\t\t\t\tvar option = options[j].trim();\n\t\t\t\t\tif (option.length === 0) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tvar spaceIndex = option.lastIndexOf( ' ' );\n\t\t\t\t\tif (spaceIndex === -1) {\n\t\t\t\t\t\tvar optionImage = option;\n\t\t\t\t\t\tvar optionWidth = 999998;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar optionImage = option.substr( 0, spaceIndex );\n\t\t\t\t\t\tvar optionWidth = parseInt( option.substr( spaceIndex + 1, option.length - spaceIndex - 2 ), 10 );\n\t\t\t\t\t}\n\t\t\t\t\tvar add = false;\n\t\t\t\t\tif (optionImage.indexOf( '.webp', optionImage.length - 5 ) !== -1) {\n\t\t\t\t\t\tif (hasWebPSupport) {\n\t\t\t\t\t\t\tadd = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tadd = true;\n\t\t\t\t\t}\n\t\t\t\t\tif (add) {\n\t\t\t\t\t\ttemp.push( [optionImage, optionWidth] );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\ttemp.sort(\n\t\t\t\t\tfunction (a, b) {\n\t\t\t\t\t\tif (a[1] < b[1]) {\n\t\t\t\t\t\t\treturn -1;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (a[1] > b[1]) {\n\t\t\t\t\t\t\treturn 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (a[1] === b[1]) {\n\t\t\t\t\t\t\tif (b[0].indexOf( '.webp', b[0].length - 5 ) !== -1) {\n\t\t\t\t\t\t\t\treturn 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (a[0].indexOf( '.webp', a[0].length - 5 ) !== -1) {\n\t\t\t\t\t\t\t\treturn -1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn 0;\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t\toptions = temp;\n\t\t\t} else {\n\t\t\t\toptions = [];\n\t\t\t}\n\t\t} else {\n\t\t\toptions = [];\n\t\t}\n\n\t\tvar containerWidth = container.offsetWidth * window.devicePixelRatio;\n\n\t\tvar bestSelectedOption = null;\n\t\tvar optionsCount       = options.length;\n\t\tfor (var j = 0; j < optionsCount; j++) {\n\t\t\tvar optionData = options[j];\n\t\t\tif (optionData[1] >= containerWidth) {\n\t\t\t\tbestSelectedOption = optionData;\n\t\t\t\tbreak;\n\t\t\t} else {\n\n\t\t\t}\n\t\t}\n\n\t\tif (bestSelectedOption === null) {\n\t\t\tbestSelectedOption = [element.getAttribute( 'data-envira-src' ), 999999];\n\t\t}\n\n\t\tif (typeof container.lastSetOption === 'undefined') {\n\t\t\tcontainer.lastSetOption = ['', 0];\n\t\t}\n\t\tif (container.lastSetOption[1] < bestSelectedOption[1]) {\n\t\t\tvar fireEvent = container.lastSetOption[1] === 0;\n\t\t\tvar url       = bestSelectedOption[0];\n\t\t\tvar image     = new Image();\n\t\t\timage.addEventListener(\n\t\t\t\t'load',\n\t\t\t\tfunction () {\n\t\t\t\t\telement.setAttribute( 'srcset', url );\n\t\t\t\t\telement.setAttribute( 'src', url );\n\t\t\t\t\tif (fireEvent) {\n\t\t\t\t\t\tvar handler = container.getAttribute( 'data-onlazyload' );\n\t\t\t\t\t\tif (handler !== null) {\n\t\t\t\t\t\t\t(new Function( handler ).bind( container ))();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tfalse\n\t\t\t);\n\t\t\timage.addEventListener(\n\t\t\t\t'error',\n\t\t\t\tfunction () {\n\t\t\t\t\tcontainer.lastSetOption = ['', 0];\n\t\t\t\t},\n\t\t\t\tfalse\n\t\t\t);\n\n\t\t\timage.onload = function () {\n\n\t\t\t\tif ( container.getAttribute( 'class' ) == 'envira-lazy' && $( container ).not( \"img\" ) ) {\n\t\t\t\t\t// this is a legacy layout\n\t\t\t\t\tvar the_image     = container.firstElementChild;\n\t\t\t\t\tvar the_container = container;\n\t\t\t\t\tvar image_id      = the_image.id;\n\t\t\t\t\tvar image_src     = the_image.src;\n\t\t\t\t\tvar gallery_id    = jQuery( the_image ).data( 'envira-gallery-id' );\n\t\t\t\t\tvar item_id       = jQuery( container ).data( 'envira-item-id' );\n\t\t\t\t\tvar naturalWidth  = this.naturalWidth;\n\t\t\t\t\tvar naturalHeight = this.naturalHeight;\n\t\t\t\t} else {\n\t\t\t\t\t// we are going with the automatic\n\t\t\t\t\tvar the_image     = image;\n\t\t\t\t\tvar the_container = container;\n\t\t\t\t\tvar image_id      = container.id;\n\t\t\t\t\tvar image_src     = container.src;\n\t\t\t\t\tvar gallery_id    = jQuery( container ).data( 'envira-gallery-id' );\n\t\t\t\t\tvar item_id       = jQuery( container ).data( 'envira-item-id' );\n\t\t\t\t\tvar naturalWidth  = this.naturalWidth;\n\t\t\t\t\tvar naturalHeight = this.naturalHeight;\n\n\t\t\t\t}\n\n\t\t\t\t/* type check */\n\n\t\t\t\tif ( gallery_id === undefined || gallery_id === null ) {\n\t\t\t\t\tgallery_id = 0;\n\t\t\t\t}\n\n\t\t\t\tjQuery( document ).trigger(\n\t\t\t\t\t{\n\t\t\t\t\t\ttype:           'envira_image_lazy_load_complete',\n\t\t\t\t\t\tcontainer:      the_container,\n\t\t\t\t\t\timage_src:      image_src,\n\t\t\t\t\t\timage_id:       image_id,\n\t\t\t\t\t\titem_id:        item_id,\n\t\t\t\t\t\tgallery_id:     gallery_id,\n\t\t\t\t\t\tnaturalWidth:   naturalWidth,\n\t\t\t\t\t\tnaturalHeight:  naturalHeight,\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t}\n\t\t\timage.onerror = function () {\n\t\t\t\tconsole.error( \"Cannot load image\" );\n\t\t\t\t// do something else...\n\t\t\t}\n\n\t\t\t// Null assignment could have been for IE, but shows as 404 in Safari web console (although everything else is fine).\n\t\t\t// This should be confirmed to be working, then removed (Chrome/Firefox testing looks ok)\n\t\t\t// image.src = null;\n\t\t\timage.src = url;\n\n\t\t\tcontainer.lastSetOption = bestSelectedOption;\n\n\t\t}\n\t};\n\n\tvar updateWindowSize = function () {\n\n\t\twindowWidth  = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;\n\t\twindowHeight = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight;\n\n\t};\n\n\tvar setGalleryClass = function ( theClass ) {\n\t\tgalleryClass = theClass;\n\t\talert( 'setting - ' + galleryClass );\n\t}\n\n\tvar run = function ( galleryClass ) {\n\n\t\tif ( typeof galleryClass === 'undefined' ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar update = function (elements, unknownHeight) {\n\t\t\tvar elementsCount = elements.length;\n\t\t\tfor (var i = 0; i < elementsCount; i++) {\n\t\t\t\tvar element   = elements[i];\n\t\t\t\tvar container = unknownHeight ? element : element.parentNode;\n\t\t\t\tif ( isVisible( container ) === true ) {\n\t\t\t\t\tupdateElement( container, element );\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tif ( galleryClass ) {\n\n\t\t\tif ( typeof galleryClass !== 'string' ) {\n\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tif ( envira_gallery.ll_delay === 'undefined' || envira_gallery.ll_initial === false || envira_gallery.ll_initial === 'undefined' ) {\n\n\t\t\t\t/* if we can't locate these vars, at least define the delay - there is no delay, super fast */\n\t\t\t\tenvira_gallery.ll_delay = 0;\n\n\t\t\t}\n\n\t\t\tvar myVar = setTimeout(\n\t\t\t\tfunction () {\n\n\t\t\t\t\tif ( jQuery( galleryClass + ' div.envira-lazy > img' ).exists() ) {\n\t\t\t\t\t\t// alert('1');\n\t\t\t\t\t\tupdate( document.querySelectorAll( galleryClass + ' div.envira-lazy > img' ), false );\n\t\t\t\t\t} else if ( jQuery( galleryClass + ' img.envira-lazy' ).exists() ) {\n\t\t\t\t\t\t// alert('2');\n\t\t\t\t\t\tupdate( document.querySelectorAll( galleryClass + ' img.envira-lazy' ), true );\n\t\t\t\t\t}\n\n\t\t\t\t\tenvira_gallery.ll_initial == true; // ok, we did the initial load so now delay can happen\n\n\t\t\t\t},\n\t\t\t\tenvira_gallery.ll_delay\n\t\t\t);\n\n\t\t}\n\t\t// update(document.querySelectorAll('img.envira-lazy'), true);\n\t};\n\n\tif ('srcset' in document.createElement( 'img' ) && typeof window.devicePixelRatio !== 'undefined' && typeof window.addEventListener !== 'undefined' && typeof document.querySelectorAll !== 'undefined') {\n\n\t\tupdateWindowSize();\n\n\t\tvar image    = new Image();\n\t\timage.src    = 'data:image/webp;base64,UklGRiQAAABXRUJQVlA4IBgAAAAwAQCdASoCAAEADMDOJaQAA3AA/uuuAAA=';\n\t\timage.onload = image.onerror = function () {\n\t\t\thasWebPSupport = image.width === 2;\n\t\t\tif (hasIntersectionObserverSupport) {\n\n\t\t\t\tvar updateIntersectionObservers = function () {\n\t\t\t\t\tvar elements      = document.querySelectorAll( '.envira-lazy' );\n\t\t\t\t\tvar elementsCount = elements.length;\n\t\t\t\t\tfor (var i = 0; i < elementsCount; i++) {\n\t\t\t\t\t\tvar element = elements[i];\n\t\t\t\t\t\tif (typeof element.responsivelyLazyObserverAttached === 'undefined') {\n\t\t\t\t\t\t\telement.responsivelyLazyObserverAttached = true;\n\t\t\t\t\t\t\tintersectionObserver.observe( element );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tvar intersectionObserver = new IntersectionObserver(\n\t\t\t\t\tfunction (entries) {\n\t\t\t\t\t\tfor (var i in entries) {\n\t\t\t\t\t\t\tvar entry = entries[i];\n\t\t\t\t\t\t\tif (entry.intersectionRatio > 0) {\n\t\t\t\t\t\t\t\tvar target = entry.target;\n\t\t\t\t\t\t\t\tif (target.tagName.toLowerCase() !== 'img') {\n\t\t\t\t\t\t\t\t\tvar img = target.querySelector( 'img' );\n\t\t\t\t\t\t\t\t\tif (img !== null) {\n\t\t\t\t\t\t\t\t\t\tupdateElement( target, img );\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tupdateElement( target, target );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\trun();\n\n\t\t\t} else {\n\n\t\t\t\tvar requestAnimationFrameFunction = window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || function (callback) {\n\t\t\t\t\twindow.setTimeout( callback, 1000 / 60 );\n\t\t\t\t};\n\n\t\t\t\tvar hasChange      = true;\n\t\t\t\tvar runIfHasChange = function () {\n\t\t\t\t\tif ( hasChange ) {\n\t\t\t\t\t\thasChange = false;\n\t\t\t\t\t\t// run();\n\t\t\t\t\t}\n\t\t\t\t\trequestAnimationFrameFunction.call( null, runIfHasChange );\n\t\t\t\t};\n\n\t\t\t\tvar setChanged = function () {\n\t\t\t\t\thasChange = true;\n\t\t\t\t\trunIfHasChange();\n\t\t\t\t};\n\n\t\t\t\tvar updateParentNodesScrollListeners = function () {\n\t\t\t\t\tvar elements      = document.querySelectorAll( '.envira-lazy' );\n\t\t\t\t\tvar elementsCount = elements.length;\n\t\t\t\t\tfor (var i = 0; i < elementsCount; i++) {\n\t\t\t\t\t\tvar parentNode = elements[i].parentNode;\n\t\t\t\t\t\twhile (parentNode && parentNode.tagName.toLowerCase() !== 'html') {\n\t\t\t\t\t\t\tif (typeof parentNode.responsivelyLazyScrollAttached === 'undefined') {\n\t\t\t\t\t\t\t\tparentNode.responsivelyLazyScrollAttached = true;\n\t\t\t\t\t\t\t\tparentNode.addEventListener( 'scroll', setChanged );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tparentNode = parentNode.parentNode;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\t// runIfHasChange();\n\t\t\t}\n\n\t\t\tvar attachEvents = function () {\n\t\t\t\tif (hasIntersectionObserverSupport) {\n\t\t\t\t\tvar resizeTimeout = null;\n\t\t\t\t}\n\t\t\t\twindow.addEventListener(\n\t\t\t\t\t'resize',\n\t\t\t\t\tfunction () {\n\t\t\t\t\t\tupdateWindowSize();\n\t\t\t\t\t\tif (hasIntersectionObserverSupport) {\n\t\t\t\t\t\t\twindow.clearTimeout( resizeTimeout );\n\t\t\t\t\t\t\tresizeTimeout = window.setTimeout(\n\t\t\t\t\t\t\t\tfunction () {\n\t\t\t\t\t\t\t\t\trun();\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t300\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tsetChanged();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t\tif (hasIntersectionObserverSupport) {\n\t\t\t\t\twindow.addEventListener( 'load', run );\n\t\t\t\t\tupdateIntersectionObservers();\n\t\t\t\t} else {\n\t\t\t\t\twindow.addEventListener( 'scroll', setChanged );\n\t\t\t\t\twindow.addEventListener( 'load', setChanged );\n\t\t\t\t\tupdateParentNodesScrollListeners();\n\t\t\t\t}\n\t\t\t\tif (typeof MutationObserver !== 'undefined') {\n\t\t\t\t\tvar observer = new MutationObserver(\n\t\t\t\t\t\tfunction () {\n\t\t\t\t\t\t\tif (hasIntersectionObserverSupport) {\n\t\t\t\t\t\t\t\tupdateIntersectionObservers();\n\t\t\t\t\t\t\t\trun();\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tupdateParentNodesScrollListeners();\n\t\t\t\t\t\t\t\tsetChanged();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t\tobserver.observe( document.querySelector( 'body' ), {childList: true, subtree: true} );\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tif (document.readyState === 'loading') {\n\t\t\t\tdocument.addEventListener( 'DOMContentLoaded', attachEvents );\n\t\t\t} else {\n\t\t\t\tattachEvents();\n\t\t\t}\n\t\t};\n\t}\n\n\treturn {\n\t\t'run': run,\n\t\t'isVisible': isVisible,\n\t\t'setGalleryClass': setGalleryClass\n\t};\n\n}());\nwindow.enviraLazy = enviraLazy;\n\nmodule.exports = enviraLazy;\n",";// ==========================================================================\n//\n// FullScreen\n// Adds fullscreen functionality\n//\n// ==========================================================================\n(function (document, $) {\n\t'use strict';\n\n\t// Collection of methods supported by user browser\n\tvar fn = (function () {\n\n\t\tvar fnMap = [\n\t\t\t[\n\t\t\t\t'requestFullscreen',\n\t\t\t\t'exitFullscreen',\n\t\t\t\t'fullscreenElement',\n\t\t\t\t'fullscreenEnabled',\n\t\t\t\t'fullscreenchange',\n\t\t\t\t'fullscreenerror'\n\t\t\t],\n\t\t\t// new WebKit\n\t\t\t[\n\t\t\t\t'webkitRequestFullscreen',\n\t\t\t\t'webkitExitFullscreen',\n\t\t\t\t'webkitFullscreenElement',\n\t\t\t\t'webkitFullscreenEnabled',\n\t\t\t\t'webkitfullscreenchange',\n\t\t\t\t'webkitfullscreenerror'\n\n\t\t\t],\n\t\t\t// old WebKit (Safari 5.1)\n\t\t\t[\n\t\t\t\t'webkitRequestFullScreen',\n\t\t\t\t'webkitCancelFullScreen',\n\t\t\t\t'webkitCurrentFullScreenElement',\n\t\t\t\t'webkitCancelFullScreen',\n\t\t\t\t'webkitfullscreenchange',\n\t\t\t\t'webkitfullscreenerror'\n\n\t\t\t],\n\t\t\t[\n\t\t\t\t'mozRequestFullScreen',\n\t\t\t\t'mozCancelFullScreen',\n\t\t\t\t'mozFullScreenElement',\n\t\t\t\t'mozFullScreenEnabled',\n\t\t\t\t'mozfullscreenchange',\n\t\t\t\t'mozfullscreenerror'\n\t\t\t],\n\t\t\t[\n\t\t\t\t'msRequestFullscreen',\n\t\t\t\t'msExitFullscreen',\n\t\t\t\t'msFullscreenElement',\n\t\t\t\t'msFullscreenEnabled',\n\t\t\t\t'MSFullscreenChange',\n\t\t\t\t'MSFullscreenError'\n\t\t\t]\n\t\t];\n\n\t\tvar val;\n\t\tvar ret = {};\n\t\tvar i, j;\n\n\t\tfor ( i = 0; i < fnMap.length; i++ ) {\n\t\t\tval = fnMap[ i ];\n\n\t\t\tif ( val && val[ 1 ] in document ) {\n\t\t\t\tfor ( j = 0; j < val.length; j++ ) {\n\t\t\t\t\tret[ fnMap[ 0 ][ j ] ] = val[ j ];\n\t\t\t\t}\n\n\t\t\t\treturn ret;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t})();\n\n\t// If browser does not have Full Screen API, then simply unset default button template and stop\n\tif ( ! fn ) {\n\n\t\tif ( $ && $.envirabox ) {\n\t\t\t$.envirabox.defaults.btnTpl.fullScreen = false;\n\t\t}\n\n\t\treturn;\n\t}\n\n\tvar FullScreen = {\n\n\t\trequest : function ( elem ) {\n\n\t\t\telem = elem || document.documentElement;\n\n\t\t\telem[ fn.requestFullscreen ]( elem.ALLOW_KEYBOARD_INPUT );\n\n\t\t},\n\t\texit : function () {\n\n\t\t\tdocument[ fn.exitFullscreen ]();\n\n\t\t},\n\t\ttoggle : function ( elem ) {\n\n\t\t\telem = elem || document.documentElement;\n\n\t\t\tif ( this.isFullscreen() ) {\n\t\t\t\tthis.exit();\n\n\t\t\t} else {\n\t\t\t\tthis.request( elem );\n\t\t\t}\n\n\t\t},\n\t\tisFullscreen : function()  {\n\n\t\t\treturn Boolean( document[ fn.fullscreenElement ] );\n\n\t\t},\n\t\tenabled : function()  {\n\n\t\t\treturn Boolean( document[ fn.fullscreenEnabled ] );\n\n\t\t}\n\t};\n\n\t$( document ).on(\n\t\t{\n\t\t\t'onInit.eb' : function(e, instance) {\n\t\t\t\tvar $container;\n\n\t\t\t\tvar $button = instance.$refs.toolbar.find( '[data-envirabox-fullscreen]' );\n\n\t\t\t\tif ( instance && ! instance.FullScreen && instance.group[ instance.currIndex ].opts.fullScreen ) {\n\t\t\t\t\t$container = instance.$refs.container;\n\n\t\t\t\t\t$container.on(\n\t\t\t\t\t\t'click.eb-fullscreen',\n\t\t\t\t\t\t'[data-envirabox-fullscreen]',\n\t\t\t\t\t\tfunction(e) {\n\n\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\t\t\tFullScreen.toggle( $container[ 0 ] );\n\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\n\t\t\t\t\tif ( instance.opts.fullScreen && instance.opts.fullScreen.autoStart === true ) {\n\t\t\t\t\t\tFullScreen.request( $container[ 0 ] );\n\t\t\t\t\t}\n\n\t\t\t\t\t// Expose API\n\t\t\t\t\tinstance.FullScreen = FullScreen;\n\n\t\t\t\t} else {\n\t\t\t\t\t$button.hide();\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\t'afterKeydown.eb' : function(e, instance, current, keypress, keycode) {\n\n\t\t\t\t// \"P\" or Spacebar\n\t\t\t\tif ( instance && instance.FullScreen && keycode === 70 ) {\n\t\t\t\t\tkeypress.preventDefault();\n\n\t\t\t\t\tinstance.FullScreen.toggle( instance.$refs.container[ 0 ] );\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\t'beforeClose.eb' : function( instance ) {\n\t\t\t\tif ( instance && instance.FullScreen ) {\n\t\t\t\t\tFullScreen.exit();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t);\n\n\t$( document ).on(\n\t\tfn.fullscreenchange,\n\t\tfunction() {\n\t\t\tvar instance = $.envirabox.getInstance();\n\n\t\t\t// If image is zooming, then force to stop and reposition properly\n\t\t\tif ( instance.current && instance.current.type === 'image' && instance.isAnimating ) {\n\t\t\t\tinstance.current.$content.css( 'transition', 'none' );\n\n\t\t\t\tinstance.isAnimating = false;\n\n\t\t\t\tinstance.update( true, true, 0 );\n\t\t\t}\n\n\t\t\t$( document ).trigger( 'onFullscreenChange', FullScreen.isFullscreen() );\n\n\t\t}\n\t);\n\n}(document, window.jQuery));\n",";// ==========================================================================\n//\n// Guestures\n// Adds touch guestures, handles click and tap events\n//\n// ==========================================================================\n(function (window, document, $) {\n\t'use strict';\n\n\tvar requestAFrame = (function () {\n\t\treturn window.requestAnimationFrame ||\n\t\t\t\twindow.webkitRequestAnimationFrame ||\n\t\t\t\twindow.mozRequestAnimationFrame ||\n\t\t\t\twindow.oRequestAnimationFrame ||\n\t\t\t\t// if all else fails, use setTimeout\n\t\t\t\tfunction (callback) {\n\t\t\t\t\treturn window.setTimeout( callback, 1000 / 60 );\n\t\t\t\t};\n\t})();\n\n\tvar cancelAFrame = (function () {\n\t\treturn window.cancelAnimationFrame ||\n\t\t\t\twindow.webkitCancelAnimationFrame ||\n\t\t\t\twindow.mozCancelAnimationFrame ||\n\t\t\t\twindow.oCancelAnimationFrame ||\n\t\t\t\tfunction (id) {\n\t\t\t\t\twindow.clearTimeout( id );\n\t\t\t\t};\n\t})();\n\n\tvar pointers = function( e ) {\n\t\tvar result = [];\n\n\t\te = e.originalEvent || e || window.e;\n\t\te = e.touches && e.touches.length ? e.touches : ( e.changedTouches && e.changedTouches.length ? e.changedTouches : [ e ] );\n\n\t\tfor ( var key in e ) {\n\n\t\t\tif ( e[ key ].pageX ) {\n\t\t\t\tresult.push( { x : e[ key ].pageX, y : e[ key ].pageY } );\n\n\t\t\t} else if ( e[ key ].clientX ) {\n\t\t\t\tresult.push( { x : e[ key ].clientX, y : e[ key ].clientY } );\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t};\n\n\tvar distance = function( point2, point1, what ) {\n\t\tif ( ! point1 || ! point2 ) {\n\t\t\treturn 0;\n\t\t}\n\n\t\tif ( what === 'x' ) {\n\t\t\treturn point2.x - point1.x;\n\n\t\t} else if ( what === 'y' ) {\n\t\t\treturn point2.y - point1.y;\n\t\t}\n\n\t\treturn Math.sqrt( Math.pow( point2.x - point1.x, 2 ) + Math.pow( point2.y - point1.y, 2 ) );\n\t};\n\n\tvar isClickable = function( $el ) {\n\n\t\tif ( $el.is( 'a,area,button,[role=\"button\"],input,label,select,summary,textarea' ) || $.isFunction( $el.get( 0 ).onclick ) || $el.data( 'selectable' ) ) {\n\t\t\treturn true;\n\t\t}\n\n\t\t// Check for attributes like data-envirabox-next or data-envirabox-close\n\t\tfor ( var i = 0, atts = $el[0].attributes, n = atts.length; i < n; i++ ) {\n\t\t\tif ( atts[i].nodeName.substr( 0, 14 ) === 'data-envirabox-' ) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t};\n\n\tvar hasScrollbars = function( el ) {\n\t\tvar overflowY = window.getComputedStyle( el )['overflow-y'];\n\t\tvar overflowX = window.getComputedStyle( el )['overflow-x'];\n\n\t\tvar vertical   = (overflowY === 'scroll' || overflowY === 'auto') && el.scrollHeight > el.clientHeight;\n\t\tvar horizontal = (overflowX === 'scroll' || overflowX === 'auto') && el.scrollWidth > el.clientWidth;\n\n\t\treturn vertical || horizontal;\n\t};\n\n\tvar isScrollable = function ( $el ) {\n\t\tvar rez = false;\n\n\t\twhile ( true ) {\n\t\t\trez = hasScrollbars( $el.get( 0 ) );\n\n\t\t\tif ( rez ) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t$el = $el.parent();\n\n\t\t\tif ( ! $el.length || $el.hasClass( 'envirabox-stage' ) || $el.is( 'body' ) ) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn rez;\n\t};\n\n\tvar Guestures = function ( instance ) {\n\t\tvar self = this;\n\n\t\tself.instance = instance;\n\n\t\tself.$bg        = instance.$refs.bg;\n\t\tself.$stage     = instance.$refs.stage;\n\t\tself.$container = instance.$refs.container;\n\n\t\tself.destroy();\n\n\t\tself.$container.on( 'touchstart.eb.touch mousedown.eb.touch', $.proxy( self, 'ontouchstart' ) );\n\t};\n\n\tGuestures.prototype.destroy = function() {\n\t\tthis.$container.off( '.eb.touch' );\n\t};\n\n\tGuestures.prototype.ontouchstart = function( e ) {\n\t\tvar self = this;\n\n\t\tvar $target  = $( e.target );\n\t\tvar instance = self.instance;\n\t\tvar current  = instance.current;\n\t\tvar $content = current.$content;\n\n\t\tvar isTouchDevice = ( e.type == 'touchstart' );\n\n\t\t// Do not respond to both events\n\t\tif ( isTouchDevice ) {\n\t\t\tself.$container.off( 'mousedown.eb.touch' );\n\t\t}\n\n\t\t// Ignore clicks while zooming or closing\n\t\tif ( ! current || self.instance.isAnimating || self.instance.isClosing ) {\n\t\t\te.stopPropagation();\n\t\t\te.preventDefault();\n\n\t\t\treturn;\n\t\t}\n\n\t\t// Ignore right click\n\t\tif ( e.originalEvent && e.originalEvent.button == 2 ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Ignore taping on links, buttons, input elements\n\t\tif ( ! $target.length || isClickable( $target ) || isClickable( $target.parent() ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Ignore clicks on the scrollbar\n\t\tif ( e.originalEvent.clientX > $target[0].clientWidth + $target.offset().left ) {\n\t\t\treturn;\n\t\t}\n\n\t\tself.startPoints = pointers( e );\n\n\t\t// Prevent zooming if already swiping\n\t\tif ( ! self.startPoints || ( self.startPoints.length > 1 && instance.isSliding ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tself.$target  = $target;\n\t\tself.$content = $content;\n\t\tself.canTap   = true;\n\t\tself.opts     = current.opts.touch;\n\n\t\t$( document ).off( '.eb.touch' );\n\n\t\t$( document ).on( isTouchDevice ? 'touchend.eb.touch touchcancel.eb.touch' : 'mouseup.eb.touch mouseleave.eb.touch',  $.proxy( self, \"ontouchend\" ) );\n\t\t$( document ).on( isTouchDevice ? 'touchmove.eb.touch' : 'mousemove.eb.touch',  $.proxy( self, \"ontouchmove\" ) );\n\n\t\tif ( ! (self.opts || instance.canPan() ) || ! ( $target.is( self.$stage ) || self.$stage.find( $target ).length ) ) {\n\n\t\t\t// Prevent ghosting\n\t\t\tif ( $target.is( 'img' ) ) {\n\t\t\t\te.preventDefault();\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\te.stopPropagation();\n\n\t\tif ( ! ( $.envirabox.isMobile && ( isScrollable( self.$target ) || isScrollable( self.$target.parent() ) ) ) ) {\n\t\t\te.preventDefault();\n\t\t}\n\n\t\tself.canvasWidth  = Math.round( current.$slide[0].clientWidth );\n\t\tself.canvasHeight = Math.round( current.$slide[0].clientHeight );\n\n\t\tself.startTime = new Date().getTime();\n\t\tself.distanceX = self.distanceY = self.distance = 0;\n\n\t\tself.isPanning = false;\n\t\tself.isSwiping = false;\n\t\tself.isZooming = false;\n\n\t\tself.sliderStartPos  = self.sliderLastPos || { top: 0, left: 0 };\n\t\tself.contentStartPos = $.envirabox.getTranslate( self.$content );\n\t\tself.contentLastPos  = null;\n\n\t\tif ( self.startPoints.length === 1 && ! self.isZooming ) {\n\t\t\tself.canTap = ! instance.isSliding;\n\n\t\t\tif ( current.type === 'image' && ( self.contentStartPos.width > self.canvasWidth + 1 || self.contentStartPos.height > self.canvasHeight + 1 ) ) {\n\n\t\t\t\t$.envirabox.stop( self.$content );\n\n\t\t\t\tself.$content.css( 'transition-duration', '0ms' );\n\n\t\t\t\tself.isPanning = true;\n\n\t\t\t} else {\n\n\t\t\t\tself.isSwiping = true;\n\t\t\t}\n\n\t\t\tself.$container.addClass( 'envirabox-controls--isGrabbing' );\n\t\t}\n\n\t\tif ( self.startPoints.length === 2 && ! instance.isAnimating && ! current.hasError && current.type === 'image' && ( current.isLoaded || current.$ghost ) ) {\n\t\t\tself.isZooming = true;\n\n\t\t\tself.isSwiping = false;\n\t\t\tself.isPanning = false;\n\n\t\t\t$.envirabox.stop( self.$content );\n\n\t\t\tself.$content.css( 'transition-duration', '0ms' );\n\n\t\t\tself.centerPointStartX = ( ( self.startPoints[0].x + self.startPoints[1].x ) * 0.5 ) - $( window ).scrollLeft();\n\t\t\tself.centerPointStartY = ( ( self.startPoints[0].y + self.startPoints[1].y ) * 0.5 ) - $( window ).scrollTop();\n\n\t\t\tself.percentageOfImageAtPinchPointX = ( self.centerPointStartX - self.contentStartPos.left ) / self.contentStartPos.width;\n\t\t\tself.percentageOfImageAtPinchPointY = ( self.centerPointStartY - self.contentStartPos.top  ) / self.contentStartPos.height;\n\n\t\t\tself.startDistanceBetweenFingers = distance( self.startPoints[0], self.startPoints[1] );\n\t\t}\n\n\t};\n\n\tGuestures.prototype.ontouchmove = function( e ) {\n\n\t\tvar self = this;\n\n\t\tself.newPoints = pointers( e );\n\n\t\tif ( $.envirabox.isMobile && ( isScrollable( self.$target ) || isScrollable( self.$target.parent() ) ) ) {\n\t\t\te.stopPropagation();\n\n\t\t\tself.canTap = false;\n\n\t\t\treturn;\n\t\t}\n\n\t\tif ( ! ( self.opts || self.instance.canPan() ) || ! self.newPoints || ! self.newPoints.length ) {\n\t\t\treturn;\n\t\t}\n\n\t\tself.distanceX = distance( self.newPoints[0], self.startPoints[0], 'x' );\n\t\tself.distanceY = distance( self.newPoints[0], self.startPoints[0], 'y' );\n\n\t\tself.distance = distance( self.newPoints[0], self.startPoints[0] );\n\n\t\t// Skip false ontouchmove events (Chrome)\n\t\tif ( self.distance > 0 ) {\n\n\t\t\tif ( ! ( self.$target.is( self.$stage ) || self.$stage.find( self.$target ).length ) ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\te.stopPropagation();\n\t\t\te.preventDefault();\n\n\t\t\tif ( self.isSwiping ) {\n\t\t\t\tself.onSwipe();\n\n\t\t\t} else if ( self.isPanning ) {\n\t\t\t\tself.onPan();\n\n\t\t\t} else if ( self.isZooming ) {\n\t\t\t\tself.onZoom();\n\t\t\t}\n\n\t\t}\n\n\t};\n\n\tGuestures.prototype.onSwipe = function() {\n\n\t\tvar self = this;\n\n\t\tvar swiping = self.isSwiping;\n\t\tvar left    = self.sliderStartPos.left || 0;\n\t\tvar angle;\n\n\t\tif ( swiping === true ) {\n\n\t\t\tif ( Math.abs( self.distance ) > 10 ) {\n\n\t\t\t\tself.canTap = false;\n\n\t\t\t\tif ( self.instance.group.length < 2 && self.opts.vertical ) {\n\t\t\t\t\tself.isSwiping = 'y';\n\n\t\t\t\t} else if ( self.instance.isSliding || self.opts.vertical === false || ( self.opts.vertical === 'auto' && $( window ).width() > 800 ) ) {\n\t\t\t\t\tself.isSwiping = 'x';\n\n\t\t\t\t} else {\n\t\t\t\t\tangle = Math.abs( Math.atan2( self.distanceY, self.distanceX ) * 180 / Math.PI );\n\n\t\t\t\t\tself.isSwiping = ( angle > 45 && angle < 135 ) ? 'y' : 'x';\n\t\t\t\t}\n\n\t\t\t\tself.instance.isSliding = self.isSwiping;\n\n\t\t\t\t// Reset points to avoid jumping, because we dropped first swipes to calculate the angle\n\t\t\t\tself.startPoints = self.newPoints;\n\n\t\t\t\t$.each(\n\t\t\t\t\tself.instance.slides,\n\t\t\t\t\tfunction( index, slide ) {\n\t\t\t\t\t\t$.envirabox.stop( slide.$slide );\n\n\t\t\t\t\t\tslide.$slide.css( 'transition-duration', '0ms' );\n\n\t\t\t\t\t\tslide.inTransition = false;\n\n\t\t\t\t\t\tif ( slide.pos === self.instance.current.pos ) {\n\t\t\t\t\t\t\tself.sliderStartPos.left = $.envirabox.getTranslate( slide.$slide ).left;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\t// self.instance.current.isMoved = true;\n\t\t\t\t// Stop slideshow\n\t\t\t\tif ( self.instance.SlideShow && self.instance.SlideShow.isActive ) {\n\t\t\t\t\tself.instance.SlideShow.stop();\n\t\t\t\t}\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tif ( swiping == 'x' ) {\n\n\t\t\t\t// Sticky edges\n\t\t\t\tif ( self.distanceX > 0 && ( self.instance.group.length < 2 || ( self.instance.current.index === 0 && ! self.instance.current.opts.loop ) ) ) {\n\t\t\t\t\tleft = left + Math.pow( self.distanceX, 0.8 );\n\n\t\t\t\t} else if ( self.distanceX < 0 && ( self.instance.group.length < 2 || ( self.instance.current.index === self.instance.group.length - 1 && ! self.instance.current.opts.loop ) ) ) {\n\t\t\t\t\tleft = left - Math.pow( -self.distanceX, 0.8 );\n\n\t\t\t\t} else {\n\t\t\t\t\tleft = left + self.distanceX;\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tself.sliderLastPos = {\n\t\t\t\ttop  : swiping == 'x' ? 0 : self.sliderStartPos.top + self.distanceY,\n\t\t\t\tleft : left\n\t\t\t};\n\n\t\t\tif ( self.requestId ) {\n\t\t\t\tcancelAFrame( self.requestId );\n\n\t\t\t\tself.requestId = null;\n\t\t\t}\n\n\t\t\tself.requestId = requestAFrame(\n\t\t\t\tfunction() {\n\n\t\t\t\t\tif ( self.sliderLastPos ) {\n\t\t\t\t\t\t$.each(\n\t\t\t\t\t\t\tself.instance.slides,\n\t\t\t\t\t\t\tfunction( index, slide ) {\n\t\t\t\t\t\t\t\tvar pos = slide.pos - self.instance.currPos;\n\n\t\t\t\t\t\t\t\t$.envirabox.setTranslate(\n\t\t\t\t\t\t\t\t\tslide.$slide,\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\ttop  : self.sliderLastPos.top,\n\t\t\t\t\t\t\t\t\t\tleft : self.sliderLastPos.left + ( pos * self.canvasWidth ) + ( pos * slide.opts.gutter )\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tself.$container.addClass( 'envirabox-is-sliding' );\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t);\n\n\t\t}\n\n\t};\n\n\tGuestures.prototype.onPan = function() {\n\n\t\tvar self = this;\n\n\t\tvar newOffsetX, newOffsetY, newPos;\n\n\t\tself.canTap = false;\n\n\t\tif ( self.contentStartPos.width > self.canvasWidth ) {\n\t\t\tnewOffsetX = self.contentStartPos.left + self.distanceX;\n\n\t\t} else {\n\t\t\tnewOffsetX = self.contentStartPos.left;\n\t\t}\n\n\t\tnewOffsetY = self.contentStartPos.top + self.distanceY;\n\n\t\tnewPos = self.limitMovement( newOffsetX, newOffsetY, self.contentStartPos.width, self.contentStartPos.height );\n\n\t\tnewPos.scaleX = self.contentStartPos.scaleX;\n\t\tnewPos.scaleY = self.contentStartPos.scaleY;\n\n\t\tself.contentLastPos = newPos;\n\n\t\tif ( self.requestId ) {\n\t\t\tcancelAFrame( self.requestId );\n\n\t\t\tself.requestId = null;\n\t\t}\n\n\t\tself.requestId = requestAFrame(\n\t\t\tfunction() {\n\t\t\t\t$.envirabox.setTranslate( self.$content, self.contentLastPos );\n\t\t\t}\n\t\t);\n\t};\n\n\t// Make panning sticky to the edges\n\tGuestures.prototype.limitMovement = function( newOffsetX, newOffsetY, newWidth, newHeight ) {\n\n\t\tvar self = this;\n\n\t\tvar minTranslateX, minTranslateY, maxTranslateX, maxTranslateY;\n\n\t\tvar canvasWidth  = self.canvasWidth;\n\t\tvar canvasHeight = self.canvasHeight;\n\n\t\tvar currentOffsetX = self.contentStartPos.left;\n\t\tvar currentOffsetY = self.contentStartPos.top;\n\n\t\tvar distanceX = self.distanceX;\n\t\tvar distanceY = self.distanceY;\n\n\t\t// Slow down proportionally to traveled distance\n\t\tminTranslateX = Math.max( 0, canvasWidth * 0.5 - newWidth * 0.5 );\n\t\tminTranslateY = Math.max( 0, canvasHeight * 0.5 - newHeight * 0.5 );\n\n\t\tmaxTranslateX = Math.min( canvasWidth - newWidth,  canvasWidth * 0.5 - newWidth * 0.5 );\n\t\tmaxTranslateY = Math.min( canvasHeight - newHeight, canvasHeight * 0.5 - newHeight * 0.5 );\n\n\t\tif ( newWidth > canvasWidth ) {\n\n\t\t\t// ->\n\t\t\tif ( distanceX > 0 && newOffsetX > minTranslateX ) {\n\t\t\t\tnewOffsetX = minTranslateX - 1 + Math.pow( -minTranslateX + currentOffsetX + distanceX, 0.8 ) || 0;\n\t\t\t}\n\n\t\t\t// <-\n\t\t\tif ( distanceX < 0 && newOffsetX < maxTranslateX ) {\n\t\t\t\tnewOffsetX = maxTranslateX + 1 - Math.pow( maxTranslateX - currentOffsetX - distanceX, 0.8 ) || 0;\n\t\t\t}\n\n\t\t}\n\n\t\tif ( newHeight > canvasHeight ) {\n\n\t\t\t// \\/\n\t\t\tif ( distanceY > 0 && newOffsetY > minTranslateY ) {\n\t\t\t\tnewOffsetY = minTranslateY - 1 + Math.pow( -minTranslateY + currentOffsetY + distanceY, 0.8 ) || 0;\n\t\t\t}\n\n\t\t\t// \\\n\t\t\tif ( distanceY < 0 && newOffsetY < maxTranslateY ) {\n\t\t\t\tnewOffsetY = maxTranslateY + 1 - Math.pow( maxTranslateY - currentOffsetY - distanceY, 0.8 ) || 0;\n\t\t\t}\n\n\t\t}\n\n\t\treturn {\n\t\t\ttop  : newOffsetY,\n\t\t\tleft : newOffsetX\n\t\t};\n\n\t};\n\n\tGuestures.prototype.limitPosition = function( newOffsetX, newOffsetY, newWidth, newHeight ) {\n\n\t\tvar self = this;\n\n\t\tvar canvasWidth  = self.canvasWidth;\n\t\tvar canvasHeight = self.canvasHeight;\n\n\t\tif ( newWidth > canvasWidth ) {\n\t\t\tnewOffsetX = newOffsetX > 0 ? 0 : newOffsetX;\n\t\t\tnewOffsetX = newOffsetX < canvasWidth - newWidth ? canvasWidth - newWidth : newOffsetX;\n\n\t\t} else {\n\n\t\t\t// Center horizontally\n\t\t\tnewOffsetX = Math.max( 0, canvasWidth / 2 - newWidth / 2 );\n\n\t\t}\n\n\t\tif ( newHeight > canvasHeight ) {\n\t\t\tnewOffsetY = newOffsetY > 0 ? 0 : newOffsetY;\n\t\t\tnewOffsetY = newOffsetY < canvasHeight - newHeight ? canvasHeight - newHeight : newOffsetY;\n\n\t\t} else {\n\n\t\t\t// Center vertically\n\t\t\tnewOffsetY = Math.max( 0, canvasHeight / 2 - newHeight / 2 );\n\n\t\t}\n\n\t\treturn {\n\t\t\ttop  : newOffsetY,\n\t\t\tleft : newOffsetX\n\t\t};\n\n\t};\n\n\tGuestures.prototype.onZoom = function() {\n\n\t\tvar self = this;\n\n\t\t// Calculate current distance between points to get pinch ratio and new width and height\n\t\tvar currentWidth  = self.contentStartPos.width;\n\t\tvar currentHeight = self.contentStartPos.height;\n\n\t\tvar currentOffsetX = self.contentStartPos.left;\n\t\tvar currentOffsetY = self.contentStartPos.top;\n\n\t\tvar endDistanceBetweenFingers = distance( self.newPoints[0], self.newPoints[1] );\n\n\t\tvar pinchRatio = endDistanceBetweenFingers / self.startDistanceBetweenFingers;\n\n\t\tvar newWidth  = Math.floor( currentWidth * pinchRatio );\n\t\tvar newHeight = Math.floor( currentHeight * pinchRatio );\n\n\t\t// This is the translation due to pinch-zooming\n\t\tvar translateFromZoomingX = (currentWidth - newWidth) * self.percentageOfImageAtPinchPointX;\n\t\tvar translateFromZoomingY = (currentHeight - newHeight) * self.percentageOfImageAtPinchPointY;\n\n\t\t// Point between the two touches\n\t\tvar centerPointEndX = ((self.newPoints[0].x + self.newPoints[1].x) / 2) - $( window ).scrollLeft();\n\t\tvar centerPointEndY = ((self.newPoints[0].y + self.newPoints[1].y) / 2) - $( window ).scrollTop();\n\n\t\t// And this is the translation due to translation of the centerpoint\n\t\t// between the two fingers\n\t\tvar translateFromTranslatingX = centerPointEndX - self.centerPointStartX;\n\t\tvar translateFromTranslatingY = centerPointEndY - self.centerPointStartY;\n\n\t\t// The new offset is the old/current one plus the total translation\n\t\tvar newOffsetX = currentOffsetX + ( translateFromZoomingX + translateFromTranslatingX );\n\t\tvar newOffsetY = currentOffsetY + ( translateFromZoomingY + translateFromTranslatingY );\n\n\t\tvar newPos = {\n\t\t\ttop    : newOffsetY,\n\t\t\tleft   : newOffsetX,\n\t\t\tscaleX : self.contentStartPos.scaleX * pinchRatio,\n\t\t\tscaleY : self.contentStartPos.scaleY * pinchRatio\n\t\t};\n\n\t\tself.canTap = false;\n\n\t\tself.newWidth  = newWidth;\n\t\tself.newHeight = newHeight;\n\n\t\tself.contentLastPos = newPos;\n\n\t\tif ( self.requestId ) {\n\t\t\tcancelAFrame( self.requestId );\n\n\t\t\tself.requestId = null;\n\t\t}\n\n\t\tself.requestId = requestAFrame(\n\t\t\tfunction() {\n\t\t\t\t$.envirabox.setTranslate( self.$content, self.contentLastPos );\n\t\t\t}\n\t\t);\n\n\t};\n\n\tGuestures.prototype.ontouchend = function( e ) {\n\n\t\tvar self = this;\n\t\tvar dMs  = Math.max( (new Date().getTime() ) - self.startTime, 1 );\n\n\t\tvar swiping = self.isSwiping;\n\t\tvar panning = self.isPanning;\n\t\tvar zooming = self.isZooming;\n\n\t\tself.endPoints = pointers( e );\n\n\t\tself.$container.removeClass( 'envirabox-controls--isGrabbing' );\n\n\t\t$( document ).off( '.eb.touch' );\n\n\t\tif ( self.requestId ) {\n\t\t\tcancelAFrame( self.requestId );\n\n\t\t\tself.requestId = null;\n\t\t}\n\n\t\tself.isSwiping = false;\n\t\tself.isPanning = false;\n\t\tself.isZooming = false;\n\n\t\tif ( self.canTap ) {\n\t\t\treturn self.onTap( e );\n\t\t}\n\n\t\tself.speed = 366;\n\n\t\t// Speed in px/ms\n\t\tself.velocityX = self.distanceX / dMs * 0.5;\n\t\tself.velocityY = self.distanceY / dMs * 0.5;\n\n\t\tself.speedX = Math.max( self.speed * 0.5, Math.min( self.speed * 1.5, ( 1 / Math.abs( self.velocityX ) ) * self.speed ) );\n\n\t\tif ( panning ) {\n\t\t\tself.endPanning();\n\n\t\t} else if ( zooming ) {\n\t\t\tself.endZooming();\n\n\t\t} else {\n\t\t\tself.endSwiping( swiping );\n\t\t}\n\n\t\treturn;\n\t};\n\n\tGuestures.prototype.endSwiping = function( swiping ) {\n\n\t\tvar self = this;\n\t\tvar ret  = false;\n\n\t\tself.instance.isSliding = false;\n\t\tself.sliderLastPos      = null;\n\n\t\t// Close if swiped vertically / navigate if horizontally\n\t\tif ( swiping == 'y' && Math.abs( self.distanceY ) > 50 ) {\n\n\t\t\t// Continue vertical movement\n\t\t\t$.envirabox.animate(\n\t\t\t\tself.instance.current.$slide,\n\t\t\t\t{\n\t\t\t\t\ttop     : self.sliderStartPos.top + self.distanceY + ( self.velocityY * 150 ),\n\t\t\t\t\topacity : 0\n\t\t\t\t},\n\t\t\t\t150\n\t\t\t);\n\n\t\t\tret = self.instance.close( true, 300 );\n\n\t\t} else if ( swiping == 'x' && self.distanceX > 50 && self.instance.group.length > 1 ) {\n\t\t\tret = self.instance.previous( self.speedX );\n\n\t\t} else if ( swiping == 'x' && self.distanceX < -50 && self.instance.group.length > 1 ) {\n\t\t\tret = self.instance.next( self.speedX );\n\t\t}\n\n\t\tif ( ret === false && ( swiping == 'x' || swiping == 'y' ) ) {\n\t\t\tself.instance.jumpTo( self.instance.current.index, 150 );\n\t\t}\n\n\t\tself.$container.removeClass( 'envirabox-is-sliding' );\n\n\t};\n\n\t// Limit panning from edges\n\t// ========================\n\tGuestures.prototype.endPanning = function() {\n\n\t\tvar self = this;\n\t\tvar newOffsetX, newOffsetY, newPos;\n\n\t\tif ( ! self.contentLastPos ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( self.opts.momentum === false ) {\n\t\t\tnewOffsetX = self.contentLastPos.left;\n\t\t\tnewOffsetY = self.contentLastPos.top;\n\n\t\t} else {\n\n\t\t\t// Continue movement\n\t\t\tnewOffsetX = self.contentLastPos.left + ( self.velocityX * self.speed );\n\t\t\tnewOffsetY = self.contentLastPos.top + ( self.velocityY * self.speed );\n\t\t}\n\n\t\tnewPos = self.limitPosition( newOffsetX, newOffsetY, self.contentStartPos.width, self.contentStartPos.height );\n\n\t\t newPos.width  = self.contentStartPos.width;\n\t\t newPos.height = self.contentStartPos.height;\n\n\t\t$.envirabox.animate( self.$content, newPos, 330 );\n\t};\n\n\tGuestures.prototype.endZooming = function() {\n\n\t\tvar self = this;\n\n\t\tvar current = self.instance.current;\n\n\t\tvar newOffsetX, newOffsetY, newPos, reset;\n\n\t\tvar newWidth  = self.newWidth;\n\t\tvar newHeight = self.newHeight;\n\n\t\tif ( ! self.contentLastPos ) {\n\t\t\treturn;\n\t\t}\n\n\t\tnewOffsetX = self.contentLastPos.left;\n\t\tnewOffsetY = self.contentLastPos.top;\n\n\t\treset = {\n\t\t\ttop    : newOffsetY,\n\t\t\tleft   : newOffsetX,\n\t\t\twidth  : newWidth,\n\t\t\theight : newHeight,\n\t\t\tscaleX : 1,\n\t\t\tscaleY : 1\n\t\t};\n\n\t\t// Reset scalex/scaleY values; this helps for perfomance and does not break animation\n\t\t$.envirabox.setTranslate( self.$content, reset );\n\n\t\tif ( newWidth < self.canvasWidth && newHeight < self.canvasHeight ) {\n\t\t\tself.instance.scaleToFit( 150 );\n\n\t\t} else if ( newWidth > current.width || newHeight > current.height ) {\n\t\t\tself.instance.scaleToActual( self.centerPointStartX, self.centerPointStartY, 150 );\n\n\t\t} else {\n\n\t\t\tnewPos = self.limitPosition( newOffsetX, newOffsetY, newWidth, newHeight );\n\n\t\t\t// Switch from scale() to width/height or animation will not work correctly\n\t\t\t$.envirabox.setTranslate( self.content, $.envirabox.getTranslate( self.$content ) );\n\n\t\t\t$.envirabox.animate( self.$content, newPos, 150 );\n\t\t}\n\n\t};\n\n\tGuestures.prototype.onTap = function(e) {\n\t\tvar self    = this;\n\t\tvar $target = $( e.target );\n\n\t\tvar instance = self.instance;\n\t\tvar current  = instance.current;\n\n\t\tvar endPoints = ( e && pointers( e ) ) || self.startPoints;\n\n\t\tvar tapX = endPoints[0] ? endPoints[0].x - self.$stage.offset().left : 0;\n\t\tvar tapY = endPoints[0] ? endPoints[0].y - self.$stage.offset().top : 0;\n\n\t\tvar where;\n\n\t\tvar process = function ( prefix ) {\n\n\t\t\tvar action = current.opts[ prefix ];\n\n\t\t\tif ( $.isFunction( action ) ) {\n\t\t\t\taction = action.apply( instance, [ current, e ] );\n\t\t\t}\n\n\t\t\tif ( ! action) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tswitch ( action ) {\n\n\t\t\t\tcase \"close\" :\n\n\t\t\t\t\tinstance.close( self.startEvent );\n\n\t\t\t\tbreak;\n\n\t\t\t\tcase \"toggleControls\" :\n\n\t\t\t\t\tinstance.toggleControls( true );\n\n\t\t\t\tbreak;\n\n\t\t\t\tcase \"next\" :\n\n\t\t\t\t\tinstance.next();\n\n\t\t\t\tbreak;\n\n\t\t\t\tcase \"nextOrClose\" :\n\n\t\t\t\t\tif ( instance.group.length > 1 ) {\n\t\t\t\t\t\tinstance.next();\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\tinstance.close( self.startEvent );\n\t\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\t\tcase \"zoom\" :\n\n\t\t\t\t\tif ( current.type == 'image' && ( current.isLoaded || current.$ghost ) ) {\n\n\t\t\t\t\t\tif ( instance.canPan() ) {\n\t\t\t\t\t\t\tinstance.scaleToFit();\n\n\t\t\t\t\t\t} else if ( instance.isScaledDown() ) {\n\t\t\t\t\t\t\tinstance.scaleToActual( tapX, tapY );\n\n\t\t\t\t\t\t} else if ( instance.group.length < 2 ) {\n\t\t\t\t\t\t\tinstance.close( self.startEvent );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t};\n\n\t\t// Ignore right click\n\t\tif ( e.originalEvent && e.originalEvent.button == 2 ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Skip if current slide is not in the center\n\t\tif ( instance.isSliding ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Skip if clicked on the scrollbar\n\t\tif ( tapX > $target[0].clientWidth + $target.offset().left ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Check where is clicked\n\t\tif ( $target.is( '.envirabox-bg,.envirabox-inner,.envirabox-outer,.envirabox-container' ) ) {\n\t\t\twhere = 'Outside';\n\n\t\t} else if ( $target.is( '.envirabox-slide' ) ) {\n\t\t\twhere = 'Slide';\n\n\t\t} else if ( instance.current.$content && instance.current.$content.has( e.target ).length ) {\n\t\t\twhere = 'Content';\n\n\t\t} else {\n\t\t\treturn;\n\t\t}\n\n\t\t// Check if this is a double tap\n\t\tif ( self.tapped ) {\n\n\t\t\t// Stop previously created single tap\n\t\t\tclearTimeout( self.tapped );\n\t\t\tself.tapped = null;\n\n\t\t\t// Skip if distance between taps is too big\n\t\t\tif ( Math.abs( tapX - self.tapX ) > 50 || Math.abs( tapY - self.tapY ) > 50 || instance.isSliding ) {\n\t\t\t\treturn this;\n\t\t\t}\n\n\t\t\t// OK, now we assume that this is a double-tap\n\t\t\tprocess( 'dblclick' + where );\n\n\t\t} else {\n\n\t\t\t// Single tap will be processed if user has not clicked second time within 300ms\n\t\t\t// or there is no need to wait for double-tap\n\t\t\tself.tapX = tapX;\n\t\t\tself.tapY = tapY;\n\n\t\t\tif ( current.opts[ 'dblclick' + where ] && current.opts[ 'dblclick' + where ] !== current.opts[ 'click' + where ] ) {\n\t\t\t\tself.tapped = setTimeout(\n\t\t\t\t\tfunction() {\n\t\t\t\t\t\tself.tapped = null;\n\n\t\t\t\t\t\tprocess( 'click' + where );\n\n\t\t\t\t\t},\n\t\t\t\t\t300\n\t\t\t\t);\n\n\t\t\t} else {\n\t\t\t\tprocess( 'click' + where );\n\t\t\t}\n\n\t\t}\n\n\t\treturn this;\n\t};\n\n\t$( document ).on(\n\t\t'onActivate.eb',\n\t\tfunction (e, instance) {\n\t\t\tif ( instance && ! instance.Guestures ) {\n\t\t\t\tinstance.Guestures = new Guestures( instance );\n\t\t\t}\n\t\t}\n\t);\n\n\t$( document ).on(\n\t\t'beforeClose.eb',\n\t\tfunction (e, instance) {\n\t\t\tif ( instance && instance.Guestures ) {\n\t\t\t\tinstance.Guestures.destroy();\n\t\t\t}\n\t\t}\n\t);\n\n}( window, document, window.jQuery || jQuery ));\n",";// ==========================================================================\n//\n// Media\n// Adds additional media type support\n//\n// ==========================================================================\n(function ($) {\n\n\t'use strict';\n\n\t// Formats matching url to final form\n\tvar format = function (url, rez, params) {\n\t\tif ( ! url ) {\n\t\t\treturn;\n\t\t}\n\n\t\tparams = params || '';\n\n\t\tif ( $.type( params ) === \"object\" ) {\n\t\t\tparams = $.param( params, true );\n\t\t}\n\n\t\t$.each(\n\t\t\trez,\n\t\t\tfunction (key, value) {\n\t\t\t\turl = url.replace( '$' + key, value || '' );\n\t\t\t}\n\t\t);\n\n\t\tif (params.length) {\n\t\t\turl += (url.indexOf( '?' ) > 0 ? '&' : '?') + params;\n\t\t}\n\n\t\treturn url;\n\t};\n\n\t// Object containing properties for each media type\n\tvar defaults = {\n\t\tyoutube_playlist : {\n\t\t\tmatcher : /^http:\\/\\/(?:www\\.)?youtube\\.com\\/watch\\?((v=[^&\\s]*&list=[^&\\s]*)|(list=[^&\\s]*&v=[^&\\s]*))(&[^&\\s]*)*$/,\n\t\t\tparams  : {\n\t\t\t\tautoplay : 1,\n\t\t\t\tautohide : 1,\n\t\t\t\tfs  : 1,\n\t\t\t\trel : 0,\n\t\t\t\thd  : 1,\n\t\t\t\twmode : 'transparent',\n\t\t\t\tenablejsapi : 1,\n\t\t\t\thtml5 : 1\n\t\t\t},\n\t\t\tparamPlace : 8,\n\t\t\ttype  : 'iframe',\n\t\t\turl   : '//www.youtube.com/embed/videoseries?list=$4',\n\t\t\tthumb : '//img.youtube.com/vi/$4/hqdefault.jpg'\n\t\t},\n\n\t\tyoutube : {\n\t\t\tmatcher : /(youtube\\.com|youtu\\.be|youtube\\-nocookie\\.com)\\/(watch\\?(.*&)?v=|v\\/|u\\/|embed\\/?)?(videoseries\\?list=(.*)|[\\w-]{11}|\\?listType=(.*)&list=(.*))(.*)/i,\n\t\t\tparams  : {\n\t\t\t\tautoplay : 1,\n\t\t\t\tautohide : 1,\n\t\t\t\tfs  : 1,\n\t\t\t\trel : 0,\n\t\t\t\thd  : 1,\n\t\t\t\twmode : 'transparent',\n\t\t\t\tenablejsapi : 1,\n\t\t\t\thtml5 : 1\n\t\t\t},\n\t\t\tparamPlace : 8,\n\t\t\ttype  : 'iframe',\n\t\t\turl   : '//www.youtube.com/embed/$4',\n\t\t\tthumb : '//img.youtube.com/vi/$4/hqdefault.jpg'\n\t\t},\n\n\t\tvimeo : {\n\t\t\tmatcher : /^.+vimeo.com\\/(.*\\/)?([\\d]+)(.*)?/,\n\t\t\tparams  : {\n\t\t\t\tautoplay : 1,\n\t\t\t\thd : 1,\n\t\t\t\tshow_title    : 1,\n\t\t\t\tshow_byline   : 1,\n\t\t\t\tshow_portrait : 0,\n\t\t\t\tfullscreen    : 1,\n\t\t\t\tapi : 1\n\t\t\t},\n\t\t\tparamPlace : 3,\n\t\t\ttype : 'iframe',\n\t\t\turl : '//player.vimeo.com/video/$2'\n\t\t},\n\n\t\tmetacafe : {\n\t\t\tmatcher : /metacafe.com\\/watch\\/(\\d+)\\/(.*)?/,\n\t\t\ttype    : 'iframe',\n\t\t\turl     : '//www.metacafe.com/embed/$1/?ap=1'\n\t\t},\n\n\t\tdailymotion : {\n\t\t\tmatcher : /dailymotion.com\\/video\\/(.*)\\/?(.*)/,\n\t\t\tparams : {\n\t\t\t\tadditionalInfos : 0,\n\t\t\t\tautoStart : 1\n\t\t\t},\n\t\t\ttype : 'iframe',\n\t\t\turl  : '//www.dailymotion.com/embed/video/$1'\n\t\t},\n\n\t\tfacebook : {\n\t\t\tmatcher : /facebook.com\\/facebook\\/videos\\/(.*)\\/?(.*)/,\n\t\t\ttype : 'genericDiv',\n\t\t\tsubtype: 'facebook',\n\t\t\turl  : '//www.facebook.com/facebook/videos/$1'\n\t\t},\n\n\t\tinstagram : {\n\t\t\tmatcher : /(instagr\\.am|instagram\\.com)\\/p\\/([a-zA-Z0-9_\\-]+)\\/?/i,\n\t\t\ttype    : 'image',\n\t\t\turl     : '//$1/p/$2/media/?size=l'\n\t\t},\n\n\t\tinstagram_tv : {\n\t\t\tmatcher : /(instagr\\.am|instagram\\.com)\\/tv\\/([a-zA-Z0-9_\\-]+)\\/?/i,\n\t\t\ttype    : 'iframe',\n\t\t\turl     : '//$1/p/$2/media/?size=l'\n\t\t},\n\n\t\twistia : {\n\t\t\tmatcher : /wistia.com\\/medias\\/(.*)\\/?(.*)/,\n\t\t\ttype    : 'iframe',\n\t\t\turl     : '//fast.wistia.net/embed/iframe/$1'\n\t\t},\n\n\t\t// Example: //player.twitch.tv/?video=270862436ß\n\t\ttwitch : {\n\t\t\tmatcher : /player.twitch.tv\\/[\\\\?&]video=([^&#]*)/,\n\t\t\ttype : 'iframe',\n\t\t\turl  : '//player.twitch.tv/?video=$1'\n\t\t},\n\n\t\t// Example: //videopress.com/v/DK5mLrbr    ?at=1374&loop=1&autoplay=1\n\t\tvideopress : {\n\t\t\tmatcher : /videopress.com\\/v\\/(.*)\\/?(.*)/,\n\t\t\ttype : 'iframe',\n\t\t\turl  : '//videopress.com/embed/$1'\n\t\t},\n\n\t\t// Examples:\n\t\t// http://maps.google.com/?ll=48.857995,2.294297&spn=0.007666,0.021136&t=m&z=16\n\t\t// https://www.google.com/maps/@37.7852006,-122.4146355,14.65z\n\t\t// https://www.google.com/maps/place/Googleplex/@37.4220041,-122.0833494,17z/data=!4m5!3m4!1s0x0:0x6c296c66619367e0!8m2!3d37.4219998!4d-122.0840572\n\t\tgmap_place : {\n\t\t\tmatcher : /(maps\\.)?google\\.([a-z]{2,3}(\\.[a-z]{2})?)\\/(((maps\\/(place\\/(.*)\\/)?\\@(.*),(\\d+.?\\d+?)z))|(\\?ll=))(.*)?/i,\n\t\t\ttype    : 'iframe',\n\t\t\turl     : function (rez) {\n\t\t\t\treturn '//maps.google.' + rez[2] + '/?ll=' + ( rez[9] ? rez[9] + '&z=' + Math.floor( rez[10] ) + ( rez[12] ? rez[12].replace( /^\\//, \"&\" ) : '' ) : rez[12] ) + '&output=' + ( rez[12] && rez[12].indexOf( 'layer=c' ) > 0 ? 'svembed' : 'embed' );\n\t\t\t}\n\t\t},\n\n\t\t// Examples:\n\t\t// https://www.google.com/maps/search/Empire+State+Building/\n\t\t// https://www.google.com/maps/search/?api=1&query=centurylink+field\n\t\t// https://www.google.com/maps/search/?api=1&query=47.5951518,-122.3316393\n\t\tgmap_search : {\n\t\t\tmatcher : /(maps\\.)?google\\.([a-z]{2,3}(\\.[a-z]{2})?)\\/(maps\\/search\\/)(.*)/i,\n\t\t\ttype    : 'iframe',\n\t\t\turl     : function (rez) {\n\t\t\t\treturn '//maps.google.' + rez[2] + '/maps?q=' + rez[5].replace( 'query=', 'q=' ).replace( 'api=1', '' ) + '&output=embed';\n\t\t\t}\n\t\t}\n\t};\n\n\t$( document ).on(\n\t\t'onInit.eb',\n\t\tfunction (e, instance) {\n\n\t\t\t$.each(\n\t\t\t\tinstance.group,\n\t\t\t\tfunction( i, item ) {\n\n\t\t\t\t\t// console.log('!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!');\n\t\t\t\t\t// console.log(item.src);\n\t\t\t\t\t// console.log(item);\n\t\t\t\t\tvar url_to_check = item.src || '',\n\t\t\t\t\ttype             = false,\n\t\t\t\t\tsubtype          = false,\n\t\t\t\t\turl              = false,\n\t\t\t\t\tmedia,\n\t\t\t\t\tthumb,\n\t\t\t\t\trez,\n\t\t\t\t\tparams,\n\t\t\t\t\turlParams,\n\t\t\t\t\to,\n\t\t\t\t\tprovider         = false;\n\n\t\t\t\t\t// Skip items that already have content type\n\t\t\t\t\tif ( item.type ) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tmedia = $.extend( true, {}, defaults, item.opts.media );\n\n\t\t\t\t\t// Look for any matching media type\n\t\t\t\t\t$.each(\n\t\t\t\t\t\tmedia,\n\t\t\t\t\t\tfunction ( n, el ) {\n\t\t\t\t\t\t\t// console.log( 'provider: ' + n + ' - matcher: ' + el.matcher + ' - url: ' + url_to_check + ' - url: ' + url );\n\t\t\t\t\t\t\trez = url_to_check.match( el.matcher );\n\t\t\t\t\t\t\to   = {};\n\n\t\t\t\t\t\t\tif ( ! rez) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tprovider = n;\n\n\t\t\t\t\t\t\t// console.log ('MATCHED!!!!!!! url_to_check ' + url_to_check );\n\t\t\t\t\t\t\t// console.log ('MATCHED!!!!!!! provider ' + ' ' + provider);\n\t\t\t\t\t\t\t// console.log ('MATCHED!!!!!!! rez ' + ' ' + rez);\n\t\t\t\t\t\t\t// console.log ('MATCHED!!!!!!! el.url ' + ' ' + el.url);\n\t\t\t\t\t\t\ttype = el.type;\n\t\t\t\t\t\t\tif ( el.subtype !== undefined ) {\n\t\t\t\t\t\t\t\tsubtype = el.subtype;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif ( el.paramPlace && rez[ el.paramPlace ] ) {\n\t\t\t\t\t\t\t\turlParams = rez[ el.paramPlace ];\n\n\t\t\t\t\t\t\t\tif ( urlParams[ 0 ] == '?' ) {\n\t\t\t\t\t\t\t\t\turlParams = urlParams.substring( 1 );\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\turlParams = urlParams.split( '&' );\n\n\t\t\t\t\t\t\t\tfor ( var m = 0; m < urlParams.length; ++m ) {\n\t\t\t\t\t\t\t\t\tvar p = urlParams[ m ].split( '=', 2 );\n\n\t\t\t\t\t\t\t\t\tif ( p.length == 2 ) {\n\t\t\t\t\t\t\t\t\t\to[ p[0] ] = decodeURIComponent( p[1].replace( /\\+/g, \" \" ) );\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tparams = $.extend( true, {}, el.params, item.opts[ n ], o );\n\n\t\t\t\t\t\t\turl   = $.type( el.url ) === \"function\" ? el.url.call( this, rez, params, item ) : format( el.url, rez, params );\n\t\t\t\t\t\t\tthumb = $.type( el.thumb ) === \"function\" ? el.thumb.call( this, rez, params, item ) : format( el.thumb, rez );\n\n\t\t\t\t\t\t\tif ( provider === 'vimeo' ) {\n\t\t\t\t\t\t\t\turl = url.replace( '&%23', '#' );\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\n\t\t\t\t\tif ( type ) {\n\t\t\t\t\t\t// console.log ('MATCHED URL!!!!!!! ' + url);\n\t\t\t\t\t\titem.src     = url;\n\t\t\t\t\t\titem.type    = type;\n\t\t\t\t\t\titem.subtype = subtype;\n\n\t\t\t\t\t\tif ( ! item.opts.thumb && ! ( item.opts.$thumb && item.opts.$thumb.length ) ) {\n\t\t\t\t\t\t\titem.opts.thumb = thumb;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( type === 'iframe' ) {\n\t\t\t\t\t\t\t$.extend(\n\t\t\t\t\t\t\t\ttrue,\n\t\t\t\t\t\t\t\titem.opts,\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tiframe : {\n\t\t\t\t\t\t\t\t\t\tpreload : false,\n\t\t\t\t\t\t\t\t\t\tprovider: provider,\n\t\t\t\t\t\t\t\t\t\tattr : {\n\t\t\t\t\t\t\t\t\t\t\tscrolling : \"no\"\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\titem.contentProvider = provider;\n\n\t\t\t\t\t\t\titem.opts.slideClass += ' envirabox-slide--' + ( provider == 'gmap_place' || provider == 'gmap_search' ? 'map' : 'video' );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t// If no content type is found, then set it to `image` as fallback\n\t\t\t\t\t\titem.type = 'image';\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t);\n\n\t\t}\n\t);\n\n}(window.jQuery));\n",";// ==========================================================================\n//\n// SlideShow\n// Enables slideshow functionality\n//\n// Example of usage:\n// $.envirabox.getInstance().SlideShow.start()\n//\n// ==========================================================================\n(function (document, $) {\n\t'use strict';\n\n\tvar SlideShow = function( instance ) {\n\t\tthis.instance = instance;\n\t\tthis.init();\n\t};\n\n\t$.extend(\n\t\tSlideShow.prototype,\n\t\t{\n\t\t\ttimer    : null,\n\t\t\tisActive : false,\n\t\t\t$button  : null,\n\t\t\tspeed    : 3000,\n\n\t\t\tinit : function() {\n\t\t\t\tvar self = this;\n\n\t\t\t\tself.$button = $( '[data-envirabox-play]' ).on(\n\t\t\t\t\t'click',\n\t\t\t\t\tfunction( e ) {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tself.toggle();\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\tif ( self.instance.group.length < 2 || ! self.instance.group[ self.instance.currIndex ].opts.slideShow ) {\n\t\t\t\t\tself.$button.hide();\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tset : function() {\n\t\t\t\tvar self = this;\n\n\t\t\t\t// Check if reached last element\n\t\t\t\tif ( self.instance && self.instance.current && (self.instance.current.opts.loop || self.instance.currIndex < self.instance.group.length - 1 )) {\n\t\t\t\t\tself.timer = setTimeout(\n\t\t\t\t\t\tfunction() {\n\t\t\t\t\t\t\tif ( self.isActive == true ) {\n\t\t\t\t\t\t\t\tself.instance.next();\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t},\n\t\t\t\t\t\tself.instance.current.opts.slideShow.speed || self.speed\n\t\t\t\t\t);\n\n\t\t\t\t} else {\n\t\t\t\t\tself.stop();\n\t\t\t\t\tself.instance.idleSecondsCounter = 0;\n\t\t\t\t\tself.instance.showControls();\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\tclear : function() {\n\t\t\t\tvar self = this;\n\n\t\t\t\tclearTimeout( self.timer );\n\n\t\t\t\tself.timer = null;\n\t\t\t},\n\n\t\t\tstart : function() {\n\t\t\t\tvar self    = this;\n\t\t\t\tvar current = self.instance.current;\n\n\t\t\t\tif ( self.instance && current && ( current.opts.loop || current.index < self.instance.group.length - 1 )) {\n\n\t\t\t\t\tself.isActive = true;\n\n\t\t\t\t\tself.$button\n\t\t\t\t\t.attr( 'title', current.opts.i18n[ current.opts.lang ].PLAY_STOP )\n\t\t\t\t\t.addClass( 'envirabox-button--pause' );\n\t\t\t\t\tself.$button.parent().addClass( 'envirabox-button--pause' );\n\t\t\t\t\tif ( current.isComplete ) {\n\t\t\t\t\t\tself.set();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tstop : function() {\n\t\t\t\tvar self    = this;\n\t\t\t\tvar current = self.instance.current;\n\n\t\t\t\tself.clear();\n\n\t\t\t\tself.$button\n\t\t\t\t.attr( 'title', current.opts.i18n[ current.opts.lang ].PLAY_START )\n\t\t\t\t.removeClass( 'envirabox-button--pause' );\n\t\t\t\tself.$button.parent().removeClass( 'envirabox-button--pause' );\n\n\t\t\t\tself.isActive = false;\n\t\t\t},\n\n\t\t\ttoggle : function() {\n\t\t\t\tvar self = this;\n\n\t\t\t\tif ( self.isActive ) {\n\t\t\t\t\tself.stop();\n\n\t\t\t\t} else {\n\t\t\t\t\tself.start();\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\t);\n\n\t$( document ).on(\n\t\t{\n\t\t\t'onInit.eb' : function(e, instance) {\n\t\t\t\tif ( instance && ! instance.SlideShow ) {\n\t\t\t\t\tinstance.SlideShow = new SlideShow( instance );\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t'beforeShow.eb' : function(e, instance, current, firstRun) {\n\t\t\t\tvar SlideShow = instance && instance.SlideShow;\n\n\t\t\t\tif ( firstRun ) {\n\n\t\t\t\t\tif ( SlideShow && current.opts.slideShow.autoStart ) {\n\t\t\t\t\t\tSlideShow.start();\n\t\t\t\t\t}\n\n\t\t\t\t} else if ( SlideShow && SlideShow.isActive ) {\n\t\t\t\t\tSlideShow.clear();\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t'afterShow.eb' : function(e, instance, current) {\n\t\t\t\tvar SlideShow = instance && instance.SlideShow;\n\n\t\t\t\tif ( SlideShow && SlideShow.isActive ) {\n\t\t\t\t\tSlideShow.set();\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t'afterKeydown.eb' : function(e, instance, current, keypress, keycode) {\n\t\t\t\tvar SlideShow = instance && instance.SlideShow;\n\n\t\t\t\t// \"P\" or Spacebar\n\t\t\t\tif ( SlideShow && current.opts.slideShow && ( keycode === 80 || keycode === 32 ) && ! $( document.activeElement ).is( 'button,a,input' ) ) {\n\t\t\t\t\tkeypress.preventDefault();\n\n\t\t\t\t\tSlideShow.toggle();\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t'beforeClose.eb onDeactivate.eb' : function(e, instance) {\n\t\t\t\tvar SlideShow = instance && instance.SlideShow;\n\n\t\t\t\tif ( SlideShow ) {\n\t\t\t\t\tSlideShow.stop();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t);\n\n\t// Page Visibility API to pause slideshow when window is not active\n\t$( document ).on(\n\t\t\"visibilitychange\",\n\t\tfunction() {\n\t\t\tvar instance  = $.envirabox.getInstance();\n\t\t\tvar SlideShow = instance && instance.SlideShow;\n\n\t\t\tif ( SlideShow && SlideShow.isActive ) {\n\t\t\t\tif ( document.hidden ) {\n\t\t\t\t\tSlideShow.clear();\n\n\t\t\t\t} else {\n\t\t\t\t\tSlideShow.set();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t);\n\n}(document, window.jQuery));\n",";// ==========================================================================\n//\n// Thumbs\n// Displays thumbnails in a grid\n//\n// ==========================================================================\n(function (document, $) {\n\t'use strict';\n\n\tvar FancyThumbs = function( instance ) {\n\t\tthis.instance = instance;\n\t\tthis.init();\n\t};\n\n\t$.extend(\n\t\tFancyThumbs.prototype,\n\t\t{\n\n\t\t\t$button     : null,\n\t\t\t$grid       : null,\n\t\t\t$list       : null,\n\t\t\tisVisible   : false,\n\n\t\t\tinit : function() {\n\t\t\t\tvar self = this,\n\t\t\t\thandled  = false;\n\n\t\t\t\tvar first = self.instance.group[0],\n\t\t\t\tsecond    = self.instance.group[1];\n\n\t\t\t\tself.$button = self.instance.$refs.toolbar.find( '[data-envirabox-thumbs]' );\n\n\t\t\t\tif ( self.instance.group.length > 1 && self.instance.group[ self.instance.currIndex ].opts.thumbs && (\n\t\t\t\t\t( first.type == 'image' || first.opts.thumb || first.opts.$thumb ) &&\n\t\t\t\t\t( second.type == 'image' || second.opts.thumb || second.opts.$thumb )\n\t\t\t\t)) {\n\n\t\t\t\t\tself.$button.on(\n\t\t\t\t\t\t'touchstart click',\n\t\t\t\t\t\tfunction(e) {\n\t\t\t\t\t\t\te.stopImmediatePropagation();\n\n\t\t\t\t\t\t\tif (e.type == \"touchend\") {\n\t\t\t\t\t\t\t\thandled = true;\n\t\t\t\t\t\t\t\tself.toggle();\n\t\t\t\t\t\t\t} else if (e.type == \"click\" && ! handled) {\n\t\t\t\t\t\t\t\tself.toggle();\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\thandled = false;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\n\t\t\t\t\tself.isActive = true;\n\n\t\t\t\t} else {\n\t\t\t\t\tself.$button.hide();\n\n\t\t\t\t\tself.isActive = false;\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\tcreate : function() {\n\t\t\t\tvar instance = this.instance,\n\t\t\t\tlist,\n\t\t\t\tsrc,\n\t\t\t\t$the_height,\n\t\t\t\tthumbnail_play_icon,\n\t\t\t\t$row;\n\n\t\t\t\tthis.$grid    = $( '<div class=\"envirabox-thumbs envirabox-thumbs-' + instance.opts.thumbs.position + '\"></div>' ).appendTo( instance.$refs.container );\n\t\t\t\t$row          = instance.opts.thumbs.rowHeight === 'auto' ? 50 : instance.opts.thumbs.rowHeight;\n\t\t\t\tvar tmpImg    = new Image();\n\t\t\t\ttmpImg.onload = function(){\n\t\t\t\t\ttmpImg.src = instance.group[0].thumb;\n\n\t\t\t\t\t$the_height = tmpImg.naturalHeight !== 0 ? tmpImg.naturalHeight : $row;\n\t\t\t\t};\n\n\t\t\t\ttmpImg.src = instance.group[0].thumb;\n\n\t\t\t\t$the_height = tmpImg.naturalHeight !== 0 ? tmpImg.naturalHeight : $row;\n\n\t\t\t\tlist = '<ul style=\"height:' + $the_height + 'px\">';\n\n\t\t\t\t$.each(\n\t\t\t\t\tinstance.group,\n\t\t\t\t\tfunction( i, item ) {\n\n\t\t\t\t\t\tsrc                 = item.opts.thumb || ( item.opts.$thumb ? item.opts.$thumb.attr( 'src' ) : null );\n\t\t\t\t\t\tthumbnail_play_icon = item.opts.videoPlayIcon ? item.opts.videoPlayIcon : false;\n\n\t\t\t\t\t\tif ( ! src && item.type === 'image' ) {\n\t\t\t\t\t\t\tsrc = item.src;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( src && src.length ) {\n\t\t\t\t\t\t\tvar contentProvider = item.contentProvider !== undefined ? item.contentProvider : 'none';\n\t\t\t\t\t\t\tlist               += '<li data-index=\"' + i + '\"  tabindex=\"0\" class=\"envirabox-thumbs-loading envirabox-thumb-content-provider-' + contentProvider + ' envirabox-thumb-type-' + item.type + '\"><img class=\"envirabox-thumb-image-' + item.type + ' envirabox-thumb-content-provider-' + contentProvider + '\" data-src=\"' + src + '\" />';\n\t\t\t\t\t\t\tif ( thumbnail_play_icon && ( ( item.type == 'video' || item.type == 'genericDiv' ) || ( contentProvider == 'youtube' || contentProvider == 'vimeo' || contentProvider == 'instagram' || contentProvider == 'twitch' || contentProvider == 'dailymotion' || contentProvider == 'metacafe' || contentProvider == 'wistia' || contentProvider == 'videopress' ) ) ) {\n\t\t\t\t\t\t\t\tlist += '<div class=\"envira-video-play-icon\">Play</div>';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tlist += '</li>';\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\tlist += '</ul>';\n\n\t\t\t\tthis.$list = $( list ).appendTo( this.$grid ).on(\n\t\t\t\t\t'click touchstart',\n\t\t\t\t\t'li',\n\t\t\t\t\tfunction() {\n\t\t\t\t\t\tinstance.jumpTo( $( this ).data( 'index' ) );\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\tthis.$list.find( 'img' ).hide().one(\n\t\t\t\t\t'load',\n\t\t\t\t\tfunction() {\n\n\t\t\t\t\t\tvar $parent = $( this ).parent().removeClass( 'envirabox-thumbs-loading' ),\n\t\t\t\t\t\tthumbWidth  = $( this ).outerWidth(),\n\t\t\t\t\t\tthumbHeight = $( this ).outerHeight(),\n\t\t\t\t\t\twidth,\n\t\t\t\t\t\theight,\n\t\t\t\t\t\twidthRatio,\n\t\t\t\t\t\theightRatio;\n\n\t\t\t\t\t\twidth  = this.naturalWidth || this.width;\n\t\t\t\t\t\theight = this.naturalHeight || this.height;\n\n\t\t\t\t\t\t// Calculate thumbnail width/height and center it\n\t\t\t\t\t\twidthRatio  = width / thumbWidth;\n\t\t\t\t\t\theightRatio = height / thumbHeight;\n\n\t\t\t\t\t\tif ( widthRatio >= 1 && heightRatio >= 1 ) {\n\t\t\t\t\t\t\tif (widthRatio > heightRatio) {\n\t\t\t\t\t\t\t\twidth  = width / heightRatio;\n\t\t\t\t\t\t\t\theight = thumbHeight;\n\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\twidth  = thumbWidth;\n\t\t\t\t\t\t\t\theight = height / widthRatio;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t$( this ).css(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\twidth         : \"auto\",\n\t\t\t\t\t\t\t\theight        : Math.floor( $row ),\n\t\t\t\t\t\t\t\t'margin-top'  : Math.min( 0, Math.floor( thumbHeight * 0.3 - height * 0.3 ) ),\n\t\t\t\t\t\t\t\t'margin-left' : Math.min( 0, Math.floor( thumbWidth * 0.5 - width * 0.5 ) )\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t).show();\n\n\t\t\t\t\t}\n\t\t\t\t)\n\n\t\t\t\t.each(\n\t\t\t\t\tfunction() {\n\t\t\t\t\t\tthis.src = $( this ).data( 'src' );\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t},\n\n\t\t\tfocus : function() {\n\n\t\t\t\tif ( this.instance.current ) {\n\t\t\t\t\tthis.$list\n\t\t\t\t\t.children()\n\t\t\t\t\t.removeClass( 'envirabox-thumbs-active' )\n\t\t\t\t\t.filter( '[data-index=\"' + this.instance.current.index + '\"]' )\n\t\t\t\t\t.addClass( 'envirabox-thumbs-active' )\n\t\t\t\t\t.focus();\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\tclose : function() {\n\t\t\t\tthis.$grid.hide();\n\t\t\t},\n\n\t\t\tupdate : function() {\n\n\t\t\t\tthis.instance.$refs.container.toggleClass( 'envirabox-show-thumbs', this.isVisible );\n\n\t\t\t\tif ( this.isVisible ) {\n\n\t\t\t\t\tif ( ! this.$grid ) {\n\t\t\t\t\t\tthis.create();\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.instance.trigger( 'onThumbsShow' );\n\n\t\t\t\t\tthis.focus();\n\n\t\t\t\t} else if ( this.$grid ) {\n\t\t\t\t\tthis.instance.trigger( 'onThumbsHide' );\n\t\t\t\t}\n\n\t\t\t\t// Update content position\n\t\t\t\tthis.instance.update();\n\n\t\t\t},\n\n\t\t\thide : function() {\n\t\t\t\tthis.isVisible = false;\n\t\t\t\tthis.update();\n\t\t\t},\n\n\t\t\tshow : function() {\n\t\t\t\tthis.isVisible = true;\n\t\t\t\tthis.update();\n\t\t\t},\n\n\t\t\ttoggle : function() {\n\t\t\t\tthis.isVisible = ! this.isVisible;\n\t\t\t\tthis.update();\n\t\t\t}\n\n\t\t}\n\t);\n\n\t$( document ).on(\n\t\t{\n\n\t\t\t'onInit.eb' : function(e, instance) {\n\t\t\t\tif ( instance && ! instance.Thumbs ) {\n\t\t\t\t\tinstance.Thumbs = new FancyThumbs( instance );\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t'beforeShow.eb' : function(e, instance, item, firstRun) {\n\t\t\t\tvar Thumbs = instance && instance.Thumbs;\n\n\t\t\t\tif ( ! Thumbs || ! Thumbs.isActive ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif ( item.modal ) {\n\t\t\t\t\tThumbs.$button.hide();\n\n\t\t\t\t\tThumbs.hide();\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif ( firstRun && item.opts.thumbs.autoStart === true ) {\n\t\t\t\t\tThumbs.show();\n\t\t\t\t}\n\n\t\t\t\tif ( Thumbs.isVisible ) {\n\t\t\t\t\tThumbs.focus();\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t'afterKeydown.eb' : function(e, instance, current, keypress, keycode) {\n\t\t\t\tvar Thumbs = instance && instance.Thumbs;\n\n\t\t\t\t// \"G\"\n\t\t\t\tif ( Thumbs && Thumbs.isActive && keycode === 71 ) {\n\t\t\t\t\tkeypress.preventDefault();\n\n\t\t\t\t\tThumbs.toggle();\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t'beforeClose.eb' : function( e, instance ) {\n\t\t\t\tvar Thumbs = instance && instance.Thumbs;\n\n\t\t\t\tif ( Thumbs && Thumbs.isVisible && instance.opts.thumbs.hideOnClose !== false ) {\n\t\t\t\t\tThumbs.close();\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\t);\n\n}(document, window.jQuery));\n",";(function (document, $) {\n\t'use strict';\n\n\tvar prevTime = new Date().getTime();\n\n\t$( document ).on(\n\t\t{\n\t\t\t'onInit.eb' : function( e, instance, current ) {\n\t\t\t\tinstance.$refs.stage.on(\n\t\t\t\t\t'mousewheel DOMMouseScroll wheel MozMousePixelScroll',\n\t\t\t\t\tfunction(e) {\n\t\t\t\t\t\tvar current = instance.current,\n\t\t\t\t\t\tcurrTime    = new Date().getTime();\n\n\t\t\t\t\t\tif ( instance.group.length < 1 || current.opts.wheel === false || ( current.opts.wheel === 'auto' && current.type !== 'image' ) ) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\te.stopPropagation();\n\n\t\t\t\t\t\tif ( current.$slide.hasClass( 'envirabox-animated' ) ) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\te = e.originalEvent || e;\n\n\t\t\t\t\t\tif ( currTime - prevTime < 250 ) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tprevTime = currTime;\n\n\t\t\t\t\t\tinstance[ ( -e.deltaY || -e.deltaX || e.wheelDelta || -e.detail ) < 0 ? 'next' : 'previous' ]();\n\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t);\n\n}( document, window.jQuery || jQuery ));\n",";(function (window, document, $, undefined) {\n\n\t'use strict';\n\n\twindow.console = window.console || {\n\t\tinfo: function(stuff) {}\n\t};\n\n\t// If there's no jQuery, envirabox can't work\n\t// =========================================\n\tif ( ! $ ) {\n\t\treturn;\n\t}\n\n\t// Check if envirabox is already initialized\n\t// ========================================\n\tif ( $.fn.envirabox ) {\n\n\t\t console.info( 'EnviraBox already initialized' );\n\n\t\treturn;\n\t}\n\n\t// Private default settings\n\t// ========================\n\tvar defaults = {\n\n\t\t// Enable infinite gallery navigation\n\t\tloop : false,\n\n\t\t// Space around image, ignored if zoomed-in or viewport width is smaller than 800px\n\t\tmargin : [44, 0],\n\n\t\t// Horizontal space between slides\n\t\tgutter : 50,\n\n\t\t// Enable keyboard navigation\n\t\tkeyboard : true,\n\n\t\t// Should display navigation arrows at the screen edges\n\t\tarrows : true,\n\n\t\t// Should display infobar (counter and arrows at the top)\n\t\tinfobar : false,\n\n\t\t// Should display toolbar (buttons at the top)\n\t\ttoolbar : true,\n\n\t\t// What buttons should appear in the top right corner.\n\t\t// Buttons will be created using templates from `btnTpl` option\n\t\t// and they will be placed into toolbar (class=\"envirabox-toolbar\"` element)\n\t\tbuttons : [\n\t\t\t'slideShow',\n\t\t\t'fullScreen',\n\t\t\t'thumbs',\n\t\t\t'close',\n\t\t\t// \"zoom\",\n\t\t\t// \"share\",\n\t\t\t// \"slideShow\",\n\t\t\t// \"fullScreen\",\n\t\t\t// \"download\",\n\t\t\t\"thumbs\",\n\t\t\t\"close\"\n\t\t],\n\n\t\t// Detect \"idle\" time in seconds\n\t\tidleTime : 3,\n\n\t\t// Should display buttons at top right corner of the content\n\t\t// If 'auto' - they will be created for content having type 'html', 'inline' or 'ajax'\n\t\t// Use template from `btnTpl.smallBtn` for customization\n\t\tsmallBtn : true,\n\n\t\t// Disable right-click and use simple image protection for images\n\t\tprotect : false,\n\n\t\t// Shortcut to make content \"modal\" - disable keyboard navigtion, hide buttons, etc\n\t\tmodal : false,\n\n\t\timage : {\n\n\t\t\t// Wait for images to load before displaying\n\t\t\t// Requires predefined image dimensions\n\t\t\t// If 'auto' - will zoom in thumbnail if 'width' and 'height' attributes are found\n\t\t\tpreload : \"auto\",\n\n\t\t},\n\n\t\tajax : {\n\n\t\t\t// Object containing settings for ajax request\n\t\t\tsettings : {\n\n\t\t\t\t// This helps to indicate that request comes from the modal\n\t\t\t\t// Feel free to change naming\n\t\t\t\tdata : {\n\t\t\t\t\tenvirabox : true\n\t\t\t\t}\n\t\t\t}\n\n\t\t},\n\n\t\tiframe : {\n\n\t\t\t// Iframe template\n\t\t\ttpl : '<iframe id=\"envirabox-frame{rnd}\" name=\"envirabox-frame{rnd}\" class=\"envirabox-iframe {additionalClasses}\" frameborder=\"0\" vspace=\"0\" hspace=\"0\" webkitAllowFullScreen mozallowfullscreen allowFullScreen allowtransparency=\"true\" src=\"\"></iframe>',\n\n\t\t\t// Preload iframe before displaying it\n\t\t\t// This allows to calculate iframe content width and height\n\t\t\t// (note: Due to \"Same Origin Policy\", you can't get cross domain data).\n\t\t\tpreload : true,\n\n\t\t\t// Custom CSS styling for iframe wrapping element\n\t\t\t// You can use this to set custom iframe dimensions\n\t\t\tcss : {},\n\n\t\t\t// Iframe tag attributes\n\t\t\tattr : {\n\t\t\t\tscrolling : 'auto'\n\t\t\t}\n\n\t\t},\n\n\t\tgenericDiv : {\n\n\t\t\t// Iframe template\n\t\t\ttpl : '<div id=\"envirabox-generic-div{rnd}\" name=\"envirabox-generic-div{rnd}\" class=\"fb-video\"></div>',\n\n\t\t\t// Preload iframe before displaying it\n\t\t\t// This allows to calculate iframe content width and height\n\t\t\t// (note: Due to \"Same Origin Policy\", you can't get cross domain data).\n\t\t\tpreload : true,\n\n\t\t\tprovider: 'facebook',\n\n\t\t\t// Custom CSS styling for iframe wrapping element\n\t\t\t// You can use this to set custom iframe dimensions\n\t\t\tcss : {},\n\n\t\t\t// Iframe tag attributes\n\t\t\tattr : {\n\t\t\t\tscrolling : 'auto'\n\t\t\t}\n\n\t\t},\n\n\t\t// Open/close animation type\n\t\t// Possible values:\n\t\t// false            - disable\n\t\t// \"zoom\"           - zoom images from/to thumbnail\n\t\t// \"fade\"\n\t\t// \"zoom-in-out\"\n\t\t//\n\t\tanimationEffect : \"zoom\",\n\n\t\t// Duration in ms for open/close animation\n\t\tanimationDuration : 366,\n\n\t\t// Should image change opacity while zooming\n\t\t// If opacity is 'auto', then opacity will be changed if image and thumbnail have different aspect ratios\n\t\tzoomOpacity : 'auto',\n\n\t\t// Transition effect between slides\n\t\t//\n\t\t// Possible values:\n\t\t// false            - disable\n\t\t// \"fade'\n\t\t// \"slide'\n\t\t// \"circular'\n\t\t// \"tube'\n\t\t// \"zoom-in-out'\n\t\t// \"rotate'\n\t\t//\n\t\ttransitionEffect : \"fade\",\n\n\t\t// Duration in ms for transition animation\n\t\ttransitionDuration : 366,\n\n\t\t// Custom CSS class for slide element\n\t\tslideClass : 'enviraboxSlide',\n\n\t\t// Custom CSS class for layout\n\t\tbaseClass : 'enviraboxLayout',\n\n\t\t// Base template for layout\n\t\tbaseTpl :\n\t\t\t'<div class=\"envirabox-container\" role=\"dialog\" tabindex=\"-1\">' +\n\t\t\t\t'<div class=\"envirabox-bg\"></div>' +\n\t\t\t\t'<div class=\"envirabox-inner\">' +\n\t\t\t\t\t'<div class=\"envirabox-infobar\">' +\n\t\t\t\t\t\t'<button data-envirabox-prev title=\"{{PREV}}\" class=\"envirabox-button envirabox-button--left\"></button>' +\n\t\t\t\t\t\t'<div class=\"envirabox-infobar__body\">' +\n\t\t\t\t\t\t\t'<span data-envirabox-index></span>&nbsp;/&nbsp;<span data-envirabox-count></span>' +\n\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\t'<button data-envirabox-next title=\"{{NEXT}}\" class=\"envirabox-button envirabox-button--right\"></button>' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t'<div class=\"envirabox-toolbar\">' +\n\t\t\t\t\t\t'{{BUTTONS}}' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t'<div class=\"envirabox-navigation\">' +\n\t\t\t\t\t\t'<button data-envirabox-prev title=\"{{PREV}}\" class=\"envirabox-arrow envirabox-arrow--left\" />' +\n\t\t\t\t\t\t'<button data-envirabox-next title=\"{{NEXT}}\" class=\"envirabox-arrow envirabox-arrow--right\" />' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t'<div class=\"envirabox-stage\"></div>' +\n\t\t\t\t\t'<div class=\"envirabox-caption-wrap\">' +\n\t\t\t\t\t\t'<div class=\"envirabox-title\"></div>' +\n\t\t\t\t\t\t'<div class=\"envirabox-caption\"></div>' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t'</div>' +\n\t\t\t'</div>',\n\n\t\t// Loading indicator template\n\t\tspinnerTpl : '<div class=\"envirabox-loading\"></div>',\n\n\t\t// Error message template\n\t\terrorTpl : '<div class=\"envirabox-error\"><p>{{ERROR}}<p></div>',\n\n\t\tbtnTpl : {\n\t\t\tslideShow  : '<button data-envirabox-play class=\"envirabox-button envirabox-button--play\" title=\"{{PLAY_START}}\"></button>',\n\t\t\tfullScreen : '<button data-envirabox-fullscreen class=\"envirabox-button envirabox-button--fullscreen\" title=\"{{FULL_SCREEN}}\"></button>',\n\t\t\tthumbs     : '<button data-envirabox-thumbs class=\"envirabox-button envirabox-button--thumbs\" title=\"{{THUMBS}}\"></button>',\n\t\t\tclose      : '<button data-envirabox-close class=\"envirabox-button envirabox-button--close\" title=\"{{CLOSE}}\"></button>',\n\t\t\tdownload   : '',\n\t\t\texif       : '',\n\t\t\t// This small close button will be appended to your html/inline/ajax content by default,\n\t\t\t// if \"smallBtn\" option is not set to false\n\t\t\tsmallBtn   : '<button data-envirabox-close class=\"envirabox-close-small\" title=\"{{CLOSE}}\"></button>',\n\t\t\tarrowLeft  : '',\n\t\t\tarrowRight : '',\n\t\t},\n\n\t\t// Container is injected into this element\n\t\tparentEl : 'body',\n\n\t\t// Focus handling\n\t\t// ==============\n\t\t// Try to focus on the first focusable element after opening\n\t\tautoFocus : true,\n\n\t\t// Put focus back to active element after closing\n\t\tbackFocus : true,\n\n\t\t// Do not let user to focus on element outside modal content\n\t\ttrapFocus : true,\n\n\t\t// Module specific options\n\t\t// =======================\n\t\tfullScreen : {\n\t\t\tautoStart : false,\n\t\t},\n\n\t\t// Set `touch: false` to disable dragging/swiping\n\t\ttouch : {\n\t\t\tvertical : true,  // Allow to drag content vertically\n\t\t\tmomentum : true   // Continue movement after releasing mouse/touch when panning\n\t\t},\n\n\t\t// Hash value when initializing manually,\n\t\t// set `false` to disable hash change\n\t\thash : null,\n\n\t\t// Customize or add new media types\n\t\t// Example:\n\t\t/*\n\t\tmedia : {\n\t\t\tyoutube : {\n\t\t\t\tparams : {\n\t\t\t\t\tautoplay : 0\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t*/\n\t\tmedia : {},\n\n\t\tslideShow : {\n\t\t\tautoStart : false,\n\t\t\tspeed     : 4000\n\t\t},\n\n\t\tthumbs : {\n\t\t\tautoStart   : false,   // Display thumbnails on opening\n\t\t\thideOnClose : true,     // Hide thumbnail grid when closing animation starts\n\t\t\tparentEl    : '.envirabox-container',\n\t\t\taxis        : 'y',\n\t\t\trowHeight   : 50,\n\t\t},\n\n\t\twheel        : 'auto',\n\n\t\t// Callbacks\n\t\t// ==========\n\t\tonInit       : $.noop,  // When instance has been initialized\n\n\t\tbeforeLoad   : $.noop,  // Before the content of a slide is being loaded\n\t\tafterLoad    : $.noop,  // When the content of a slide is done loading\n\n\t\tbeforeShow   : $.noop,  // Before open animation starts\n\t\tafterShow    : $.noop,  // When content is done loading and animating\n\n\t\tbeforeClose  : $.noop,  // Before the instance attempts to close. Return false to cancel the close.\n\t\tafterClose   : $.noop,  // After instance has been closed\n\n\t\tonActivate   : $.noop,  // When instance is brought to front\n\t\tonDeactivate : $.noop,  // When other instance has been activated\n\n\t\t// Interaction\n\t\t// ===========\n\t\t// Use options below to customize taken action when user clicks or double clicks on the envirabox area,\n\t\t// each option can be string or method that returns value.\n\t\t//\n\t\t// Possible values:\n\t\t// \"close\"           - close instance\n\t\t// \"next\"            - move to next gallery item\n\t\t// \"nextOrClose\"     - move to next gallery item or close if gallery has only one item\n\t\t// \"toggleControls\"  - show/hide controls\n\t\t// \"zoom\"            - zoom image (if loaded)\n\t\t// false             - do nothing\n\t\t// Clicked on the content\n\t\tclickContent : function( current, event ) {\n\t\t\treturn current.type === 'image' ? 'zoom' : false;\n\t\t},\n\n\t\t// Clicked on the slide\n\t\tclickSlide : 'close',\n\n\t\t// Clicked on the background (backdrop) element\n\t\tclickOutside : 'close',\n\n\t\t// Same as previous two, but for double click\n\t\tdblclickContent : false,\n\t\tdblclickSlide   : false,\n\t\tdblclickOutside : false,\n\n\t\t// Custom options when mobile device is detected\n\t\t// =============================================\n\t\tmobile : {\n\t\t\tclickContent : function( current, event ) {\n\t\t\t\treturn current.type === 'image' ? 'toggleControls' : false;\n\t\t\t},\n\t\t\tclickSlide : function( current, event ) {\n\t\t\t\treturn current.type === 'image' ? 'toggleControls' : 'close';\n\t\t\t},\n\t\t\tdblclickContent : function( current, event ) {\n\t\t\t\treturn current.type === 'image' ? 'zoom' : false;\n\t\t\t},\n\t\t\tdblclickSlide : function( current, event ) {\n\t\t\t\treturn current.type === 'image' ? 'zoom' : false;\n\t\t\t}\n\t\t},\n\n\t\t// Internationalization\n\t\t// ============\n\t\tlang : 'en',\n\t\ti18n : {\n\t\t\t'en' : {\n\t\t\t\tCLOSE       : 'Close',\n\t\t\t\tNEXT        : 'Next',\n\t\t\t\tPREV        : 'Previous',\n\t\t\t\tERROR       : 'The requested content cannot be loaded. <br/> Please try again later.',\n\t\t\t\tPLAY_START  : 'Start slideshow',\n\t\t\t\tPLAY_STOP   : 'Pause slideshow',\n\t\t\t\tFULL_SCREEN : 'Full screen',\n\t\t\t\tTHUMBS      : 'Thumbnails'\n\t\t\t},\n\t\t\t'de' : {\n\t\t\t\tCLOSE       : 'Schliessen',\n\t\t\t\tNEXT        : 'Weiter',\n\t\t\t\tPREV        : 'Zurück',\n\t\t\t\tERROR       : 'Die angeforderten Daten konnten nicht geladen werden. <br/> Bitte versuchen Sie es später nochmal.',\n\t\t\t\tPLAY_START  : 'Diaschau starten',\n\t\t\t\tPLAY_STOP   : 'Diaschau beenden',\n\t\t\t\tFULL_SCREEN : 'Vollbild',\n\t\t\t\tTHUMBS      : 'Vorschaubilder'\n\t\t\t}\n\t\t}\n\n\t};\n\n\t// Few useful variables and methods\n\t// ================================\n\tvar $W     = $( window ),\n\t\t$D     = $( document ),\n\t\tcalled = 0;\n\n\t// Check if an object is a jQuery object and not a native JavaScript object\n\t// ========================================================================\n\tvar isQuery = function ( obj ) {\n\t\treturn obj && obj.hasOwnProperty && obj instanceof $;\n\t};\n\n\t// Handle multiple browsers for \"requestAnimationFrame\" and \"cancelAnimationFrame\"\n\t// ===============================================================================\n\tvar requestAFrame = (function () {\n\t\treturn window.requestAnimationFrame ||\n\t\t\t\twindow.webkitRequestAnimationFrame ||\n\t\t\t\twindow.mozRequestAnimationFrame ||\n\t\t\t\twindow.oRequestAnimationFrame ||\n\t\t\t\t// if all else fails, use setTimeout\n\t\t\t\tfunction (callback) {\n\t\t\t\t\treturn window.setTimeout( callback, 1000 / 60 );\n\t\t\t\t};\n\t})();\n\n\t// Detect the supported transition-end event property name\n\t// =======================================================\n\tvar transitionEnd = (function () {\n\t\tvar t, el = document.createElement( \"fakeelement\" );\n\n\t\tvar transitions = {\n\t\t\t\"transition\"      : \"transitionend\",\n\t\t\t\"OTransition\"     : \"oTransitionEnd\",\n\t\t\t\"MozTransition\"   : \"transitionend\",\n\t\t\t\"WebkitTransition\": \"webkitTransitionEnd\"\n\t\t};\n\n\t\tfor (t in transitions) {\n\t\t\tif (el.style[t] !== undefined) {\n\t\t\t\treturn transitions[t];\n\t\t\t}\n\t\t}\n\t\treturn \"transitionend\";\n\t})();\n\n\t// Force redraw on an element.\n\t// This helps in cases where the browser doesn't redraw an updated element properly.\n\t// =================================================================================\n\tvar forceRedraw = function( $el ) {\n\t\treturn ( $el && $el.length && $el[0].offsetHeight );\n\t};\n\n\t// Exclude array (`buttons`) options from deep merging\n\t// ===================================================\n\tvar mergeOpts = function(opts1, opts2) {\n\t\tvar rez = $.extend( true, {}, opts1, opts2 );\n\t\t$.each(\n\t\t\topts2,\n\t\t\tfunction(key, value) {\n\t\t\t\tif ($.isArray( value )) {\n\t\t\t\t\trez[key] = value;\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t\treturn rez;\n\t};\n\n\t// Class definition\n\t// ================\n\tvar EnviraBox = function( content, opts, index ) {\n\t\tvar self = this;\n\n\t\tself.opts = $.extend( true, { index : index }, defaults, opts || {} );\n\n\t\t// Exclude buttons option from deep merging\n\t\tif ( opts && $.isArray( opts.buttons ) ) {\n\t\t\tself.opts.buttons = opts.buttons;\n\t\t}\n\n\t\tself.id    = self.opts.id || ++called;\n\t\tself.group = [];\n\n\t\tself.currIndex = parseInt( self.opts.index, 10 ) || 0;\n\t\tself.prevIndex = null;\n\n\t\tself.prevPos = null;\n\t\tself.currPos = 0;\n\n\t\tself.firstRun = null;\n\n\t\t// Create group elements from original item collection\n\t\tself.createGroup( content );\n\n\t\tif ( ! self.group.length ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Save last active element and current scroll position\n\t\tself.$lastFocus = $( document.activeElement ).blur();\n\n\t\t// Collection of gallery objects\n\t\tself.slides = {};\n\n\t\tself.init( content );\n\n\t};\n\n\t$.extend(\n\t\tEnviraBox.prototype,\n\t\t{\n\n\t\t\t// Create DOM structure\n\t\t\t// ====================\n\t\t\tinit : function() {\n\t\t\t\tvar self = this;\n\n\t\t\t\tvar testWidth, $container, buttonStr;\n\n\t\t\t\tvar firstItemOpts = self.group[ self.currIndex ].opts;\n\n\t\t\t\tself.scrollTop  = $D.scrollTop();\n\t\t\t\tself.scrollLeft = $D.scrollLeft();\n\n\t\t\t\t// Hide scrollbars\n\t\t\t\t// ===============\n\t\t\t\tif ( ! $.envirabox.getInstance() && ! $.envirabox.isMobile && $( 'body' ).css( 'overflow' ) !== 'hidden' ) {\n\t\t\t\t\ttestWidth = $( 'body' ).width();\n\n\t\t\t\t\t$( 'html' ).addClass( 'envirabox-enabled' );\n\n\t\t\t\t\t// Compare body width after applying \"overflow: hidden\"\n\t\t\t\t\ttestWidth = $( 'body' ).width() - testWidth;\n\n\t\t\t\t\t// If width has changed - compensate missing scrollbars by adding right margin\n\t\t\t\t\tif ( testWidth > 1 ) {\n\t\t\t\t\t\t$( 'head' ).append( '<style id=\"envirabox-style-noscroll\" type=\"text/css\">.compensate-for-scrollbar, .envirabox-enabled body { margin-right: ' + testWidth + 'px; }</style>' );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Build html markup and set references\n\t\t\t\t// ====================================\n\t\t\t\t// Build html code for buttons and insert into main template\n\t\t\t\tbuttonStr = '';\n\n\t\t\t\t$.each(\n\t\t\t\t\tfirstItemOpts.buttons,\n\t\t\t\t\tfunction( index, value ) {\n\t\t\t\t\t\tbuttonStr += ( firstItemOpts.btnTpl[ value ] || '' );\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\t// Create markup from base template, it will be initially hidden to\n\t\t\t\t// avoid unnecessary work like painting while initializing is not complete\n\t\t\t\t$container = $( self.translate( self, firstItemOpts.baseTpl.replace( '\\{\\{BUTTONS\\}\\}', buttonStr ) ) )\n\t\t\t\t.addClass( 'envirabox-is-hidden' )\n\t\t\t\t.attr( 'id', 'envirabox-container-' + self.id )\n\t\t\t\t.addClass( firstItemOpts.baseClass )\n\t\t\t\t.data( 'EnviraBox', self )\n\t\t\t\t.prependTo( firstItemOpts.parentEl );\n\n\t\t\t\t// Create object holding references to jQuery wrapped nodes\n\t\t\t\tself.$refs = {\n\t\t\t\t\tcontainer : $container\n\t\t\t\t};\n\n\t\t\t\t[ 'bg', 'inner', 'infobar', 'toolbar', 'stage', 'caption', 'title' ].forEach(\n\t\t\t\t\tfunction(item) {\n\t\t\t\t\t\tself.$refs[ item ] = $container.find( '.envirabox-' + item );\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\t// Check for redundant elements\n\t\t\t\tif ( ! firstItemOpts.arrows || self.group.length < 2 ) {\n\t\t\t\t\t$container.find( '.envirabox-navigation' ).remove();\n\t\t\t\t}\n\n\t\t\t\tif ( ! firstItemOpts.infobar ) {\n\t\t\t\t\tself.$refs.infobar.remove();\n\t\t\t\t}\n\n\t\t\t\tif ( ! firstItemOpts.toolbar ) {\n\t\t\t\t\tself.$refs.toolbar.remove();\n\t\t\t\t}\n\n\t\t\t\tself.trigger( 'onInit' );\n\n\t\t\t\t// Bring to front and enable events\n\t\t\t\tself.activate();\n\n\t\t\t\t// Build slides, load and reveal content\n\t\t\t\tself.jumpTo( self.currIndex );\n\t\t\t},\n\n\t\t\t// Simple i18n support - replaces object keys found in template\n\t\t\t// with corresponding values\n\t\t\t// ============================================================\n\t\t\ttranslate : function( obj, str ) {\n\t\t\t\tvar arr = obj.opts.i18n[ obj.opts.lang ];\n\n\t\t\t\treturn str.replace(\n\t\t\t\t\t/\\{\\{(\\w+)\\}\\}/g,\n\t\t\t\t\tfunction(match, n) {\n\t\t\t\t\t\tvar value = arr[n];\n\n\t\t\t\t\t\tif ( value === undefined ) {\n\t\t\t\t\t\t\treturn match;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn value;\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t},\n\n\t\t\t// Create array of gallery item objects\n\t\t\t// Check if each object has valid type and content\n\t\t\t// ===============================================\n\t\t\tcreateGroup : function ( content ) {\n\t\t\t\tvar self  = this;\n\t\t\t\tvar items = $.makeArray( content );\n\n\t\t\t\t$.each(\n\t\t\t\t\titems,\n\t\t\t\t\tfunction( i, item ) {\n\t\t\t\t\t\tvar obj = {},\n\t\t\t\t\t\topts    = {},\n\t\t\t\t\t\tdata    = [],\n\t\t\t\t\t\t$item,\n\t\t\t\t\t\ttype,\n\t\t\t\t\t\tsrc,\n\t\t\t\t\t\tfound,\n\t\t\t\t\t\tsrcParts;\n\n\t\t\t\t\t\t// Step 1 - Make sure we have an object\n\t\t\t\t\t\t// ====================================\n\t\t\t\t\t\tif ( $.isPlainObject( item ) ) {\n\n\t\t\t\t\t\t\t// We probably have manual usage here, something like\n\t\t\t\t\t\t\t// $.envirabox.open( [ { src : \"image.jpg\", type : \"image\" } ] )\n\t\t\t\t\t\t\tobj  = item;\n\t\t\t\t\t\t\topts = item.opts || item;\n\n\t\t\t\t\t\t} else if ( $.type( item ) === 'object' && $( item ).length ) {\n\n\t\t\t\t\t\t\t// Here we propbably have jQuery collection returned by some selector\n\t\t\t\t\t\t\t$item = $( item );\n\t\t\t\t\t\t\tdata  = $item.data();\n\t\t\t\t\t\t\topts  = 'options' in data ? data.options : {};\n\t\t\t\t\t\t\topts  = $.type( opts ) === 'object' ? opts : {};\n\n\t\t\t\t\t\t\tobj.src = 'src' in data ? data.src : ( opts.src || $item.attr( 'href' ) );\n\n\t\t\t\t\t\t\t// Make sure our Obj has all of our keys\n\t\t\t\t\t\t\tfor (var key in data) {\n\n\t\t\t\t\t\t\t\tif (data.hasOwnProperty( key )) {\n\t\t\t\t\t\t\t\t\tobj[key] = data[key];\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t[ 'width', 'height', 'thumb', 'type', 'filter' ].forEach(\n\t\t\t\t\t\t\t\tfunction(item) {\n\t\t\t\t\t\t\t\t\tif ( item in data ) {\n\t\t\t\t\t\t\t\t\t\topts[ item ] = data[ item ];\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tif ( 'srcset' in data ) {\n\t\t\t\t\t\t\t\topts.image = { srcset : data.srcset };\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\topts.$orig = $item;\n\n\t\t\t\t\t\t\tif ( ! obj.type && ! obj.src ) {\n\t\t\t\t\t\t\t\tobj.type = 'inline';\n\t\t\t\t\t\t\t\tobj.src  = item;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t// Assume we have a simple html code, for example:\n\t\t\t\t\t\t\t// $.envirabox.open( '<div><h1>Hi!</h1></div>' );\n\t\t\t\t\t\t\tobj = {\n\t\t\t\t\t\t\t\ttype : 'html',\n\t\t\t\t\t\t\t\tsrc  : item + ''\n\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Each gallery object has full collection of options\n\t\t\t\t\t\tobj.opts = $.extend( true, {}, self.opts, opts );\n\n\t\t\t\t\t\tif ( $.envirabox.isMobile ) {\n\t\t\t\t\t\t\tobj.opts = $.extend( true, {}, obj.opts, obj.opts.mobile );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Step 2 - Make sure we have content type, if not - try to guess\n\t\t\t\t\t\t// ==============================================================\n\t\t\t\t\t\ttype = obj.type || obj.opts.type;\n\t\t\t\t\t\tsrc  = obj.src || '';\n\n\t\t\t\t\t\tif ( ! type && src ) {\n\t\t\t\t\t\t\tif ( src.match( /(^data:image\\/[a-z0-9+\\/=]*,)|(\\.(jp(e|g|eg)|gif|png|bmp|webp|svg|ico)((\\?|#).*)?$)/i ) ) {\n\t\t\t\t\t\t\t\ttype = 'image';\n\t\t\t\t\t\t\t} else if ( src.match( /\\.(pdf)((\\?|#).*)?$/i ) ) {\n\t\t\t\t\t\t\t\ttype = 'pdf';\n\t\t\t\t\t\t\t} else if ( found = src.match( /\\.(mp4|mov|ogv)((\\?|#).*)?$/i ) ) {\n\t\t\t\t\t\t\t\ttype = 'video';\n\n\t\t\t\t\t\t\t\tif ( ! obj.opts.videoFormat ) {\n\t\t\t\t\t\t\t\t\tobj.opts.videoFormat = 'video/' + ( found[1] === 'ogv' ? 'ogg' : found[1] );\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t} else if ( src.charAt( 0 ) === '#' ) {\n\t\t\t\t\t\t\t\ttype = 'inline';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tobj.type = type;\n\n\t\t\t\t\t\t// Step 3 - Some adjustments\n\t\t\t\t\t\t// =========================\n\t\t\t\t\t\tobj.index = self.group.length;\n\n\t\t\t\t\t\t// Check if $orig and $thumb objects exist\n\t\t\t\t\t\tif ( obj.opts.$orig && ! obj.opts.$orig.length ) {\n\t\t\t\t\t\t\tdelete obj.opts.$orig;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( ! obj.opts.$thumb && obj.opts.$orig ) {\n\t\t\t\t\t\t\tobj.opts.$thumb = obj.opts.$orig.find( 'img:first' );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( obj.opts.$thumb && ! obj.opts.$thumb.length ) {\n\t\t\t\t\t\t\tdelete obj.opts.$thumb;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Caption is a \"special\" option, it can be passed as a method\n\t\t\t\t\t\tif ( $.type( obj.opts.caption ) === 'function' ) {\n\t\t\t\t\t\t\tobj.opts.caption = obj.opts.caption.apply( item, [ self, obj ] );\n\t\t\t\t\t\t} else if ( 'caption' in data ) {\n\t\t\t\t\t\t\tobj.opts.caption = data.caption;\n\t\t\t\t\t\t} else if ( (typeof obj.opts) === 'object' && (typeof obj.opts.caption) === 'string' && obj.opts.caption !== null && Object.keys( obj.opts ).length > 0) {\n\t\t\t\t\t\t\t// used for Envira Links, extra checks for IE11\n\t\t\t\t\t\t\tobj.opts.caption = obj.opts.caption;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tobj.opts.caption = '';\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Make sure we have caption as a string\n\t\t\t\t\t\tobj.opts.caption = obj.opts.caption === undefined ? '' : obj.opts.caption + '';\n\n\t\t\t\t\t\t// Make sure caption isn't null\n\t\t\t\t\t\tif ( obj.opts.caption == null ) {\n\t\t\t\t\t\t\tobj.opts.caption = '';\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Caption is a \"special\" option, it can be passed as a method\n\t\t\t\t\t\tif ( $.type( obj.opts.title ) === 'function' ) {\n\t\t\t\t\t\t\tobj.opts.title = obj.opts.title.apply( item, [ self, obj ] );\n\t\t\t\t\t\t} else if ( 'title' in data ) {\n\t\t\t\t\t\t\tobj.opts.title = data.title;\n\t\t\t\t\t\t} else if ( (typeof obj.opts) === 'object' && (typeof obj.opts.title) === 'string' && obj.opts.title !== null && Object.keys( obj.opts ).length > 0) {\n\t\t\t\t\t\t\t// used for Envira Links, extra checks for IE11\n\t\t\t\t\t\t\tobj.opts.title = obj.opts.title;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tobj.opts.title = '';\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Make sure we have title as a string\n\t\t\t\t\t\tobj.opts.title = obj.opts.title === undefined ? '' : obj.opts.title + '';\n\n\t\t\t\t\t\t// Make sure caption isn't null\n\t\t\t\t\t\tif ( obj.opts.title == null ) {\n\t\t\t\t\t\t\tobj.opts.title = '';\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Check if url contains \"filter\" used to filter the content\n\t\t\t\t\t\t// Example: \"ajax.html #something\"\n\t\t\t\t\t\tif ( type === 'ajax' ) {\n\t\t\t\t\t\t\tsrcParts = src.split( /\\s+/, 2 );\n\n\t\t\t\t\t\t\tif ( srcParts.length > 1 ) {\n\t\t\t\t\t\t\t\tobj.src = srcParts.shift();\n\n\t\t\t\t\t\t\t\tobj.opts.filter = srcParts.shift();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( obj.opts.smallBtn !== undefined && obj.opts.smallBtn == true ) {\n\n\t\t\t\t\t\t\tobj.opts.toolbar  = false;\n\t\t\t\t\t\t\tobj.opts.smallBtn = true;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// If the type is \"pdf\", then simply load file into iframe\n\t\t\t\t\t\tif ( type === 'pdf' ) {\n\t\t\t\t\t\t\tobj.type = 'iframe';\n\n\t\t\t\t\t\t\tobj.opts.iframe.preload = false;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Hide all buttons and disable interactivity for modal items\n\t\t\t\t\t\tif ( obj.opts.modal ) {\n\n\t\t\t\t\t\t\tobj.opts = $.extend(\n\t\t\t\t\t\t\t\ttrue,\n\t\t\t\t\t\t\t\tobj.opts,\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t// Remove buttons\n\t\t\t\t\t\t\t\t\tinfobar : 0,\n\t\t\t\t\t\t\t\t\ttoolbar : 0,\n\n\t\t\t\t\t\t\t\t\tsmallBtn : 0,\n\n\t\t\t\t\t\t\t\t\t// Disable keyboard navigation\n\t\t\t\t\t\t\t\t\tkeyboard : 0,\n\n\t\t\t\t\t\t\t\t\t// Disable some modules\n\t\t\t\t\t\t\t\t\tslideShow  : 0,\n\t\t\t\t\t\t\t\t\tfullScreen : 0,\n\t\t\t\t\t\t\t\t\tthumbs     : 0,\n\t\t\t\t\t\t\t\t\ttouch      : 0,\n\n\t\t\t\t\t\t\t\t\t// Disable click event handlers\n\t\t\t\t\t\t\t\t\tclickContent    : false,\n\t\t\t\t\t\t\t\t\tclickSlide      : false,\n\t\t\t\t\t\t\t\t\tclickOutside    : false,\n\t\t\t\t\t\t\t\t\tdblclickContent : false,\n\t\t\t\t\t\t\t\t\tdblclickSlide   : false,\n\t\t\t\t\t\t\t\t\tdblclickOutside : false\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Step 4 - Add processed object to group\n\t\t\t\t\t\t// ======================================\n\t\t\t\t\t\tself.group.push( obj );\n\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t},\n\n\t\t\t// Attach an event handler functions for:\n\t\t\t// - navigation buttons\n\t\t\t// - browser scrolling, resizing;\n\t\t\t// - focusing\n\t\t\t// - keyboard\n\t\t\t// - detect idle\n\t\t\t// ======================================\n\t\t\taddEvents : function() {\n\t\t\t\tvar self = this;\n\n\t\t\t\tself.removeEvents();\n\n\t\t\t\t// Make navigation elements clickable\n\t\t\t\tself.$refs.container.on(\n\t\t\t\t\t'click.eb-close',\n\t\t\t\t\t'[data-envirabox-close]',\n\t\t\t\t\tfunction(e) {\n\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\t\tself.close( e );\n\n\t\t\t\t\t}\n\t\t\t\t).on(\n\t\t\t\t\t'click.eb-prev touchend.eb-prev',\n\t\t\t\t\t'[data-envirabox-prev]',\n\t\t\t\t\tfunction(e) {\n\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\t\tself.previous();\n\n\t\t\t\t\t}\n\t\t\t\t).on(\n\t\t\t\t\t'click.eb-next touchend.eb-next',\n\t\t\t\t\t'[data-envirabox-next]',\n\t\t\t\t\tfunction(e) {\n\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\t\tself.next();\n\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\t// Handle page scrolling and browser resizing\n\t\t\t\t$W.on(\n\t\t\t\t\t'orientationchange.eb resize.eb',\n\t\t\t\t\tfunction(e) {\n\n\t\t\t\t\t\tif ( e && e.originalEvent && e.originalEvent.type === \"resize\" ) {\n\n\t\t\t\t\t\t\trequestAFrame(\n\t\t\t\t\t\t\t\tfunction() {\n\t\t\t\t\t\t\t\t\tself.update();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tself.$refs.stage.hide();\n\n\t\t\t\t\t\t\tsetTimeout(\n\t\t\t\t\t\t\t\tfunction() {\n\t\t\t\t\t\t\t\t\tself.$refs.stage.show();\n\n\t\t\t\t\t\t\t\t\tself.update();\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t500\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\t// Trap keyboard focus inside of the modal, so the user does not accidentally tab outside of the modal\n\t\t\t\t// (a.k.a. \"escaping the modal\")\n\t\t\t\t$D.on(\n\t\t\t\t\t'focusin.eb',\n\t\t\t\t\tfunction(e) {\n\t\t\t\t\t\tvar instance = $.envirabox ? $.envirabox.getInstance() : null;\n\n\t\t\t\t\t\tif ( instance.isClosing || ! instance.current || ! instance.current.opts.trapFocus || $( e.target ).hasClass( 'envirabox-container' ) || $( e.target ).is( document ) ) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( instance && $( e.target ).css( 'position' ) !== 'fixed' && ! instance.$refs.container.has( e.target ).length ) {\n\t\t\t\t\t\t\te.stopPropagation();\n\n\t\t\t\t\t\t\tinstance.focus();\n\n\t\t\t\t\t\t\t// Sometimes page gets scrolled, set it back\n\t\t\t\t\t\t\t$W.scrollTop( self.scrollTop ).scrollLeft( self.scrollLeft );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\t// Enable keyboard navigation\n\t\t\t\t$D.on(\n\t\t\t\t\t'keydown.eb',\n\t\t\t\t\tfunction (e) {\n\t\t\t\t\t\tvar current = self.current,\n\t\t\t\t\t\tkeycode     = e.keyCode || e.which;\n\n\t\t\t\t\t\tif ( ! current || ! current.opts.keyboard ) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( $( e.target ).is( 'input' ) || $( e.target ).is( 'textarea' ) ) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Backspace and Esc keys\n\t\t\t\t\t\tif ( keycode === 8 || keycode === 27 ) {\n\t\t\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\t\t\tself.close( e );\n\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Left arrow and Up arrow\n\t\t\t\t\t\tif ( keycode === 37 || keycode === 38 ) {\n\t\t\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\t\t\tself.previous();\n\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Righ arrow and Down arrow\n\t\t\t\t\t\tif ( keycode === 39 || keycode === 40 ) {\n\t\t\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\t\t\tself.next();\n\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tself.trigger( 'afterKeydown', e, keycode );\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\t// Hide controls after some inactivity period\n\t\t\t\tif ( self.group[ self.currIndex ].opts.idleTime ) {\n\t\t\t\t\tself.idleSecondsCounter = 0;\n\n\t\t\t\t\t$D.on(\n\t\t\t\t\t\t'mousemove.eb-idle mouseenter.eb-idle mouseleave.eb-idle mousedown.eb-idle touchstart.eb-idle touchmove.eb-idle scroll.eb-idle keydown.eb-idle',\n\t\t\t\t\t\tfunction() {\n\t\t\t\t\t\t\tself.idleSecondsCounter = 0;\n\n\t\t\t\t\t\t\tif ( self.isIdle ) {\n\t\t\t\t\t\t\t\tself.showControls();\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tself.isIdle = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\n\t\t\t\t\tself.idleInterval = window.setInterval(\n\t\t\t\t\t\tfunction() {\n\n\t\t\t\t\t\t\tself.idleSecondsCounter++;\n\n\t\t\t\t\t\t\tif ( self.idleSecondsCounter >= self.group[ self.currIndex ].opts.idleTime ) {\n\t\t\t\t\t\t\t\tself.isIdle             = true;\n\t\t\t\t\t\t\t\tself.idleSecondsCounter = 0;\n\n\t\t\t\t\t\t\t\tself.hideControls();\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t},\n\t\t\t\t\t\t1000\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\t// Remove events added by the core\n\t\t\t// ===============================\n\t\t\tremoveEvents : function () {\n\t\t\t\tvar self = this;\n\n\t\t\t\t$W.off( 'orientationchange.eb resize.eb' );\n\t\t\t\t$D.off( 'focusin.eb keydown.eb .eb-idle' );\n\n\t\t\t\tthis.$refs.container.off( '.eb-close .eb-prev .eb-next' );\n\n\t\t\t\tif ( self.idleInterval ) {\n\t\t\t\t\twindow.clearInterval( self.idleInterval );\n\n\t\t\t\t\tself.idleInterval = null;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t// Change to previous gallery item\n\t\t\t// ===============================\n\t\t\tprevious : function( duration ) {\n\t\t\t\treturn this.jumpTo( this.currPos - 1, duration );\n\t\t\t},\n\n\t\t\t// Change to next gallery item\n\t\t\t// ===========================\n\t\t\tnext : function( duration ) {\n\t\t\t\treturn this.jumpTo( this.currPos + 1, duration );\n\t\t\t},\n\n\t\t\t// Switch to selected gallery item\n\t\t\t// ===============================\n\t\t\tjumpTo : function ( pos, duration, slide ) {\n\t\t\t\tvar self = this,\n\t\t\t\tfirstRun,\n\t\t\t\tloop,\n\t\t\t\tcurrent,\n\t\t\t\tprevious,\n\t\t\t\tcanvasWidth,\n\t\t\t\tcurrentPos,\n\t\t\t\ttransitionProps;\n\n\t\t\t\tvar groupLen = self.group.length;\n\n\t\t\t\tif ( self.isSliding || self.isClosing || ( self.isAnimating && self.firstRun ) ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tpos  = parseInt( pos, 10 );\n\t\t\t\tloop = self.current ? self.current.opts.loop : self.opts.loop;\n\n\t\t\t\tif ( ! loop && ( pos < 0 || pos >= groupLen ) ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tfirstRun = self.firstRun = ( self.firstRun === null );\n\n\t\t\t\tif ( groupLen < 2 && ! firstRun && ! ! self.isSliding ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tprevious = self.current;\n\n\t\t\t\tself.prevIndex = self.currIndex;\n\t\t\t\tself.prevPos   = self.currPos;\n\n\t\t\t\t// Create slides\n\t\t\t\tcurrent = self.createSlide( pos );\n\n\t\t\t\tif ( groupLen > 1 ) {\n\t\t\t\t\tif ( loop || current.index > 0 ) {\n\t\t\t\t\t\tself.createSlide( pos - 1 );\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( loop || current.index < groupLen - 1 ) {\n\t\t\t\t\t\tself.createSlide( pos + 1 );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tself.current   = current;\n\t\t\t\tself.currIndex = current.index;\n\t\t\t\tself.currPos   = current.pos;\n\n\t\t\t\tself.trigger( 'beforeShow', firstRun );\n\n\t\t\t\tself.updateControls();\n\n\t\t\t\tcurrentPos = $.envirabox.getTranslate( current.$slide );\n\n\t\t\t\tcurrent.isMoved        = ( currentPos.left !== 0 || currentPos.top !== 0 ) && ! current.$slide.hasClass( 'envirabox-animated' );\n\t\t\t\tcurrent.forcedDuration = undefined;\n\n\t\t\t\tif ( $.isNumeric( duration ) ) {\n\t\t\t\t\tcurrent.forcedDuration = duration;\n\t\t\t\t} else {\n\t\t\t\t\tduration = current.opts[ firstRun ? 'animationDuration' : 'transitionDuration' ];\n\t\t\t\t}\n\n\t\t\t\tduration = parseInt( duration, 10 );\n\n\t\t\t\t// Fresh start - reveal container, current slide and start loading content\n\t\t\t\tif ( firstRun ) {\n\n\t\t\t\t\tif ( current.opts.animationEffect && duration ) {\n\t\t\t\t\t\tself.$refs.container.css( 'transition-duration', duration + 'ms' );\n\t\t\t\t\t}\n\n\t\t\t\t\tself.$refs.container.removeClass( 'envirabox-is-hidden' );\n\n\t\t\t\t\tforceRedraw( self.$refs.container );\n\n\t\t\t\t\tself.$refs.container.addClass( 'envirabox-is-open' );\n\n\t\t\t\t\t// Make first slide visible (to display loading icon, if needed)\n\t\t\t\t\tcurrent.$slide.addClass( 'envirabox-slide--current' );\n\n\t\t\t\t\tself.loadSlide( current );\n\n\t\t\t\t\tself.preload();\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// Clean up\n\t\t\t\t$.each(\n\t\t\t\t\tself.slides,\n\t\t\t\t\tfunction( index, slide ) {\n\t\t\t\t\t\t$.envirabox.stop( slide.$slide );\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\t// Make current that slide is visible even if content is still loading\n\t\t\t\tcurrent.$slide.removeClass( 'envirabox-slide--next envirabox-slide--previous' ).addClass( 'envirabox-slide--current' );\n\n\t\t\t\t// If slides have been dragged, animate them to correct position\n\t\t\t\tif ( current.isMoved ) {\n\t\t\t\t\tcanvasWidth = Math.round( current.$slide.width() );\n\n\t\t\t\t\t$.each(\n\t\t\t\t\t\tself.slides,\n\t\t\t\t\t\tfunction( index, slide ) {\n\t\t\t\t\t\t\tvar pos = slide.pos - current.pos;\n\n\t\t\t\t\t\t\t$.envirabox.animate(\n\t\t\t\t\t\t\t\tslide.$slide,\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttop  : 0,\n\t\t\t\t\t\t\t\t\tleft : ( pos * canvasWidth ) + ( pos * slide.opts.gutter )\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tduration,\n\t\t\t\t\t\t\t\tfunction() {\n\n\t\t\t\t\t\t\t\t\tslide.$slide.removeAttr( 'style' ).removeClass( 'envirabox-slide--next envirabox-slide--previous' );\n\n\t\t\t\t\t\t\t\t\tif ( slide.pos === self.currPos ) {\n\t\t\t\t\t\t\t\t\t\tcurrent.isMoved = false;\n\n\t\t\t\t\t\t\t\t\t\tself.complete();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\n\t\t\t\t} else {\n\t\t\t\t\tself.$refs.stage.children().removeAttr( 'style' );\n\t\t\t\t}\n\n\t\t\t\t// Start transition that reveals current content\n\t\t\t\t// or wait when it will be loaded\n\t\t\t\tif ( current.isLoaded ) {\n\t\t\t\t\tself.revealContent( current );\n\n\t\t\t\t} else {\n\t\t\t\t\tself.loadSlide( current );\n\t\t\t\t}\n\n\t\t\t\tself.preload();\n\n\t\t\t\tif ( previous.pos === current.pos ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// Handle previous slide\n\t\t\t\t// =====================\n\t\t\t\ttransitionProps = 'envirabox-slide--' + ( previous.pos > current.pos ? 'next' : 'previous' );\n\n\t\t\t\tprevious.$slide.removeClass( 'envirabox-slide--complete envirabox-slide--current envirabox-slide--next envirabox-slide--previous' );\n\n\t\t\t\tprevious.isComplete = false;\n\n\t\t\t\tif ( ! duration || ( ! current.isMoved && ! current.opts.transitionEffect ) ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif ( current.isMoved ) {\n\t\t\t\t\tprevious.$slide.addClass( transitionProps );\n\n\t\t\t\t} else {\n\n\t\t\t\t\ttransitionProps = 'envirabox-animated ' + transitionProps + ' envirabox-fx-' + current.opts.transitionEffect;\n\n\t\t\t\t\t$.envirabox.animate(\n\t\t\t\t\t\tprevious.$slide,\n\t\t\t\t\t\ttransitionProps,\n\t\t\t\t\t\tduration,\n\t\t\t\t\t\tfunction() {\n\t\t\t\t\t\t\tprevious.$slide.removeClass( transitionProps ).removeAttr( 'style' );\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\n\t\t\t\t}\n\n\t\t\t\tself.trigger( 'afterShow' );\n\n\t\t\t},\n\n\t\t\t// Create new \"slide\" element\n\t\t\t// These are gallery items  that are actually added to DOM\n\t\t\t// =======================================================\n\t\t\tcreateSlide : function( pos ) {\n\t\t\t\tvar self = this;\n\t\t\t\tvar $slide;\n\t\t\t\tvar index;\n\n\t\t\t\tindex = pos % self.group.length;\n\t\t\t\tindex = index < 0 ? self.group.length + index : index;\n\n\t\t\t\tif ( ! self.slides[ pos ] && self.group[ index ] ) {\n\t\t\t\t\t$slide = $( '<div class=\"envirabox-slide\"></div>' ).appendTo( self.$refs.stage );\n\n\t\t\t\t\tself.slides[ pos ] = $.extend(\n\t\t\t\t\t\ttrue,\n\t\t\t\t\t\t{},\n\t\t\t\t\t\tself.group[ index ],\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tpos      : pos,\n\t\t\t\t\t\t\t$slide   : $slide,\n\t\t\t\t\t\t\tisLoaded : false,\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\n\t\t\t\t\tself.updateSlide( self.slides[ pos ] );\n\t\t\t\t}\n\n\t\t\t\treturn self.slides[ pos ];\n\t\t\t},\n\n\t\t\t// Scale image to the actual size of the image\n\t\t\t// ===========================================\n\t\t\tscaleToActual : function( x, y, duration ) {\n\t\t\t\tvar self = this;\n\n\t\t\t\tvar current = self.current;\n\t\t\t\tvar $what   = current.$content;\n\n\t\t\t\tvar imgPos, posX, posY, scaleX, scaleY;\n\n\t\t\t\tvar canvasWidth  = parseInt( current.$slide.width(), 10 );\n\t\t\t\tvar canvasHeight = parseInt( current.$slide.height(), 10 );\n\n\t\t\t\tvar newImgWidth  = current.width;\n\t\t\t\tvar newImgHeight = current.height;\n\n\t\t\t\tif ( ! ( current.type == 'image' && ! current.hasError) || ! $what || self.isAnimating) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t$.envirabox.stop( $what );\n\n\t\t\t\tself.isAnimating = true;\n\n\t\t\t\tx = x === undefined ? canvasWidth * 0.5 : x;\n\t\t\t\ty = y === undefined ? canvasHeight * 0.5 : y;\n\n\t\t\t\timgPos = $.envirabox.getTranslate( $what );\n\n\t\t\t\tscaleX = newImgWidth / imgPos.width;\n\t\t\t\tscaleY = newImgHeight / imgPos.height;\n\n\t\t\t\t// Get center position for original image\n\t\t\t\tposX = ( canvasWidth * 0.5 - newImgWidth * 0.5 );\n\t\t\t\tposY = ( canvasHeight * 0.5 - newImgHeight * 0.5 );\n\n\t\t\t\t// Make sure image does not move away from edges\n\t\t\t\tif ( newImgWidth > canvasWidth ) {\n\t\t\t\t\tposX = imgPos.left * scaleX - ( ( x * scaleX ) - x );\n\n\t\t\t\t\tif ( posX > 0 ) {\n\t\t\t\t\t\tposX = 0;\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( posX < canvasWidth - newImgWidth ) {\n\t\t\t\t\t\tposX = canvasWidth - newImgWidth;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif ( newImgHeight > canvasHeight) {\n\t\t\t\t\tposY = imgPos.top * scaleY - ( ( y * scaleY ) - y );\n\n\t\t\t\t\tif ( posY > 0 ) {\n\t\t\t\t\t\tposY = 0;\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( posY < canvasHeight - newImgHeight ) {\n\t\t\t\t\t\tposY = canvasHeight - newImgHeight;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tself.updateCursor( newImgWidth, newImgHeight );\n\n\t\t\t\t$.envirabox.animate(\n\t\t\t\t\t$what,\n\t\t\t\t\t{\n\t\t\t\t\t\ttop    : posY,\n\t\t\t\t\t\tleft   : posX,\n\t\t\t\t\t\tscaleX : scaleX,\n\t\t\t\t\t\tscaleY : scaleY\n\t\t\t\t\t},\n\t\t\t\t\tduration || 330,\n\t\t\t\t\tfunction() {\n\t\t\t\t\t\tself.isAnimating = false;\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\t// Stop slideshow\n\t\t\t\tif ( self.SlideShow && self.SlideShow.isActive ) {\n\t\t\t\t\tself.SlideShow.stop();\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t// Scale image to fit inside parent element\n\t\t\t// ========================================\n\t\t\tscaleToFit : function( duration ) {\n\t\t\t\tvar self = this;\n\n\t\t\t\tvar current = self.current;\n\t\t\t\tvar $what   = current.$content;\n\t\t\t\tvar end;\n\n\t\t\t\tif ( ! ( current.type == 'image' && ! current.hasError) || ! $what || self.isAnimating ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t$.envirabox.stop( $what );\n\n\t\t\t\tself.isAnimating = true;\n\n\t\t\t\tend = self.getFitPos( current );\n\n\t\t\t\tself.updateCursor( end.width, end.height );\n\n\t\t\t\t$.envirabox.animate(\n\t\t\t\t\t$what,\n\t\t\t\t\t{\n\t\t\t\t\t\ttop    : end.top,\n\t\t\t\t\t\tleft   : end.left,\n\t\t\t\t\t\tscaleX : end.width / $what.width(),\n\t\t\t\t\t\tscaleY : end.height / $what.height()\n\t\t\t\t\t},\n\t\t\t\t\tduration || 330,\n\t\t\t\t\tfunction() {\n\t\t\t\t\t\tself.isAnimating = false;\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t},\n\n\t\t\t// Calculate image size to fit inside viewport\n\t\t\t// ===========================================\n\t\t\tgetFitPos : function( slide ) {\n\t\t\t\tvar self  = this;\n\t\t\t\tvar $what = slide.$content;\n\n\t\t\t\tvar imgWidth  = slide.width;\n\t\t\t\tvar imgHeight = slide.height;\n\n\t\t\t\tvar margin = slide.opts.margin;\n\n\t\t\t\tvar canvasWidth, canvasHeight, minRatio, width, height;\n\n\t\t\t\tif ( ! $what || ! $what.length || ( ! imgWidth && ! imgHeight) ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\t// Convert \"margin to CSS style: [ top, right, bottom, left ]\n\t\t\t\tif ( $.type( margin ) === \"number\" ) {\n\t\t\t\t\tmargin = [ margin, margin ];\n\t\t\t\t}\n\n\t\t\t\tif ( margin.length == 2 ) {\n\t\t\t\t\tmargin = [ margin[0], margin[1], margin[0], margin[1] ];\n\t\t\t\t}\n\n\t\t\t\tif ( $W.width() < 800 ) {\n\t\t\t\t\tmargin = [ 0, 0, 0, 0 ];\n\t\t\t\t}\n\n\t\t\t\t// We can not use $slide width here, because it can have different diemensions while in transiton\n\t\t\t\tcanvasWidth  = parseInt( self.$refs.stage.width(), 10 ) - ( margin[ 1 ] + margin[ 3 ] );\n\t\t\t\tcanvasHeight = parseInt( self.$refs.stage.height(), 10 ) - ( margin[ 0 ] + margin[ 2 ] );\n\n\t\t\t\tminRatio = Math.min( 1, canvasWidth / imgWidth, canvasHeight / imgHeight );\n\n\t\t\t\twidth  = Math.floor( minRatio * imgWidth );\n\t\t\t\theight = Math.floor( minRatio * imgHeight );\n\n\t\t\t\t// Use floor rounding to make sure it really fits\n\t\t\t\treturn {\n\t\t\t\t\ttop    : Math.floor( ( canvasHeight - height ) * 0.5 ) + margin[ 0 ],\n\t\t\t\t\tleft   : Math.floor( ( canvasWidth - width ) * 0.5 ) + margin[ 3 ],\n\t\t\t\t\twidth  : width,\n\t\t\t\t\theight : height\n\t\t\t\t};\n\n\t\t\t},\n\n\t\t\t// Update position and content of all slides\n\t\t\t// =========================================\n\t\t\tupdate : function() {\n\n\t\t\t\tvar self = this;\n\n\t\t\t\t$.each(\n\t\t\t\t\tself.slides,\n\t\t\t\t\tfunction( key, slide ) {\n\t\t\t\t\t\tself.updateSlide( slide );\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t},\n\n\t\t\t// Update slide position and scale content to fit\n\t\t\t// ==============================================\n\t\t\tupdateSlide : function( slide ) {\n\n\t\t\t\tvar self  = this;\n\t\t\t\tvar $what = slide.$content;\n\n\t\t\t\tif ( $what && ( slide.width || slide.height ) ) {\n\t\t\t\t\t$.envirabox.stop( $what );\n\n\t\t\t\t\t$.envirabox.setTranslate( $what, self.getFitPos( slide ) );\n\n\t\t\t\t\tif ( slide.pos === self.currPos ) {\n\t\t\t\t\t\tself.updateCursor();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tslide.$slide.trigger( 'refresh' );\n\n\t\t\t\tself.trigger( 'onUpdate', slide );\n\n\t\t\t},\n\n\t\t\t// Update cursor style depending if content can be zoomed\n\t\t\t// ======================================================\n\t\t\tupdateCursor : function( nextWidth, nextHeight ) {\n\t\t\t\tvar self = this;\n\t\t\t\tvar isScaledDown;\n\n\t\t\t\tvar $container = self.$refs.container.removeClass( 'envirabox-is-zoomable envirabox-can-zoomIn envirabox-can-drag envirabox-can-zoomOut' );\n\n\t\t\t\tif ( ! self.current || self.isClosing ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif ( self.isZoomable() ) {\n\n\t\t\t\t\t$container.addClass( 'envirabox-is-zoomable' );\n\n\t\t\t\t\tif ( nextWidth !== undefined && nextHeight !== undefined ) {\n\t\t\t\t\t\tisScaledDown = nextWidth < self.current.width && nextHeight < self.current.height;\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\tisScaledDown = self.isScaledDown();\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( isScaledDown ) {\n\n\t\t\t\t\t\t// If image is scaled down, then, obviously, it can be zoomed to full size\n\t\t\t\t\t\t$container.addClass( 'envirabox-can-zoomIn' );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tif ( self.current.opts.touch ) {\n\n\t\t\t\t\t\t\t// If image size ir largen than available available and touch module is not disable,\n\t\t\t\t\t\t\t// then user can do panning\n\t\t\t\t\t\t\t$container.addClass( 'envirabox-can-drag' );\n\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t$container.addClass( 'envirabox-can-zoomOut' );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} else if ( self.current.opts.touch ) {\n\t\t\t\t\t$container.addClass( 'envirabox-can-drag' );\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\t// Check if current slide is zoomable\n\t\t\t// ==================================\n\t\t\tisZoomable : function() {\n\t\t\t\tvar self = this;\n\n\t\t\t\tvar current = self.current;\n\t\t\t\tvar fitPos;\n\n\t\t\t\tif ( ! current || self.isClosing ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// Assume that slide is zoomable if\n\t\t\t\t// - image is loaded successfuly\n\t\t\t\t// - click action is \"zoom\"\n\t\t\t\t// - actual size of the image is smaller than available area\n\t\t\t\tif ( current.type === 'image' && current.isLoaded && ! current.hasError &&\n\t\t\t\t( current.opts.clickContent === 'zoom' || ( $.isFunction( current.opts.clickContent ) && current.opts.clickContent( current ) === \"zoom\" ) )\n\t\t\t\t) {\n\n\t\t\t\t\tfitPos = self.getFitPos( current );\n\n\t\t\t\t\tif ( current.width > fitPos.width || current.height > fitPos.height ) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\n\t\t\t},\n\n\t\t\t// Check if current image dimensions are smaller than actual\n\t\t\t// =========================================================\n\t\t\tisScaledDown : function() {\n\n\t\t\t\tvar self = this;\n\n\t\t\t\tvar current = self.current;\n\t\t\t\tvar $what   = current.$content;\n\n\t\t\t\tvar rez = false;\n\n\t\t\t\tif ( $what ) {\n\t\t\t\t\trez = $.envirabox.getTranslate( $what );\n\t\t\t\t\trez = rez.width < current.width || rez.height < current.height;\n\t\t\t\t}\n\n\t\t\t\treturn rez;\n\n\t\t\t},\n\n\t\t\t// Check if image dimensions exceed parent element\n\t\t\t// ===============================================\n\t\t\tcanPan : function() {\n\n\t\t\t\tvar self = this;\n\n\t\t\t\tvar current = self.current;\n\t\t\t\tvar $what   = current.$content;\n\n\t\t\t\tvar rez = false;\n\n\t\t\t\tif ( $what ) {\n\t\t\t\t\trez = self.getFitPos( current );\n\t\t\t\t\trez = Math.abs( $what.width() - rez.width ) > 1 || Math.abs( $what.height() - rez.height ) > 1;\n\n\t\t\t\t}\n\n\t\t\t\treturn rez;\n\n\t\t\t},\n\n\t\t\t// Load content into the slide\n\t\t\t// ===========================\n\t\t\tloadSlide : function( slide ) {\n\t\t\t\tvar self = this, type, $slide;\n\t\t\t\tvar ajaxLoad;\n\n\t\t\t\tif ( slide.isLoading ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif ( slide.isLoaded ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tslide.isLoading = true;\n\n\t\t\t\tself.trigger( 'beforeLoad', slide );\n\n\t\t\t\ttype   = slide.type;\n\t\t\t\t$slide = slide.$slide;\n\n\t\t\t\t$slide\n\t\t\t\t.off( 'refresh' )\n\t\t\t\t.trigger( 'onReset' )\n\t\t\t\t.addClass( 'envirabox-slide--' + ( type || 'unknown' ) )\n\t\t\t\t.addClass( slide.opts.slideClass );\n\n\t\t\t\t// Create content depending on the type\n\t\t\t\tswitch ( type ) {\n\n\t\t\t\t\tcase 'image':\n\n\t\t\t\t\t\tself.setImage( slide );\n\n\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'video' :\n\n\t\t\t\t\t\tself.setVideo( slide );\n\n\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'iframe':\n\n\t\t\t\t\t\tself.setIframe( slide );\n\n\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'genericDiv':\n\n\t\t\t\t\t\tself.setGenericDiv( slide );\n\n\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'html':\n\n\t\t\t\t\t\tself.setContent( slide, slide.src || slide.content );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'inline':\n\n\t\t\t\t\t\tif ( $( slide.src ).length ) {\n\t\t\t\t\t\t\tself.setContent( slide, $( slide.src ) );\n\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tself.setError( slide );\n\t\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'ajax':\n\n\t\t\t\t\t\tself.showLoading( slide );\n\n\t\t\t\t\t\tajaxLoad = $.ajax(\n\t\t\t\t\t\t\t$.extend(\n\t\t\t\t\t\t\t\t{},\n\t\t\t\t\t\t\t\tslide.opts.ajax.settings,\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\turl : slide.src,\n\t\t\t\t\t\t\t\t\tsuccess : function ( data, textStatus ) {\n\n\t\t\t\t\t\t\t\t\t\tif ( textStatus === 'success' ) {\n\t\t\t\t\t\t\t\t\t\t\tself.setContent( slide, data );\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\terror : function ( jqXHR, textStatus ) {\n\n\t\t\t\t\t\t\t\t\t\tif ( jqXHR && textStatus !== 'abort' ) {\n\t\t\t\t\t\t\t\t\t\t\tself.setError( slide );\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\t$slide.one(\n\t\t\t\t\t\t\t'onReset',\n\t\t\t\t\t\t\tfunction () {\n\t\t\t\t\t\t\t\tajaxLoad.abort();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\n\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\n\t\t\t\t\t\tself.setError( slide );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\n\t\t\t},\n\n\t\t\tsetVideo: function( slide ) {\n\n\t\t\t\tvar self = this;\n\n\t\t\t\tif ( self.isClosing ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tself.hideLoading( slide );\n\n\t\t\t\tslide.$slide.empty();\n\n\t\t\t\tlet style_width   = false,\n\t\t\t\tstyle_height      = false,\n\t\t\t\tvideoWidthHeight  = '',\n\t\t\t\tvideoControls     = 'controls', /* controls by default */\n\t\t\t\tvideoControlsList = '',\n\t\t\t\tvideoClasses      = '';\n\n\t\t\t\t// Setup specific CSS classes that might help with customizing video, especially for self hosted\n\t\t\t\tif ( slide.opts.videoPlayPause !== false ) {\n\t\t\t\t\tvideoClasses = videoClasses + 'videos_play_pause ';\n\t\t\t\t}\n\t\t\t\tif ( slide.opts.videoProgressBar !== false ) {\n\t\t\t\t\tvideoClasses = videoClasses + 'videos_progress ';\n\t\t\t\t}\n\t\t\t\tif ( slide.opts.videoPlaybackTime !== false ) {\n\t\t\t\t\tvideoClasses = videoClasses + 'videos_playback_time ';\n\t\t\t\t}\n\t\t\t\tif ( slide.opts.videoVideoLength !== false ) {\n\t\t\t\t\tvideoClasses = videoClasses + 'videos_video_length ';\n\t\t\t\t}\n\t\t\t\tif ( slide.opts.videoVolumeControls !== false ) {\n\t\t\t\t\tvideoClasses = videoClasses + 'videos_volume_controls ';\n\t\t\t\t}\n\t\t\t\tif ( slide.opts.videoControlBar !== false ) {\n\t\t\t\t\tvideoClasses = videoClasses + 'videos_controls ';\n\t\t\t\t} else {\n\t\t\t\t\tvideoControls = '';\n\t\t\t\t\tvideoControlsList = videoControlsList + 'nodownload nofullscreen noremoteplayback ';\n\t\t\t\t}\n\t\t\t\tif ( slide.opts.videoFullscreen !== false ) {\n\t\t\t\t\tvideoClasses = videoClasses + 'videos_fullscreen ';\n\t\t\t\t}\n\t\t\t\tif ( slide.opts.videoDownload !== false ) {\n\t\t\t\t\tvideoClasses = videoClasses + 'videos_download ';\n\t\t\t\t} else {\n\t\t\t\t\tvideoControlsList = videoControlsList + 'nodownload ';\n\t\t\t\t}\n\n\t\t\t\tif ( slide.videoWidth > 0 ) {\n\t\t\t\t\tstyle_width = 'max-width:' + slide.videoWidth + 'px;';\n\t\t\t\t}\n\n\t\t\t\tif ( slide.videoHeight > 0 ) {\n\t\t\t\t\tstyle_height = 'max-height:' + slide.videoHeight + 'px;';\n\t\t\t\t}\n\n\t\t\t\tif ( style_width || style_height ) {\n\t\t\t\t\tvideoWidthHeight = 'style=\"' + style_width + style_height + '\"';\n\t\t\t\t}\n\n\t\t\t\tif ( slide.opts.arrows !== 0 && slide.opts.arrow_position == 'inside' ) {\n\t\t\t\t\t// This will be wrapper containing the video\n\t\t\t\t\tslide.$content = $( '<div class=\"envirabox-content video ' + videoClasses + '\" ' + videoWidthHeight + '\"><div class=\"envirabox-navigation-inside\"><a data-envirabox-prev title=\"prev\" class=\"envirabox-arrow envirabox-arrow--left envirabox-nav envirabox-prev\" href=\"#\"><span></span></a><a data-envirabox-next title=\"next\" class=\"envirabox-arrow envirabox-arrow--right envirabox-nav envirabox-next\" href=\"#\"><span></span></a></div>' )\n\t\t\t\t\t.appendTo( slide.$slide );\n\t\t\t\t} else {\n\n\t\t\t\t\t// This will be wrapper containing the video\n\t\t\t\t\tslide.$content = $( '<div class=\"envirabox-content ' + videoClasses + '\" ' + videoWidthHeight + '></div>' )\n\t\t\t\t\t.appendTo( slide.$slide );\n\t\t\t\t}\n\t\t\t\tif ( slide.opts.smallBtn === true ) {\n\t\t\t\t\tslide.$content.prepend( self.translate( slide, slide.opts.btnTpl.smallBtn ) );\n\t\t\t\t}\n\n\t\t\t\tif ( slide.opts.insideCap === true ) {\n\t\t\t\t\tlet caption  = slide.caption !== undefined ? slide.caption : '',\n\t\t\t\t\ttitle        = slide.title !== undefined ? slide.title : '',\n\t\t\t\t\tposition     = slide.opts.capPosition ? slide.opts.capPosition : '',\n\t\t\t\t\tcapTitleShow = slide.opts.capTitleShow ? slide.opts.capTitleShow : false,\n\t\t\t\t\titemID       = slide.enviraItemId ? slide.enviraItemId : '',\n\t\t\t\t\toutput       = capTitleShow == 'caption' ? '<div class=\"envirabox-caption ' + 'envirabox-caption-item-id-' + itemID + '\">' + caption + '</div>' : false;\n\n\t\t\t\t\toutput = capTitleShow == 'title' ? '<div class=\"envirabox-title ' + 'envirabox-title-item-id-' + itemID + '\">' + title + '</div>' : output;\n\n\t\t\t\t\tif ( output !== false && output !== undefined && output.length > 0 ) {\n\t\t\t\t\t\tslide.$content.prepend( '<div class=\"envirabox-caption-wrap ' + position + '\">' + output + '</div>' );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif ( videoControls != '' ) {\n\t\t\t\t\tlet posterImage = ( slide.videoPlaceholder ) ? slide.videoPlaceholder : slide.thumb, // use default image if nothing available?\n\t\t\t\t\tplaysInline     = ( slide.videoPlaysInline !== undefined ) ? slide.videoPlaysInline : 'playsinline';\n\t\t\t\t\tvideoControls   = videoControls + ' poster=\"' + posterImage + '\" ' + playsInline + ' controlsList=\"' + videoControlsList + '\"';\n\t\t\t\t}\n\n\t\t\t\tlet video_source = ( slide.src !== undefined ) ? slide.src : slide.link,\n\t\t\t\tvideo            = $( '<div class=\"envirabox-video-container\"><video class=\"envirabox-video-player\" ' + videoControls + '>' + '<source src=\"' + video_source + '\" type=\"video/mp4\">' + 'Your broswser doesn\\'t support HTML5 video' + '</video></div>' ).appendTo( slide.$content );\n\n\t\t\t\tthis.afterLoad( slide );\n\n\t\t\t},\n\n\t\t\t// Use thumbnail image, if possible\n\t\t\t// ================================\n\t\t\tsetImage : function( slide ) {\n\t\t\t\tvar self   = this;\n\t\t\t\tvar srcset = slide.opts.image.srcset;\n\n\t\t\t\tvar found, temp, pxRatio, windowWidth;\n\n\t\t\t\t// If we have \"srcset\", then we need to find matching \"src\" value.\n\t\t\t\t// This is necessary, because when you set an src attribute, the browser will preload the image\n\t\t\t\t// before any javascript or even CSS is applied.\n\t\t\t\tif ( srcset ) {\n\t\t\t\t\tpxRatio     = window.devicePixelRatio || 1;\n\t\t\t\t\twindowWidth = window.innerWidth * pxRatio;\n\n\t\t\t\t\ttemp = srcset.split( ',' ).map(\n\t\t\t\t\t\tfunction ( el ) {\n\t\t\t\t\t\t\tvar ret = {};\n\n\t\t\t\t\t\t\tel.trim().split( /\\s+/ ).forEach(\n\t\t\t\t\t\t\t\tfunction ( el, i ) {\n\t\t\t\t\t\t\t\t\tvar value = parseInt( el.substring( 0, el.length - 1 ), 10 );\n\n\t\t\t\t\t\t\t\t\tif ( i === 0 ) {\n\t\t\t\t\t\t\t\t\t\treturn ( ret.url = el );\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tif ( value ) {\n\t\t\t\t\t\t\t\t\t\tret.value   = value;\n\t\t\t\t\t\t\t\t\t\tret.postfix = el[ el.length - 1 ];\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\treturn ret;\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\n\t\t\t\t\t// Sort by value\n\t\t\t\t\ttemp.sort(\n\t\t\t\t\t\tfunction (a, b) {\n\t\t\t\t\t\t\treturn a.value - b.value;\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\n\t\t\t\t\t// Ok, now we have an array of all srcset values\n\t\t\t\t\tfor ( var j = 0; j < temp.length; j++ ) {\n\t\t\t\t\t\tvar el = temp[ j ];\n\n\t\t\t\t\t\tif ( ( el.postfix === 'w' && el.value >= windowWidth ) || ( el.postfix === 'x' && el.value >= pxRatio ) ) {\n\t\t\t\t\t\t\tfound = el;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// If not found, take the last one\n\t\t\t\t\tif ( ! found && temp.length ) {\n\t\t\t\t\t\tfound = temp[ temp.length - 1 ];\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( found ) {\n\t\t\t\t\t\tslide.src = found.url;\n\n\t\t\t\t\t\t// If we have default width/height values, we can calculate height for matching source\n\t\t\t\t\t\tif ( slide.width && slide.height && found.postfix == 'w' ) {\n\t\t\t\t\t\t\tslide.height = ( slide.width / slide.height ) * found.value;\n\t\t\t\t\t\t\tslide.width  = found.value;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif ( slide.opts.arrows !== 0 && slide.opts.arrow_position == 'inside' ) {\n\t\t\t\t\t// This will be wrapper containing both ghost and actual image\n\t\t\t\t\tslide.$content = $( '<div class=\"envirabox-image-wrap\"><div class=\"envirabox-navigation-inside\"><a data-envirabox-prev title=\"prev\" class=\"envirabox-arrow envirabox-arrow--left envirabox-nav envirabox-prev\" href=\"#\"><span></span></a><a data-envirabox-next title=\"next\" class=\"envirabox-arrow envirabox-arrow--right envirabox-nav envirabox-next\" href=\"#\"><span></span></a></div>' )\n\t\t\t\t\t.addClass( 'envirabox-is-hidden' )\n\t\t\t\t\t.appendTo( slide.$slide );\n\t\t\t\t} else {\n\n\t\t\t\t\t// This will be wrapper containing both ghost and actual image\n\t\t\t\t\tslide.$content = $( '<div class=\"envirabox-image-wrap\"></div>' )\n\t\t\t\t\t.addClass( 'envirabox-is-hidden' )\n\t\t\t\t\t.appendTo( slide.$slide );\n\t\t\t\t}\n\n\t\t\t\tif ( slide.opts.smallBtn === true ) {\n\t\t\t\t\tslide.$content.prepend( self.translate( slide, slide.opts.btnTpl.smallBtn ) );\n\t\t\t\t}\n\t\t\t\tif ( slide.opts.insideCap === true ) {\n\t\t\t\t\tlet caption  = slide.caption !== undefined ? slide.caption : '',\n\t\t\t\t\ttitle        = slide.title !== undefined ? slide.title : '',\n\t\t\t\t\tposition     = slide.opts.capPosition ? slide.opts.capPosition : '',\n\t\t\t\t\tcapTitleShow = slide.opts.capTitleShow ? slide.opts.capTitleShow : false,\n\t\t\t\t\titemID       = slide.enviraItemId ? slide.enviraItemId : '',\n\t\t\t\t\toutput       = capTitleShow == 'caption' ? '<div class=\"envirabox-caption ' + 'envirabox-caption-item-id-' + itemID + '\">' + caption + '</div>' : false;\n\n\t\t\t\t\toutput = capTitleShow == 'title' ? '<div class=\"envirabox-title ' + 'envirabox-title-item-id-' + itemID + '\">' + title + '</div>' : output;\n\n\n\t\t\t\t\tif ( output !== false && output !== undefined && output.length > 0 ) {\n\t\t\t\t\t\tslide.$content.prepend( '<div class=\"envirabox-caption-wrap ' + position + '\">' + output + '</div>' );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// If we have a thumbnail, we can display it while actual image is loading\n\t\t\t\t// Users will not stare at black screen and actual image will appear gradually\n\t\t\t\tif ( slide.opts.preload !== false && slide.opts.width && slide.opts.height && ( slide.opts.thumb || slide.opts.$thumb ) ) {\n\n\t\t\t\t\tslide.width  = slide.opts.width;\n\t\t\t\t\tslide.height = slide.opts.height;\n\n\t\t\t\t\tslide.$ghost = $( '<img />' )\n\t\t\t\t\t.one(\n\t\t\t\t\t\t'error',\n\t\t\t\t\t\tfunction() {\n\n\t\t\t\t\t\t\t$( this ).remove();\n\n\t\t\t\t\t\t\tslide.$ghost = null;\n\n\t\t\t\t\t\t\tself.setBigImage( slide );\n\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t\t\t.one(\n\t\t\t\t\t\t\t'load',\n\t\t\t\t\t\t\tfunction() {\n\n\t\t\t\t\t\t\t\tself.afterLoad( slide );\n\n\t\t\t\t\t\t\t\tself.setBigImage( slide );\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t)\n\t\t\t\t\t\t.addClass( 'envirabox-image' )\n\t\t\t\t\t\t.appendTo( slide.$content )\n\t\t\t\t\t\t.attr( 'src', slide.opts.thumb || slide.opts.$thumb.attr( 'src' ) );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tself.setBigImage( slide );\n\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\t// Create full-size image\n\t\t\t// ======================\n\t\t\tsetBigImage : function ( slide ) {\n\t\t\t\tvar self = this;\n\t\t\t\tvar $img = $( '<img />' );\n\n\t\t\t\tslide.$image = $img\n\t\t\t\t.one(\n\t\t\t\t\t'error',\n\t\t\t\t\tfunction() {\n\n\t\t\t\t\t\tself.setError( slide );\n\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t\t.one(\n\t\t\t\t\t'load',\n\t\t\t\t\tfunction() {\n\n\t\t\t\t\t\t// Clear timeout that checks if loading icon needs to be displayed\n\t\t\t\t\t\tclearTimeout( slide.timouts );\n\n\t\t\t\t\t\tslide.timouts = null;\n\n\t\t\t\t\t\tif ( self.isClosing ) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tslide.width  = this.naturalWidth;\n\t\t\t\t\t\tslide.height = this.naturalHeight;\n\n\t\t\t\t\t\tif ( slide.opts.image.srcset ) {\n\t\t\t\t\t\t\t$img.attr( 'sizes', '100vw' ).attr( 'srcset', slide.opts.image.srcset );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tself.hideLoading( slide );\n\n\t\t\t\t\t\tif ( slide.$ghost ) {\n\n\t\t\t\t\t\t\tslide.timouts = setTimeout(\n\t\t\t\t\t\t\t\tfunction() {\n\t\t\t\t\t\t\t\t\tslide.timouts = null;\n\n\t\t\t\t\t\t\t\t\tslide.$ghost.hide();\n\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tMath.min( 300, Math.max( 1000, slide.height / 1600 ) )\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tself.afterLoad( slide );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t\t.addClass( 'envirabox-image' )\n\t\t\t\t.attr( 'src', slide.src )\n\t\t\t\t.appendTo( slide.$content );\n\n\t\t\t\tif ( ( $img[0].complete || $img[0].readyState == \"complete\" ) && $img[0].naturalWidth && $img[0].naturalHeight ) {\n\t\t\t\t\t  $img.trigger( 'load' );\n\n\t\t\t\t} else if ( $img[0].error ) {\n\t\t\t\t\t $img.trigger( 'error' );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tslide.timouts = setTimeout(\n\t\t\t\t\t\tfunction() {\n\t\t\t\t\t\t\tif ( ! $img[0].complete && ! slide.hasError ) {\n\t\t\t\t\t\t\t\tself.showLoading( slide );\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t},\n\t\t\t\t\t\t100\n\t\t\t\t\t);\n\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\t// Create iframe wrapper, iframe and bindings\n\t\t\t// ==========================================\n\t\t\tsetIframe : function( slide ) {\n\t\t\t\tvar self         = this,\n\t\t\t\topts             = slide.opts.iframe,\n\t\t\t\t$slide           = slide.$slide,\n\t\t\t\t$iframe,\n\t\t\t\tvideoWidthHeight = '',\n\t\t\t\t/* videoWidthHeight = 'style=\"width: 1351px; height: 759.938px;\"', */\n\t\t\t\tcss_width  = false,\n\t\t\t\tcss_height = false;\n\n\t\t\t\tif ( slide.opts.arrows !== 0 && slide.opts.arrow_position == 'inside' ) {\n\t\t\t\t\t// This will be wrapper containing both ghost and actual image\n\t\t\t\t\tslide.$content = $( '<div class=\"envirabox-content' + ( opts.preload ? ' envirabox-is-hidden' : ' ' ) + ' provider-' + opts.provider + '\" ' + videoWidthHeight + '><div class=\"envirabox-navigation-inside\"><a data-envirabox-prev title=\"prev\" class=\"envirabox-arrow envirabox-arrow--left envirabox-nav envirabox-prev\" href=\"#\"><span></span></a><a data-envirabox-next title=\"next\" class=\"envirabox-arrow envirabox-arrow--right envirabox-nav envirabox-next\" href=\"#\"><span></span></a></div>' )\n\t\t\t\t\t.addClass( 'envirabox-hidden' )\n\t\t\t\t\t.addClass( 'envirabox-iframe-hidden' )\n\t\t\t\t\t.css( 'width', '640px' )\n\t\t\t\t\t.css( 'height', '360px' )\n\t\t\t\t\t.appendTo( slide.$slide );\n\t\t\t\t} else if ( opts.provider !== undefined ) { // this should be a video\n\t\t\t\t\tslide.$content = $( '<div class=\"envirabox-content' + ( opts.preload ? ' envirabox-is-hidden' : ' ' ) + ' provider-' + opts.provider + '\" ' + videoWidthHeight + '></div>' )\n\t\t\t\t\t.addClass( 'envirabox-hidden' )\n\t\t\t\t\t.addClass( 'envirabox-iframe-hidden' )\n\t\t\t\t\t.css( 'width', '640px' )\n\t\t\t\t\t.css( 'height', '360px' )\n\t\t\t\t\t.appendTo( $slide );\n\t\t\t\t} else { // anything not defined, such as a pdf\n\t\t\t\t\tslide.$content = $( '<div class=\"envirabox-content' + ( opts.preload ? ' envirabox-is-hidden' : ' ' ) + ' provider-' + opts.provider + '\" ' + videoWidthHeight + '></div>' )\n\t\t\t\t\t.css( 'width', '90%' )\n\t\t\t\t\t.css( 'height', '90%' )\n\t\t\t\t\t.appendTo( $slide );\n\t\t\t\t}\n\n\t\t\t\t$iframe = $( opts.tpl.replace( /\\{rnd\\}/g, new Date().getTime() ).replace( /\\{additionalClasses\\}/g, slide.contentProvider ) )\n\t\t\t\t.attr( opts.attr )\n\t\t\t\t.appendTo( slide.$content ).css( 'width', css_width ).css( 'height', css_height );\n\n\t\t\t\tif ( opts.preload ) {\n\n\t\t\t\t\tself.showLoading( slide );\n\n\t\t\t\t\t// Unfortunately, it is not always possible to determine if iframe is successfully loaded\n\t\t\t\t\t// (due to browser security policy)\n\t\t\t\t\t$iframe.on(\n\t\t\t\t\t\t'load.eb error.eb',\n\t\t\t\t\t\tfunction(e) {\n\n\t\t\t\t\t\t\tthis.isReady = 1;\n\n\t\t\t\t\t\t\tslide.$slide.trigger( 'refresh' );\n\n\t\t\t\t\t\t\tself.afterLoad( slide );\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\n\t\t\t\t\tvar $contents = false;\n\t\t\t\t\tvar $body     = false;\n\n\t\t\t\t\ttry {\n\t\t\t\t\t\t$contents = $iframe.contents();\n\t\t\t\t\t\t$body     = $contents.find( \"body\" );\n\t\t\t\t\t} catch (ignore) {\n\t\t\t\t\t\tconsole.log( 'Envira Debugging:' );\n\t\t\t\t\t\tconsole.log( ignore );\n\t\t\t\t\t}\n\n\t\t\t\t\t  // Calculate contnet dimensions if it is accessible\n\t\t\t\t\tif ($body && $body.length && $body.children().length) {\n\t\t\t\t\t\t$content.css(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\twidth: \"\",\n\t\t\t\t\t\t\t\theight: \"\"\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tif (frameWidth === undefined) {\n\t\t\t\t\t\t\tframeWidth = Math.ceil( Math.max( $body[0].clientWidth, $body.outerWidth( true ) ) );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (frameWidth) {\n\t\t\t\t\t\t\t$content.width( frameWidth );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (frameHeight === undefined) {\n\t\t\t\t\t\t\tframeHeight = Math.ceil( Math.max( $body[0].clientHeight, $body.outerHeight( true ) ) );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (frameHeight) {\n\t\t\t\t\t\t\t$content.height( frameHeight );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t$content.removeClass( \"envirabox-hidden\" );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis.afterLoad( slide );\n\n\t\t\t\t}\n\n\t\t\t\tif ( slide.opts.insideCap === true ) {\n\t\t\t\t\tlet caption  = slide.caption !== undefined ? slide.caption : '',\n\t\t\t\t\ttitle        = slide.title !== undefined ? slide.title : '',\n\t\t\t\t\tposition     = slide.opts.capPosition ? slide.opts.capPosition : '',\n\t\t\t\t\tcapTitleShow = slide.opts.capTitleShow ? slide.opts.capTitleShow : false,\n\t\t\t\t\titemID       = slide.enviraItemId ? slide.enviraItemId : '',\n\t\t\t\t\toutput       = capTitleShow == 'caption' ? '<div class=\"envirabox-caption ' + 'envirabox-caption-item-id-' + itemID + '\">' + caption + '</div>' : false;\n\n\t\t\t\t\toutput = capTitleShow == 'title' ? '<div class=\"envirabox-title ' + 'envirabox-title-item-id-' + itemID + '\">' + title + '</div>' : output;\n\n\t\t\t\t\tif ( output !== false && output !== undefined && output.length > 0 ) {\n\t\t\t\t\t\tslide.$content.prepend( '<div class=\"envirabox-caption-wrap ' + position + '\">' + output + '</div>' );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t$iframe.attr( 'src', slide.src );\n\n\t\t\t\tif ( slide.opts.smallBtn === true ) {\n\t\t\t\t\tslide.$content.prepend( self.translate( slide, slide.opts.btnTpl.smallBtn ) );\n\t\t\t\t}\n\n\t\t\t\t// Remove iframe if closing or changing gallery item\n\t\t\t\t$slide.one(\n\t\t\t\t\t'onReset',\n\t\t\t\t\tfunction () {\n\n\t\t\t\t\t\t// This helps IE not to throw errors when closing\n\t\t\t\t\t\ttry {\n\n\t\t\t\t\t\t\t$( this ).find( 'iframe' ).hide().attr( 'src', '//about:blank' );\n\n\t\t\t\t\t\t} catch ( ignore ) {\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t$( this ).empty();\n\n\t\t\t\t\t\tslide.isLoaded = false;\n\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t},\n\n\t\t\tsetGenericDiv : function( slide ) {\n\t\t\t\tvar self         = this,\n\t\t\t\topts             = slide.opts.genericDiv,\n\t\t\t\t$slide           = slide.$slide,\n\t\t\t\t$genericDiv,\n\t\t\t\tvideoWidthHeight = '',\n\t\t\t\t/* videoWidthHeight = 'style=\"width: 1351px; height: 759.938px;\"', */\n\t\t\t\tcss_width  = '640px',\n\t\t\t\tcss_height = '360px';\n\t\t\t\tif ( slide.opts.arrows !== 0 && slide.opts.arrow_position == 'inside' ) {\n\t\t\t\t\t// This will be wrapper containing both ghost and actual image\n\t\t\t\t\tslide.$content = $( '<div class=\"envirabox-content' + ( opts.preload ? ' envirabox-is-hidden' : ' ' ) + ' provider-' + opts.provider + '\" ' + videoWidthHeight + '><div class=\"envirabox-navigation-inside\"><a data-envirabox-prev title=\"prev\" class=\"envirabox-arrow envirabox-arrow--left envirabox-nav envirabox-prev\" href=\"#\"><span></span></a><a data-envirabox-next title=\"next\" class=\"envirabox-arrow envirabox-arrow--right envirabox-nav envirabox-next\" href=\"#\"><span></span></a></div>' )\n\t\t\t\t\t.addClass( 'envirabox-hidden' )\n\t\t\t\t\t.css( 'width', css_width )\n\t\t\t\t\t.css( 'height', css_height )\n\t\t\t\t\t.appendTo( slide.$slide );\n\t\t\t\t} else {\n\t\t\t\t\tif ( opts.provider == 'facebook' ) {\n\t\t\t\t\t\tcss_width = css_height = 'auto';\n\t\t\t\t\t}\n\t\t\t\t\tslide.$content = $( '<div class=\"envirabox-content' + ( opts.preload ? ' envirabox-is-hidden' : ' ' ) + ' provider-' + opts.provider + '\" ' + videoWidthHeight + '></div>' )\n\t\t\t\t\t.addClass( 'envirabox-hidden' )\n\t\t\t\t\t.css( 'width', css_width )\n\t\t\t\t\t.css( 'height', css_height )\n\t\t\t\t\t.appendTo( $slide );\n\t\t\t\t}\n\n\t\t\t\t$genericDiv = $( opts.tpl.replace( /\\{rnd\\}/g, new Date().getTime() ).replace( /\\{additionalClasses\\}/g, slide.contentProvider ) )\n\t\t\t\t.attr( opts.attr )\n\t\t\t\t.attr( 'data-href', slide.src )\n\t\t\t\t.appendTo( slide.$content ).css( 'width', css_width ).css( 'height', css_height );\n\n\t\t\t\tthis.afterLoad( slide );\n\n\t\t\t\tif ( slide.opts.insideCap === true ) {\n\t\t\t\t\tlet caption  = slide.caption !== undefined ? slide.caption : '',\n\t\t\t\t\ttitle        = slide.title !== undefined ? slide.title : '',\n\t\t\t\t\tposition     = slide.opts.capPosition ? slide.opts.capPosition : '',\n\t\t\t\t\tcapTitleShow = slide.opts.capTitleShow ? slide.opts.capTitleShow : false,\n\t\t\t\t\titemID       = slide.enviraItemId ? slide.enviraItemId : '',\n\t\t\t\t\toutput       = capTitleShow == 'caption' ? '<div class=\"envirabox-caption ' + 'envirabox-caption-item-id-' + itemID + '\">' + caption + '</div>' : false;\n\n\t\t\t\t\toutput = capTitleShow == 'title' ? '<div class=\"envirabox-title ' + 'envirabox-title-item-id-' + itemID + '\">' + title + '</div>' : output;\n\n\t\t\t\t\tif ( output !== false && output !== undefined && output.length > 0 ) {\n\t\t\t\t\t\tslide.$content.prepend( '<div class=\"envirabox-caption-wrap ' + position + '\">' + output + '</div>' );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// $genericDiv.attr( 'src', slide.src );\n\t\t\t\tif ( slide.opts.smallBtn === true ) {\n\t\t\t\t\tslide.$content.prepend( self.translate( slide, slide.opts.btnTpl.smallBtn ) );\n\t\t\t\t}\n\n\t\t\t\t// Remove genericDiv if closing or changing gallery item\n\t\t\t\t$slide.one(\n\t\t\t\t\t'onReset',\n\t\t\t\t\tfunction () {\n\n\t\t\t\t\t\t// This helps IE not to throw errors when closing\n\t\t\t\t\t\ttry {\n\n\t\t\t\t\t\t\t$( this ).find( 'genericDiv' ).hide().attr( 'src', '//about:blank' );\n\n\t\t\t\t\t\t} catch ( ignore ) {\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t$( this ).empty();\n\n\t\t\t\t\t\tslide.isLoaded = false;\n\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t},\n\n\t\t\t// Wrap and append content to the slide\n\t\t\t// ======================================\n\t\t\tsetContent : function ( slide, content ) {\n\n\t\t\t\tvar self = this;\n\n\t\t\t\tif ( self.isClosing ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tself.hideLoading( slide );\n\n\t\t\t\tslide.$slide.empty();\n\n\t\t\t\tif ( isQuery( content ) && content.parent().length ) {\n\n\t\t\t\t\t// If content is a jQuery object, then it will be moved to the slide.\n\t\t\t\t\t// The placeholder is created so we will know where to put it back.\n\t\t\t\t\t// If user is navigating gallery fast, then the content might be already inside envirabox\n\t\t\t\t\t// =====================================================================================\n\t\t\t\t\t// Make sure content is not already moved to envirabox\n\t\t\t\t\tcontent.parent( '.envirabox-slide--inline' ).trigger( 'onReset' );\n\n\t\t\t\t\t// Create temporary element marking original place of the content\n\t\t\t\t\tslide.$placeholder = $( '<div></div>' ).hide().insertAfter( content );\n\n\t\t\t\t\t// Make sure content is visible\n\t\t\t\t\tcontent.css( 'display', 'inline-block' );\n\n\t\t\t\t} else if ( ! slide.hasError ) {\n\n\t\t\t\t\t// If content is just a plain text, try to convert it to html\n\t\t\t\t\tif ( $.type( content ) === 'string' ) {\n\t\t\t\t\t\tcontent = $( '<div>' ).append( $.trim( content ) ).contents();\n\n\t\t\t\t\t\t// If we have text node, then add wrapping element to make vertical alignment work\n\t\t\t\t\t\tif ( content[0].nodeType === 3 ) {\n\t\t\t\t\t\t\tcontent = $( '<div>' ).html( content );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// If \"filter\" option is provided, then filter content\n\t\t\t\t\tif ( slide.opts.filter ) {\n\t\t\t\t\t\tcontent = $( '<div>' ).html( content ).find( slide.opts.filter );\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tslide.$slide.one(\n\t\t\t\t\t'onReset',\n\t\t\t\t\tfunction () {\n\n\t\t\t\t\t\t// Put content back\n\t\t\t\t\t\tif ( slide.$placeholder ) {\n\t\t\t\t\t\t\tslide.$placeholder.after( content.hide() ).remove();\n\n\t\t\t\t\t\t\tslide.$placeholder = null;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Remove custom close button\n\t\t\t\t\t\tif ( slide.$smallBtn ) {\n\t\t\t\t\t\t\tslide.$smallBtn.remove();\n\n\t\t\t\t\t\t\tslide.$smallBtn = null;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Remove content and mark slide as not loaded\n\t\t\t\t\t\tif ( ! slide.hasError ) {\n\t\t\t\t\t\t\t$( this ).empty();\n\n\t\t\t\t\t\t\tslide.isLoaded = false;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\tslide.$content = $( content ).appendTo( slide.$slide );\n\n\t\t\t\tif ( slide.opts.smallBtn && ! slide.$smallBtn ) {\n\t\t\t\t\tslide.$smallBtn = $( self.translate( slide, slide.opts.btnTpl.smallBtn ) ).appendTo( slide.$content.filter( 'div' ).first() );\n\t\t\t\t}\n\n\t\t\t\tthis.afterLoad( slide );\n\t\t\t},\n\n\t\t\t// Display error message\n\t\t\t// =====================\n\t\t\tsetError : function ( slide ) {\n\n\t\t\t\tslide.hasError = true;\n\n\t\t\t\tslide.$slide.removeClass( 'envirabox-slide--' + slide.type );\n\n\t\t\t\tthis.setContent( slide, this.translate( slide, slide.opts.errorTpl ) );\n\n\t\t\t},\n\n\t\t\t// Show loading icon inside the slide\n\t\t\t// ==================================\n\t\t\tshowLoading : function( slide ) {\n\n\t\t\t\tvar self = this;\n\n\t\t\t\tslide = slide || self.current;\n\n\t\t\t\tif ( slide && ! slide.$spinner ) {\n\t\t\t\t\tslide.$spinner = $( self.opts.spinnerTpl ).appendTo( slide.$slide );\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\t// Remove loading icon from the slide\n\t\t\t// ==================================\n\t\t\thideLoading : function( slide ) {\n\n\t\t\t\tvar self = this;\n\n\t\t\t\tslide = slide || self.current;\n\n\t\t\t\tif ( slide && slide.$spinner ) {\n\t\t\t\t\tslide.$spinner.remove();\n\n\t\t\t\t\tdelete slide.$spinner;\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\t// Adjustments after slide content has been loaded\n\t\t\t// ===============================================\n\t\t\tafterLoad : function( slide ) {\n\n\t\t\t\tvar self = this;\n\n\t\t\t\tif ( self.isClosing ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tslide.isLoading = false;\n\t\t\t\tslide.isLoaded  = true;\n\n\t\t\t\tself.trigger( 'afterLoad', slide );\n\n\t\t\t\tself.hideLoading( slide );\n\n\t\t\t\tif ( slide.opts.protect && slide.$content && ! slide.hasError ) {\n\n\t\t\t\t\t// Disable right click\n\t\t\t\t\tslide.$content.on(\n\t\t\t\t\t\t'contextmenu.eb',\n\t\t\t\t\t\tfunction( e ) {\n\t\t\t\t\t\t\tif ( e.button == 2 ) {\n\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\n\t\t\t\t\t// Add fake element on top of the image\n\t\t\t\t\t// This makes a bit harder for user to select image\n\t\t\t\t\tif ( slide.type === 'image' ) {\n\t\t\t\t\t\t$( '<div class=\"envirabox-spaceball\"></div>' ).appendTo( slide.$content );\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tself.revealContent( slide );\n\n\t\t\t},\n\n\t\t\t// Make content visible\n\t\t\t// This method is called right after content has been loaded or\n\t\t\t// user navigates gallery and transition should start\n\t\t\t// ============================================================\n\t\t\trevealContent : function( slide ) {\n\n\t\t\t\tvar self   = this;\n\t\t\t\tvar $slide = slide.$slide;\n\n\t\t\t\tvar effect, effectClassName, duration, opacity, end, start = false;\n\n\t\t\t\teffect   = slide.opts[ self.firstRun ? 'animationEffect' : 'transitionEffect' ];\n\t\t\t\tduration = slide.opts[ self.firstRun ? 'animationDuration' : 'transitionDuration' ];\n\n\t\t\t\tduration = parseInt( slide.forcedDuration === undefined ? duration : slide.forcedDuration, 10 );\n\n\t\t\t\tif ( slide.isMoved || slide.pos !== self.currPos || ! duration ) {\n\t\t\t\t\teffect = false;\n\t\t\t\t}\n\n\t\t\t\t// Check if can zoom\n\t\t\t\tif ( effect === 'zoom' && ! ( slide.pos === self.currPos && duration && slide.type === 'image' && ! slide.hasError && ( start = self.getThumbPos( slide ) ) ) ) {\n\t\t\t\t\teffect = 'fade';\n\t\t\t\t}\n\n\t\t\t\t// Zoom animation\n\t\t\t\t// ==============\n\t\t\t\tif ( effect === 'zoom' ) {\n\t\t\t\t\tend = self.getFitPos( slide );\n\n\t\t\t\t\tend.scaleX = end.width / start.width;\n\t\t\t\t\tend.scaleY = end.height / start.height;\n\n\t\t\t\t\tdelete end.width;\n\t\t\t\t\tdelete end.height;\n\n\t\t\t\t\t// Check if we need to animate opacity\n\t\t\t\t\topacity = slide.opts.zoomOpacity;\n\n\t\t\t\t\tif ( opacity == 'auto' ) {\n\t\t\t\t\t\topacity = Math.abs( slide.width / slide.height - start.width / start.height ) > 0.1;\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( opacity ) {\n\t\t\t\t\t\tstart.opacity = 0.1;\n\t\t\t\t\t\tend.opacity   = 1;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Draw image at start position\n\t\t\t\t\t$.envirabox.setTranslate( slide.$content.removeClass( 'envirabox-is-hidden' ), start );\n\n\t\t\t\t\tforceRedraw( slide.$content );\n\n\t\t\t\t\t// Start animation\n\t\t\t\t\t$.envirabox.animate(\n\t\t\t\t\t\tslide.$content,\n\t\t\t\t\t\tend,\n\t\t\t\t\t\tduration,\n\t\t\t\t\t\tfunction() {\n\t\t\t\t\t\t\tself.complete();\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tself.updateSlide( slide );\n\n\t\t\t\t// Simply show content\n\t\t\t\t// ===================\n\t\t\t\tif ( ! effect ) {\n\t\t\t\t\tforceRedraw( $slide );\n\n\t\t\t\t\tslide.$content.removeClass( 'envirabox-is-hidden' );\n\n\t\t\t\t\tif ( slide.pos === self.currPos ) {\n\t\t\t\t\t\tself.complete();\n\t\t\t\t\t}\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t$.envirabox.stop( $slide );\n\n\t\t\t\teffectClassName = 'envirabox-animated envirabox-slide--' + ( slide.pos > self.prevPos ? 'next' : 'previous' ) + ' envirabox-fx-' + effect;\n\n\t\t\t\t$slide.removeAttr( 'style' ).removeClass( 'envirabox-slide--current envirabox-slide--next envirabox-slide--previous' ).addClass( effectClassName );\n\n\t\t\t\tslide.$content.removeClass( 'envirabox-is-hidden' );\n\n\t\t\t\t// Force reflow for CSS3 transitions\n\t\t\t\tforceRedraw( $slide );\n\n\t\t\t\t$.envirabox.animate(\n\t\t\t\t\t$slide,\n\t\t\t\t\t'envirabox-slide--current',\n\t\t\t\t\tduration,\n\t\t\t\t\tfunction(e) {\n\t\t\t\t\t\t$slide.removeClass( effectClassName ).removeAttr( 'style' );\n\n\t\t\t\t\t\tif ( slide.pos === self.currPos ) {\n\t\t\t\t\t\t\tself.complete();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t},\n\t\t\t\t\ttrue\n\t\t\t\t);\n\n\t\t\t},\n\n\t\t\t// Check if we can and have to zoom from thumbnail\n\t\t\t// ================================================\n\t\t\tgetThumbPos : function( slide ) {\n\n\t\t\t\tvar self = this;\n\t\t\t\tvar rez  = false;\n\n\t\t\t\t// Check if element is inside the viewport by at least 1 pixel\n\t\t\t\tvar isElementVisible = function( $el ) {\n\t\t\t\t\tvar element = $el[0];\n\n\t\t\t\t\tvar elementRect = element.getBoundingClientRect();\n\t\t\t\t\tvar parentRects = [];\n\n\t\t\t\t\tvar visibleInAllParents;\n\n\t\t\t\t\twhile ( element.parentElement !== null ) {\n\t\t\t\t\t\tif ( $( element.parentElement ).css( 'overflow' ) === 'hidden' || $( element.parentElement ).css( 'overflow' ) === 'auto' ) {\n\t\t\t\t\t\t\tparentRects.push( element.parentElement.getBoundingClientRect() );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\telement = element.parentElement;\n\t\t\t\t\t}\n\n\t\t\t\t\tvisibleInAllParents = parentRects.every(\n\t\t\t\t\t\tfunction(parentRect){\n\t\t\t\t\t\t\tvar visiblePixelX = Math.min( elementRect.right, parentRect.right ) - Math.max( elementRect.left, parentRect.left );\n\t\t\t\t\t\t\tvar visiblePixelY = Math.min( elementRect.bottom, parentRect.bottom ) - Math.max( elementRect.top, parentRect.top );\n\n\t\t\t\t\t\t\treturn visiblePixelX > 0 && visiblePixelY > 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\n\t\t\t\t\treturn visibleInAllParents &&\n\t\t\t\t\telementRect.bottom > 0 && elementRect.right > 0 &&\n\t\t\t\t\telementRect.left < $( window ).width() && elementRect.top < $( window ).height();\n\t\t\t\t};\n\n\t\t\t\tvar $thumb   = slide.opts.$thumb;\n\t\t\t\tvar thumbPos = $thumb ? $thumb.offset() : 0;\n\t\t\t\tvar slidePos;\n\n\t\t\t\tif ( thumbPos && $thumb[0].ownerDocument === document && isElementVisible( $thumb ) ) {\n\t\t\t\t\tslidePos = self.$refs.stage.offset();\n\n\t\t\t\t\trez = {\n\t\t\t\t\t\ttop    : thumbPos.top - slidePos.top + parseFloat( $thumb.css( \"border-top-width\" ) || 0 ),\n\t\t\t\t\t\tleft   : thumbPos.left - slidePos.left + parseFloat( $thumb.css( \"border-left-width\" ) || 0 ),\n\t\t\t\t\t\twidth  : $thumb.width(),\n\t\t\t\t\t\theight : $thumb.height(),\n\t\t\t\t\t\tscaleX : 1,\n\t\t\t\t\t\tscaleY : 1\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\treturn rez;\n\t\t\t},\n\n\t\t\t// Final adjustments after current gallery item is moved to position\n\t\t\t// and it`s content is loaded\n\t\t\t// ==================================================================\n\t\t\tcomplete : function() {\n\n\t\t\t\tvar self = this;\n\n\t\t\t\tvar current = self.current;\n\t\t\t\tvar slides  = {};\n\n\t\t\t\tif ( current.isMoved || ! current.isLoaded || current.isComplete ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tcurrent.isComplete = true;\n\n\t\t\t\tcurrent.$slide.siblings().trigger( 'onReset' );\n\n\t\t\t\t// Trigger any CSS3 transiton inside the slide\n\t\t\t\tforceRedraw( current.$slide );\n\n\t\t\t\tcurrent.$slide.addClass( 'envirabox-slide--complete' );\n\n\t\t\t\t// Remove unnecessary slides\n\t\t\t\t$.each(\n\t\t\t\t\tself.slides,\n\t\t\t\t\tfunction( key, slide ) {\n\t\t\t\t\t\tif ( slide.pos >= self.currPos - 1 && slide.pos <= self.currPos + 1 ) {\n\t\t\t\t\t\t\tslides[ slide.pos ] = slide;\n\n\t\t\t\t\t\t} else if ( slide ) {\n\n\t\t\t\t\t\t\t$.envirabox.stop( slide.$slide );\n\n\t\t\t\t\t\t\tslide.$slide.off().remove();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\tself.slides = slides;\n\n\t\t\t\tself.updateCursor();\n\n\t\t\t\tself.trigger( 'afterShow' );\n\n\t\t\t\t// Try to focus on the first focusable element\n\t\t\t\tif ( $( document.activeElement ).is( '[disabled]' ) || ( current.opts.autoFocus && ! ( current.type == 'image' || current.type === 'iframe' ) ) ) {\n\t\t\t\t\tself.focus();\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\t// Preload next and previous slides\n\t\t\t// ================================\n\t\t\tpreload : function() {\n\t\t\t\tvar self = this;\n\t\t\t\tvar next, prev;\n\n\t\t\t\tif ( self.group.length < 2 ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tnext = self.slides[ self.currPos + 1 ];\n\t\t\t\tprev = self.slides[ self.currPos - 1 ];\n\n\t\t\t\tif ( next && next.type === 'image' ) {\n\t\t\t\t\tself.loadSlide( next );\n\t\t\t\t}\n\n\t\t\t\tif ( prev && prev.type === 'image' ) {\n\t\t\t\t\tself.loadSlide( prev );\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\t// Try to find and focus on the first focusable element\n\t\t\t// ====================================================\n\t\t\tfocus : function() {\n\t\t\t\tvar current = this.current;\n\t\t\t\tvar $el;\n\n\t\t\t\tif ( this.isClosing ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif ( current && current.isComplete ) {\n\n\t\t\t\t\t// Look for first input with autofocus attribute\n\t\t\t\t\t$el = current.$slide.find( 'input[autofocus]:enabled:visible:first' );\n\n\t\t\t\t\tif ( ! $el.length ) {\n\t\t\t\t\t\t$el = current.$slide.find( 'button,:input,[tabindex],a' ).filter( ':enabled:visible:first' );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t$el = $el && $el.length ? $el : this.$refs.container;\n\n\t\t\t\t$el.focus();\n\t\t\t},\n\n\t\t\t// Activates current instance - brings container to the front and enables keyboard,\n\t\t\t// notifies other instances about deactivating\n\t\t\t// =================================================================================\n\t\t\tactivate : function () {\n\t\t\t\tvar self = this;\n\n\t\t\t\t// Deactivate all instances\n\t\t\t\t$( '.envirabox-container' ).each(\n\t\t\t\t\tfunction () {\n\t\t\t\t\t\tvar instance = $( this ).data( 'envirabox' );\n\n\t\t\t\t\t\t// Skip self and closing instances\n\t\t\t\t\t\tif (instance && instance.uid !== self.uid && ! instance.isClosing) {\n\t\t\t\t\t\t\tinstance.trigger( 'onDeactivate' );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\tif ( self.current ) {\n\t\t\t\t\tif ( self.$refs.container.index() > 0 ) {\n\t\t\t\t\t\tself.$refs.container.prependTo( document.body );\n\t\t\t\t\t}\n\n\t\t\t\t\tself.updateControls();\n\t\t\t\t}\n\n\t\t\t\tself.trigger( 'onActivate' );\n\n\t\t\t\tself.addEvents();\n\n\t\t\t},\n\n\t\t\t// Start closing procedure\n\t\t\t// This will start \"zoom-out\" animation if needed and clean everything up afterwards\n\t\t\t// =================================================================================\n\t\t\tclose : function( e, d ) {\n\n\t\t\t\tvar self    = this;\n\t\t\t\tvar current = self.current;\n\n\t\t\t\tvar effect, duration;\n\t\t\t\tvar $what, opacity, start, end;\n\n\t\t\t\tvar done = function() {\n\t\t\t\t\tself.cleanUp( e );\n\t\t\t\t};\n\n\t\t\t\tif ( self.isClosing ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tself.isClosing = true;\n\n\t\t\t\t// If beforeClose callback prevents closing, make sure content is centered\n\t\t\t\tif ( self.trigger( 'beforeClose', e ) === false ) {\n\t\t\t\t\tself.isClosing = false;\n\n\t\t\t\t\trequestAFrame(\n\t\t\t\t\t\tfunction() {\n\t\t\t\t\t\t\tself.update();\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\t// Remove all events\n\t\t\t\t// If there are multiple instances, they will be set again by \"activate\" method\n\t\t\t\tself.removeEvents();\n\n\t\t\t\tif ( current.timouts ) {\n\t\t\t\t\tclearTimeout( current.timouts );\n\t\t\t\t}\n\n\t\t\t\t$what    = current.$content;\n\t\t\t\teffect   = current.opts.animationEffect;\n\t\t\t\tduration = $.isNumeric( d ) ? d : ( effect ? current.opts.animationDuration : 0 );\n\n\t\t\t\t// Remove other slides\n\t\t\t\tcurrent.$slide.off( transitionEnd ).removeClass( 'envirabox-slide--complete envirabox-slide--next envirabox-slide--previous envirabox-animated' );\n\n\t\t\t\tcurrent.$slide.siblings().trigger( 'onReset' ).remove();\n\n\t\t\t\t// Trigger animations\n\t\t\t\tif ( duration ) {\n\t\t\t\t\tself.$refs.container.removeClass( 'envirabox-is-open' ).addClass( 'envirabox-is-closing' );\n\t\t\t\t}\n\n\t\t\t\t// Clean up\n\t\t\t\tself.hideLoading( current );\n\n\t\t\t\tself.hideControls();\n\n\t\t\t\tself.updateCursor();\n\n\t\t\t\t// Check if possible to zoom-out\n\t\t\t\tif ( effect === 'zoom' && ! ( e !== true && $what && duration && current.type === 'image' && ! current.hasError && ( end = self.getThumbPos( current ) ) ) ) {\n\t\t\t\t\teffect = 'fade';\n\t\t\t\t}\n\n\t\t\t\tif ( effect === 'zoom' ) {\n\t\t\t\t\t$.envirabox.stop( $what );\n\n\t\t\t\t\tstart = $.envirabox.getTranslate( $what );\n\n\t\t\t\t\tstart.width  = start.width * start.scaleX;\n\t\t\t\t\tstart.height = start.height * start.scaleY;\n\n\t\t\t\t\t// Check if we need to animate opacity\n\t\t\t\t\topacity = current.opts.zoomOpacity;\n\n\t\t\t\t\tif ( opacity == 'auto' ) {\n\t\t\t\t\t\topacity = Math.abs( current.width / current.height - end.width / end.height ) > 0.1;\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( opacity ) {\n\t\t\t\t\t\tend.opacity = 0;\n\t\t\t\t\t}\n\n\t\t\t\t\tstart.scaleX = start.width / end.width;\n\t\t\t\t\tstart.scaleY = start.height / end.height;\n\n\t\t\t\t\tstart.width  = end.width;\n\t\t\t\t\tstart.height = end.height;\n\n\t\t\t\t\t$.envirabox.setTranslate( current.$content, start );\n\n\t\t\t\t\t$.envirabox.animate( current.$content, end, duration, done );\n\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tif ( effect && duration ) {\n\n\t\t\t\t\t// If skip animation\n\t\t\t\t\tif ( e === true ) {\n\t\t\t\t\t\tsetTimeout( done, duration );\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$.envirabox.animate( current.$slide.removeClass( 'envirabox-slide--current' ), 'envirabox-animated envirabox-slide--previous envirabox-fx-' + effect, duration, done );\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\t\t\t\t\tdone();\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\t\t\t},\n\n\t\t\t// Final adjustments after removing the instance\n\t\t\t// =============================================\n\t\t\tcleanUp : function( e ) {\n\t\t\t\tvar self = this,\n\t\t\t\tinstance;\n\n\t\t\t\tself.current.$slide.trigger( 'onReset' );\n\n\t\t\t\tself.$refs.container.empty().remove();\n\n\t\t\t\tself.trigger( 'afterClose', e );\n\n\t\t\t\t// Place back focus\n\t\t\t\tif ( self.$lastFocus && ! ! self.current.opts.backFocus ) {\n\t\t\t\t\tself.$lastFocus.focus();\n\t\t\t\t}\n\n\t\t\t\tself.current = null;\n\n\t\t\t\t// Check if there are other instances\n\t\t\t\tinstance = $.envirabox.getInstance();\n\n\t\t\t\tif ( instance ) {\n\t\t\t\t\tinstance.activate();\n\n\t\t\t\t} else {\n\t\t\t\t\t$W.scrollTop( self.scrollTop ).scrollLeft( self.scrollLeft );\n\n\t\t\t\t\t$( 'html' ).removeClass( 'envirabox-enabled' );\n\n\t\t\t\t\t$( '#envirabox-style-noscroll' ).remove();\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\t// Call callback and trigger an event\n\t\t\t// ==================================\n\t\t\ttrigger : function( name, slide ) {\n\t\t\t\tvar args = Array.prototype.slice.call( arguments, 1 ),\n\t\t\t\tself     = this,\n\t\t\t\tobj      = slide && slide.opts ? slide : self.current,\n\t\t\t\trez;\n\n\t\t\t\tif ( obj ) {\n\t\t\t\t\targs.unshift( obj );\n\n\t\t\t\t} else {\n\t\t\t\t\tobj = self;\n\t\t\t\t}\n\n\t\t\t\targs.unshift( self );\n\n\t\t\t\tif ( $.isFunction( obj.opts[ name ] ) ) {\n\t\t\t\t\trez = obj.opts[ name ].apply( obj, args );\n\t\t\t\t}\n\n\t\t\t\tif ( rez === false ) {\n\t\t\t\t\treturn rez;\n\t\t\t\t}\n\n\t\t\t\tif ( name === 'afterClose' ) {\n\t\t\t\t\t$D.trigger( name + '.eb', args );\n\n\t\t\t\t} else {\n\t\t\t\t\tself.$refs.container.trigger( name + '.eb', args );\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\t// Update infobar values, navigation button states and reveal caption\n\t\t\t// ==================================================================\n\t\t\tupdateControls : function ( force ) {\n\n\t\t\t\tvar self = this,\n\t\t\t\tcurrent  = self.current,\n\t\t\t\tindex    = current.index,\n\t\t\t\topts     = current.opts,\n\t\t\t\tcaption  = opts.caption,\n\t\t\t\ttitle    = opts.title,\n\t\t\t\t$caption = self.$refs.caption,\n\t\t\t\t$title   = self.$refs.title;\n\n\t\t\t\t// Recalculate content dimensions\n\t\t\t\tcurrent.$slide.trigger( 'refresh' );\n\n\t\t\t\tself.$caption = caption && caption.length ? $caption.html( caption ) : null;\n\t\t\t\tself.$title   = title && title.length ? $title.html( title ) : null;\n\n\t\t\t\tif ( ! self.isHiddenControls ) {\n\t\t\t\t\tself.showControls();\n\t\t\t\t}\n\n\t\t\t\t// Update info and navigation elements\n\t\t\t\t$( '[data-envirabox-count]' ).html( self.group.length );\n\t\t\t\t$( '[data-envirabox-index]' ).html( index + 1 );\n\n\t\t\t\t$( '[data-envirabox-prev]' ).prop( 'disabled', ( ! opts.loop && index <= 0 ) );\n\t\t\t\t$( '[data-envirabox-next]' ).prop( 'disabled', ( ! opts.loop && index >= self.group.length - 1 ) );\n\n\t\t\t},\n\n\t\t\t// Hide toolbar and caption\n\t\t\t// ========================\n\t\t\thideControls : function () {\n\n\t\t\t\tthis.isHiddenControls = true;\n\n\t\t\t\tthis.$refs.container.removeClass( 'envirabox-show-infobar envirabox-show-toolbar envirabox-show-caption envirabox-show-title envirabox-show-nav' );\n\n\t\t\t},\n\n\t\t\tshowControls : function() {\n\n\t\t\t\tvar self   = this,\n\t\t\t\topts       = self.current ? self.current.opts : self.opts,\n\t\t\t\t$container = self.$refs.container;\n\n\t\t\t\tself.isHiddenControls   = false;\n\t\t\t\tself.idleSecondsCounter = 0;\n\n\t\t\t\t$container\n\t\t\t\t.toggleClass( 'envirabox-show-toolbar', ! ! ( opts.toolbar && opts.buttons ) )\n\t\t\t\t.toggleClass( 'envirabox-show-infobar', ! ! ( opts.infobar && self.group.length > 1 ) )\n\t\t\t\t.toggleClass( 'envirabox-show-nav', ! ! ( opts.arrows && self.group.length > 1 ) )\n\t\t\t\t.toggleClass( 'envirabox-is-modal', ! ! opts.modal );\n\n\t\t\t\tif ( self.$caption ) {\n\t\t\t\t\t$container.addClass( 'envirabox-show-caption ' );\n\t\t\t\t} else {\n\t\t\t\t\t$container.removeClass( 'envirabox-show-caption' );\n\t\t\t\t}\n\n\t\t\t\tif ( self.$title ) {\n\t\t\t\t\t$container.addClass( 'envirabox-show-title ' );\n\t\t\t\t} else {\n\t\t\t\t\t$container.removeClass( 'envirabox-show-title' );\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\t// Toggle toolbar and caption\n\t\t\t// ==========================\n\t\t\ttoggleControls : function() {\n\n\t\t\t\tif ( this.isHiddenControls ) {\n\t\t\t\t\tthis.showControls();\n\n\t\t\t\t} else {\n\t\t\t\t\tthis.hideControls();\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t}\n\t);\n\n\t$.envirabox = {\n\n\t\tversion  : \"{envirabox-version}\",\n\t\tdefaults : defaults,\n\n\t\t// Get current instance and execute a command.\n\t\t//\n\t\t// Examples of usage:\n\t\t//\n\t\t// $instance = $.envirabox.getInstance();\n\t\t// $.envirabox.getInstance().jumpTo( 1 );\n\t\t// $.envirabox.getInstance( 'jumpTo', 1 );\n\t\t// $.envirabox.getInstance( function() {\n\t\t// console.info( this.currIndex );\n\t\t// });\n\t\t// ======================================================\n\t\tgetInstance : function ( command ) {\n\t\t\tvar instance = $( '.envirabox-container:not(\".envirabox-is-closing\"):first' ).data( 'envirabox' );\n\t\t\tvar args     = Array.prototype.slice.call( arguments, 1 );\n\n\t\t\tif ( instance instanceof EnviraBox ) {\n\n\t\t\t\tif ( $.type( command ) === 'string' ) {\n\t\t\t\t\tinstance[ command ].apply( instance, args );\n\n\t\t\t\t} else if ( $.type( command ) === 'function' ) {\n\t\t\t\t\tcommand.apply( instance, args );\n\n\t\t\t\t}\n\n\t\t\t\treturn instance;\n\t\t\t}\n\n\t\t\treturn false;\n\n\t\t},\n\n\t\t// Create new instance\n\t\t// ===================\n\t\topen : function ( items, opts, index ) {\n\n\t\t\tvar instance = this.getInstance();\n\t\t\tif ( instance ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\treturn new EnviraBox( items, opts, index );\n\t\t},\n\n\t\t// Close current or all instances\n\t\t// ==============================\n\t\tclose : function ( all ) {\n\t\t\tvar instance = this.getInstance();\n\n\t\t\tif ( instance ) {\n\t\t\t\tinstance.close();\n\n\t\t\t\t// Try to find and close next instance\n\t\t\t\tif ( all === true ) {\n\t\t\t\t\tthis.close();\n\t\t\t\t}\n\t\t\t}\n\n\t\t},\n\n\t\t// Close instances and unbind all events\n\t\t// ==============================\n\t\tdestroy : function() {\n\n\t\t\tthis.close( true );\n\n\t\t\t$D.off( 'click.eb-start' );\n\n\t\t},\n\n\t\t// Try to detect mobile devices\n\t\t// ============================\n\t\tisMobile : document.createTouch !== undefined && /Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test( navigator.userAgent ),\n\n\t\t// Detect if 'translate3d' support is available\n\t\t// ============================================\n\t\tuse3d : (function() {\n\t\t\tvar div = document.createElement( 'div' );\n\n\t\t\treturn window.getComputedStyle && window.getComputedStyle( div ).getPropertyValue( 'transform' ) && ! (document.documentMode && document.documentMode < 11);\n\t\t}()),\n\n\t\t// Helper function to get current visual state of an element\n\t\t// returns array[ top, left, horizontal-scale, vertical-scale, opacity ]\n\t\t// =====================================================================\n\tgetTranslate : function( $el ) {\n\t\tvar matrix;\n\n\t\tif ( ! $el || ! $el.length ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tmatrix = $el.eq( 0 ).css( 'transform' );\n\n\t\tif ( matrix && matrix.indexOf( 'matrix' ) !== -1 ) {\n\t\t\tmatrix = matrix.split( '(' )[1];\n\t\t\tmatrix = matrix.split( ')' )[0];\n\t\t\tmatrix = matrix.split( ',' );\n\t\t} else {\n\t\t\tmatrix = [];\n\t\t}\n\n\t\tif ( matrix.length ) {\n\n\t\t\t// If IE\n\t\t\tif ( matrix.length > 10 ) {\n\t\t\t\tmatrix = [ matrix[13], matrix[12], matrix[0], matrix[5] ];\n\n\t\t\t} else {\n\t\t\t\tmatrix = [ matrix[5], matrix[4], matrix[0], matrix[3]];\n\t\t\t}\n\n\t\t\tmatrix = matrix.map( parseFloat );\n\n\t\t} else {\n\t\t\tmatrix = [ 0, 0, 1, 1 ];\n\n\t\t\tvar transRegex = /\\.*translate\\((.*)px,(.*)px\\)/i;\n\t\t\tvar transRez   = transRegex.exec( $el.eq( 0 ).attr( 'style' ) );\n\n\t\t\tif ( transRez ) {\n\t\t\t\tmatrix[ 0 ] = parseFloat( transRez[2] );\n\t\t\t\tmatrix[ 1 ] = parseFloat( transRez[1] );\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\ttop     : matrix[ 0 ],\n\t\t\tleft    : matrix[ 1 ],\n\t\t\tscaleX  : matrix[ 2 ],\n\t\t\tscaleY  : matrix[ 3 ],\n\t\t\topacity : parseFloat( $el.css( 'opacity' ) ),\n\t\t\twidth   : $el.width(),\n\t\t\theight  : $el.height()\n\t\t};\n\n\t},\n\n\t\t// Shortcut for setting \"translate3d\" properties for element\n\t\t// Can set be used to set opacity, too\n\t\t// ========================================================\n\t\tsetTranslate : function( $el, props ) {\n\t\t\tvar str = '';\n\t\t\tvar css = {};\n\n\t\t\tif ( ! $el || ! props ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ( props.left !== undefined || props.top !== undefined ) {\n\t\t\t\tstr = ( props.left === undefined ? $el.position().left : props.left ) + 'px, ' + ( props.top === undefined ? $el.position().top : props.top ) + 'px';\n\n\t\t\t\tif ( this.use3d ) {\n\t\t\t\t\tstr = 'translate3d(' + str + ', 0px)';\n\n\t\t\t\t} else {\n\t\t\t\t\tstr = 'translate(' + str + ')';\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ( props.scaleX !== undefined && props.scaleY !== undefined ) {\n\t\t\t\tstr = (str.length ? str + ' ' : '') + 'scale(' + props.scaleX + ', ' + props.scaleY + ')';\n\t\t\t}\n\n\t\t\tif ( str.length ) {\n\t\t\t\tcss.transform = str;\n\t\t\t}\n\n\t\t\tif ( props.opacity !== undefined ) {\n\t\t\t\tcss.opacity = props.opacity;\n\t\t\t}\n\n\t\t\tif ( props.width !== undefined ) {\n\t\t\t\tcss.width = props.width;\n\t\t\t}\n\n\t\t\tif ( props.height !== undefined ) {\n\t\t\t\tcss.height = props.height;\n\t\t\t}\n\n\t\t\treturn $el.css( css );\n\t\t},\n\n\t\t// Simple CSS transition handler\n\t\t// =============================\n\t\tanimate : function ( $el, to, duration, callback, leaveAnimationName ) {\n\t\t\tvar event = transitionEnd || 'transitionend';\n\n\t\t\tif ( $.isFunction( duration ) ) {\n\t\t\t\tcallback = duration;\n\t\t\t\tduration = null;\n\t\t\t}\n\n\t\t\tif ( ! $.isPlainObject( to ) ) {\n\t\t\t\t$el.removeAttr( 'style' );\n\t\t\t}\n\n\t\t\t$el.on(\n\t\t\t\tevent,\n\t\t\t\tfunction(e) {\n\n\t\t\t\t\t// Skip events from child elements and z-index change\n\t\t\t\t\tif ( e && e.originalEvent && ( ! $el.is( e.originalEvent.target ) || e.originalEvent.propertyName == 'z-index' ) ) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t$el.off( event );\n\n\t\t\t\t\tif ( $.isPlainObject( to ) ) {\n\n\t\t\t\t\t\tif ( to.scaleX !== undefined && to.scaleY !== undefined ) {\n\t\t\t\t\t\t\t$el.css( 'transition-duration', '0ms' );\n\n\t\t\t\t\t\t\tto.width  = Math.round( $el.width() * to.scaleX );\n\t\t\t\t\t\t\tto.height = Math.round( $el.height() * to.scaleY );\n\n\t\t\t\t\t\t\tto.scaleX = 1;\n\t\t\t\t\t\t\tto.scaleY = 1;\n\n\t\t\t\t\t\t\t$.envirabox.setTranslate( $el, to );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else if ( leaveAnimationName !== true ) {\n\t\t\t\t\t\t$el.removeClass( to );\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( $.isFunction( callback ) ) {\n\t\t\t\t\t\tcallback( e );\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tif ( $.isNumeric( duration ) ) {\n\t\t\t\t$el.css( 'transition-duration', duration + 'ms' );\n\t\t\t}\n\n\t\t\tif ( $.isPlainObject( to ) ) {\n\t\t\t\t$.envirabox.setTranslate( $el, to );\n\n\t\t\t} else {\n\t\t\t\t$el.addClass( to );\n\t\t\t}\n\n\t\t\t$el.data(\n\t\t\t\t\"timer\",\n\t\t\t\tsetTimeout(\n\t\t\t\t\tfunction() {\n\t\t\t\t\t\t$el.trigger( 'transitionend' );\n\t\t\t\t\t},\n\t\t\t\t\tduration + 16\n\t\t\t\t)\n\t\t\t);\n\n\t\t},\n\n\t\tstop : function( $el ) {\n\t\t\tclearTimeout( $el.data( \"timer\" ) );\n\n\t\t\t$el.off( transitionEnd );\n\t\t}\n\n\t};\n\n\t// Default click handler for \"enviraboxed\" links\n\t// ============================================\n\tfunction _run( e ) {\n\n\t\tvar target = e.currentTarget,\n\t\t\topts   = e.data ? e.data.options : {},\n\t\t\titems  = opts.selector ? $( opts.selector ) : ( e.data ? e.data.items : [] ),\n\t\t\tvalue  = $( target ).attr( 'data-envirabox' ) || '',\n\t\t\tindex  = 0,\n\t\t\tactive = $.envirabox.getInstance();\n\n\t\te.preventDefault();\n\n\t\t// Avoid opening multiple times\n\t\tif ( active && active.current.opts.$orig.is( target ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Get all related items and find index for clicked one\n\t\tif ( value ) {\n\t\t\titems = items.length ? items.filter( '[data-envirabox=\"' + value + '\"]' ) : $( '[data-envirabox=\"' + value + '\"]' );\n\t\t\tindex = items.index( target );\n\n\t\t\t// Sometimes current item can not be found\n\t\t\t// (for example, when slider clones items)\n\t\t\tif ( index < 0 ) {\n\t\t\t\tindex = 0;\n\t\t\t}\n\n\t\t} else {\n\t\t\titems = [ target ];\n\t\t}\n\n\t\t$.envirabox.open( items, opts, index );\n\t}\n\n\t// Create a jQuery plugin\n\t// ======================\n\t$.fn.envirabox = function (options) {\n\n\t\tvar selector;\n\n\t\toptions  = options || {};\n\t\tselector = options.selector || false;\n\n\t\tif ( selector ) {\n\n\t\t\t$( 'body' ).off( 'click.eb-start', selector ).on(\n\t\t\t\t'click.eb-start',\n\t\t\t\tselector,\n\t\t\t\t{\n\t\t\t\t\toptions : options\n\t\t\t\t},\n\t\t\t\t_run\n\t\t\t);\n\n\t\t} else {\n\n\t\t\tthis.off( 'click.eb-start' ).on(\n\t\t\t\t'click.eb-start',\n\t\t\t\t{\n\t\t\t\t\titems   : this,\n\t\t\t\t\toptions : options\n\t\t\t\t},\n\t\t\t\t_run\n\t\t\t);\n\n\t\t}\n\n\t\treturn this;\n\t};\n\n}( window, document, window.jQuery || jQuery ));\n","/**\n * Isotope Item\n **/\n\n( function( window, factory ) {\n\t// universal module definition\n\t/* jshint strict: false */ /*globals define, module, require */\n\tif ( typeof define == 'function' && define.amd ) {\n\t\t// AMD\n\t\tdefine(\n\t\t\t[\n\t\t\t'outlayer/outlayer'\n\t\t\t],\n\t\t\tfactory\n\t\t);\n\t} else if ( typeof module == 'object' && module.exports ) {\n\t\t// CommonJS\n\t\tmodule.exports = factory(\n\t\t\trequire( 'outlayer' )\n\t\t);\n\t} else {\n\t\t// browser global\n\t\twindow.Isotope      = window.Isotope || {};\n\t\twindow.Isotope.Item = factory(\n\t\t\twindow.Outlayer\n\t\t);\n\t}\n\n}( window, function factory( Outlayer ) {\n\t'use strict';\n\n\t// -------------------------- Item -------------------------- //\n\t// sub-class Outlayer Item\n\tfunction Item() {\n\t\tOutlayer.Item.apply( this, arguments );\n\t}\n\n\tvar proto = Item.prototype = Object.create( Outlayer.Item.prototype );\n\n\tvar _create   = proto._create;\n\tproto._create = function() {\n\t\t// assign id, used for original-order sorting\n\t\tthis.id = this.layout.itemGUID++;\n\t\t_create.call( this );\n\t\tthis.sortData = {};\n\t};\n\n\tproto.updateSortData = function() {\n\t\tif ( this.isIgnored ) {\n\t\t\treturn;\n\t\t}\n\t\t// default sorters\n\t\tthis.sortData.id = this.id;\n\t\t// for backward compatibility\n\t\tthis.sortData['original-order'] = this.id;\n\t\tthis.sortData.random            = Math.random();\n\t\t// go thru getSortData obj and apply the sorters\n\t\tvar getSortData = this.layout.options.getSortData;\n\t\tvar sorters     = this.layout._sorters;\n\t\tfor ( var key in getSortData ) {\n\t\t\tvar sorter           = sorters[ key ];\n\t\t\tthis.sortData[ key ] = sorter( this.element, this );\n\t\t}\n\t};\n\n\tvar _destroy  = proto.destroy;\n\tproto.destroy = function() {\n\t\t// call super\n\t\t_destroy.apply( this, arguments );\n\t\t// reset display, #741\n\t\tthis.css(\n\t\t\t{\n\t\t\t\tdisplay: ''\n\t\t\t}\n\t\t);\n\t};\n\n\treturn Item;\n\n}));\n","/**\n * enviraImagesLoaded PACKAGED v4.1.0\n * JavaScript is all like \"You images are done yet or what?\"\n * MIT License\n */\n\n/**\n * EvEmitter v1.0.1\n * Lil' event emitter\n * MIT License\n */\n\n/* jshint unused: true, undef: true, strict: true */\n\n( function( global, factory ) {\n  // universal module definition\n  /* jshint strict: false */ /* globals define, module */\n  if ( typeof define == 'function' && define.amd ) {\n    // AMD - RequireJS\n    define( 'ev-emitter/ev-emitter',factory );\n  } else if ( typeof module == 'object' && module.exports ) {\n    // CommonJS - Browserify, Webpack\n    module.exports = factory();\n  } else {\n    // Browser globals\n    global.EvEmitter = factory();\n  }\n\n}( this, function() {\n\n\n\nfunction EvEmitter() {}\n\nvar proto = EvEmitter.prototype;\n\nproto.on = function( eventName, listener ) {\n  if ( !eventName || !listener ) {\n    return;\n  }\n  // set events hash\n  var events = this._events = this._events || {};\n  // set listeners array\n  var listeners = events[ eventName ] = events[ eventName ] || [];\n  // only add once\n  if ( listeners.indexOf( listener ) == -1 ) {\n    listeners.push( listener );\n  }\n\n  return this;\n};\n\nproto.once = function( eventName, listener ) {\n  if ( !eventName || !listener ) {\n    return;\n  }\n  // add event\n  this.on( eventName, listener );\n  // set once flag\n  // set onceEvents hash\n  var onceEvents = this._onceEvents = this._onceEvents || {};\n  // set onceListeners array\n  var onceListeners = onceEvents[ eventName ] = onceEvents[ eventName ] || [];\n  // set flag\n  onceListeners[ listener ] = true;\n\n  return this;\n};\n\nproto.off = function( eventName, listener ) {\n  var listeners = this._events && this._events[ eventName ];\n  if ( !listeners || !listeners.length ) {\n    return;\n  }\n  var index = listeners.indexOf( listener );\n  if ( index != -1 ) {\n    listeners.splice( index, 1 );\n  }\n\n  return this;\n};\n\nproto.emitEvent = function( eventName, args ) {\n  var listeners = this._events && this._events[ eventName ];\n  if ( !listeners || !listeners.length ) {\n    return;\n  }\n  var i = 0;\n  var listener = listeners[i];\n  args = args || [];\n  // once stuff\n  var onceListeners = this._onceEvents && this._onceEvents[ eventName ];\n\n  while ( listener ) {\n    var isOnce = onceListeners && onceListeners[ listener ];\n    if ( isOnce ) {\n      // remove listener\n      // remove before trigger to prevent recursion\n      this.off( eventName, listener );\n      // unset once flag\n      delete onceListeners[ listener ];\n    }\n    // trigger listener\n    listener.apply( this, args );\n    // get next listener\n    i += isOnce ? 0 : 1;\n    listener = listeners[i];\n  }\n\n  return this;\n};\n\nreturn EvEmitter;\n\n}));\n\n/*!\n * enviraImagesLoaded v4.1.0\n * JavaScript is all like \"You images are done yet or what?\"\n * MIT License\n */\n\n( function( window, factory ) { 'use strict';\n  // universal module definition\n\n  /*global define: false, module: false, require: false */\n\n  if ( typeof define == 'function' && define.amd ) {\n    // AMD\n    define( [\n      'ev-emitter/ev-emitter'\n    ], function( EvEmitter ) {\n      return factory( window, EvEmitter );\n    });\n  } else if ( typeof module == 'object' && module.exports ) {\n    // CommonJS\n    module.exports = factory(\n      window,\n      require('ev-emitter')\n    );\n  } else {\n    // browser global\n    window.enviraImagesLoaded = factory(\n      window,\n      window.EvEmitter\n    );\n  }\n\n})( window,\n\n// --------------------------  factory -------------------------- //\n\nfunction factory( window, EvEmitter ) {\n\n\n\nvar $ = window.jQuery;\nvar console = window.console;\n\n// -------------------------- helpers -------------------------- //\n\n// extend objects\nfunction extend( a, b ) {\n  for ( var prop in b ) {\n    a[ prop ] = b[ prop ];\n  }\n  return a;\n}\n\n// turn element or nodeList into an array\nfunction makeArray( obj ) {\n  var ary = [];\n  if ( Array.isArray( obj ) ) {\n    // use object if already an array\n    ary = obj;\n  } else if ( typeof obj.length == 'number' ) {\n    // convert nodeList to array\n    for ( var i=0; i < obj.length; i++ ) {\n      ary.push( obj[i] );\n    }\n  } else {\n    // array of single index\n    ary.push( obj );\n  }\n  return ary;\n}\n\n// -------------------------- enviraImagesLoaded -------------------------- //\n\n/**\n * @param {Array, Element, NodeList, String} elem\n * @param {Object or Function} options - if function, use as callback\n * @param {Function} onAlways - callback function\n */\nfunction EnviraImagesLoaded( elem, options, onAlways ) {\n  // coerce EnviraImagesLoaded() without new, to be new EnviraImagesLoaded()\n  if ( !( this instanceof EnviraImagesLoaded ) ) {\n    return new EnviraImagesLoaded( elem, options, onAlways );\n  }\n  // use elem as selector string\n  if ( typeof elem == 'string' ) {\n    elem = document.querySelectorAll( elem );\n  }\n\n  this.elements = makeArray( elem );\n  this.options = extend( {}, this.options );\n\n  if ( typeof options == 'function' ) {\n    onAlways = options;\n  } else {\n    extend( this.options, options );\n  }\n\n  if ( onAlways ) {\n    this.on( 'always', onAlways );\n  }\n\n  this.getImages();\n\n  if ( $ ) {\n    // add jQuery Deferred object\n    this.jqDeferred = new $.Deferred();\n  }\n\n  // HACK check async to allow time to bind listeners\n  setTimeout( function() {\n    this.check();\n  }.bind( this ));\n}\n\nEnviraImagesLoaded.prototype = Object.create( EvEmitter.prototype );\n\nEnviraImagesLoaded.prototype.options = {};\n\nEnviraImagesLoaded.prototype.getImages = function() {\n  this.images = [];\n\n  // filter & find items if we have an item selector\n  this.elements.forEach( this.addElementImages, this );\n};\n\n/**\n * @param {Node} element\n */\nEnviraImagesLoaded.prototype.addElementImages = function( elem ) {\n  // filter siblings\n  if ( elem.nodeName == 'IMG' ) {\n    this.addImage( elem );\n  }\n  // get background image on element\n  if ( this.options.background === true ) {\n    this.addElementBackgroundImages( elem );\n  }\n\n  // find children\n  // no non-element nodes, #143\n  var nodeType = elem.nodeType;\n  if ( !nodeType || !elementNodeTypes[ nodeType ] ) {\n    return;\n  }\n  var childImgs = elem.querySelectorAll('img');\n  // concat childElems to filterFound array\n  for ( var i=0; i < childImgs.length; i++ ) {\n    var img = childImgs[i];\n    this.addImage( img );\n  }\n\n  // get child background images\n  if ( typeof this.options.background == 'string' ) {\n    var children = elem.querySelectorAll( this.options.background );\n    for ( i=0; i < children.length; i++ ) {\n      var child = children[i];\n      this.addElementBackgroundImages( child );\n    }\n  }\n};\n\nvar elementNodeTypes = {\n  1: true,\n  9: true,\n  11: true\n};\n\nEnviraImagesLoaded.prototype.addElementBackgroundImages = function( elem ) {\n  var style = getComputedStyle( elem );\n  if ( !style ) {\n    // Firefox returns null if in a hidden iframe https://bugzil.la/548397\n    return;\n  }\n  // get url inside url(\"...\")\n  var reURL = /url\\((['\"])?(.*?)\\1\\)/gi;\n  var matches = reURL.exec( style.backgroundImage );\n  while ( matches !== null ) {\n    var url = matches && matches[2];\n    if ( url ) {\n      this.addBackground( url, elem );\n    }\n    matches = reURL.exec( style.backgroundImage );\n  }\n};\n\n/**\n * @param {Image} img\n */\nEnviraImagesLoaded.prototype.addImage = function( img ) {\n  var loadingImage = new LoadingImage( img );\n  this.images.push( loadingImage );\n};\n\nEnviraImagesLoaded.prototype.addBackground = function( url, elem ) {\n  var background = new Background( url, elem );\n  this.images.push( background );\n};\n\nEnviraImagesLoaded.prototype.check = function() {\n  var _this = this;\n  this.progressedCount = 0;\n  this.hasAnyBroken = false;\n  // complete if no images\n  if ( !this.images.length ) {\n    this.complete();\n    return;\n  }\n\n  function onProgress( image, elem, message ) {\n    // HACK - Chrome triggers event before object properties have changed. #83\n    setTimeout( function() {\n      _this.progress( image, elem, message );\n    });\n  }\n\n  this.images.forEach( function( loadingImage ) {\n    loadingImage.once( 'progress', onProgress );\n    loadingImage.check();\n  });\n};\n\nEnviraImagesLoaded.prototype.progress = function( image, elem, message ) {\n  this.progressedCount++;\n  this.hasAnyBroken = this.hasAnyBroken || !image.isLoaded;\n  // progress event\n  this.emitEvent( 'progress', [ this, image, elem ] );\n  if ( this.jqDeferred && this.jqDeferred.notify ) {\n    this.jqDeferred.notify( this, image );\n  }\n  // check if completed\n  if ( this.progressedCount == this.images.length ) {\n    this.complete();\n  }\n\n  if ( this.options.debug && console ) {\n    console.log( 'progress: ' + message, image, elem );\n  }\n};\n\nEnviraImagesLoaded.prototype.complete = function() {\n  var eventName = this.hasAnyBroken ? 'fail' : 'done';\n  this.isComplete = true;\n  this.emitEvent( eventName, [ this ] );\n  this.emitEvent( 'always', [ this ] );\n  if ( this.jqDeferred ) {\n    var jqMethod = this.hasAnyBroken ? 'reject' : 'resolve';\n    this.jqDeferred[ jqMethod ]( this );\n  }\n};\n\n// --------------------------  -------------------------- //\n\nfunction LoadingImage( img ) {\n  this.img = img;\n}\n\nLoadingImage.prototype = Object.create( EvEmitter.prototype );\n\nLoadingImage.prototype.check = function() {\n  // If complete is true and browser supports natural sizes,\n  // try to check for image status manually.\n  var isComplete = this.getIsImageComplete();\n  if ( isComplete ) {\n    // report based on naturalWidth\n    this.confirm( this.img.naturalWidth !== 0, 'naturalWidth' );\n    return;\n  }\n\n  // If none of the checks above matched, simulate loading on detached element.\n  this.proxyImage = new Image();\n  this.proxyImage.addEventListener( 'load', this );\n  this.proxyImage.addEventListener( 'error', this );\n  // bind to image as well for Firefox. #191\n  this.img.addEventListener( 'load', this );\n  this.img.addEventListener( 'error', this );\n  this.proxyImage.src = this.img.pendingSrc || this.img.currentSrc || this.img.src;\n};\n\nLoadingImage.prototype.getIsImageComplete = function() {\n  return this.img.complete && this.img.naturalWidth !== undefined;\n};\n\nLoadingImage.prototype.confirm = function( isLoaded, message ) {\n  this.isLoaded = isLoaded;\n  this.emitEvent( 'progress', [ this, this.img, message ] );\n};\n\n// ----- events ----- //\n\n// trigger specified handler for event type\nLoadingImage.prototype.handleEvent = function( event ) {\n  var method = 'on' + event.type;\n  if ( this[ method ] ) {\n    this[ method ]( event );\n  }\n};\n\nLoadingImage.prototype.onload = function() {\n  this.confirm( true, 'onload' );\n  this.unbindEvents();\n};\n\nLoadingImage.prototype.onerror = function() {\n  this.confirm( false, 'onerror' );\n  this.unbindEvents();\n};\n\nLoadingImage.prototype.unbindEvents = function() {\n  this.proxyImage.removeEventListener( 'load', this );\n  this.proxyImage.removeEventListener( 'error', this );\n  this.img.removeEventListener( 'load', this );\n  this.img.removeEventListener( 'error', this );\n};\n\n// -------------------------- Background -------------------------- //\n\nfunction Background( url, element ) {\n  this.url = url;\n  this.element = element;\n  this.img = new Image();\n}\n\n// inherit LoadingImage prototype\nBackground.prototype = Object.create( LoadingImage.prototype );\n\nBackground.prototype.check = function() {\n  this.img.addEventListener( 'load', this );\n  this.img.addEventListener( 'error', this );\n  this.img.src = this.url;\n  // check if image is already complete\n  var isComplete = this.getIsImageComplete();\n  if ( isComplete ) {\n    this.confirm( this.img.naturalWidth !== 0, 'naturalWidth' );\n    this.unbindEvents();\n  }\n};\n\nBackground.prototype.unbindEvents = function() {\n  this.img.removeEventListener( 'load', this );\n  this.img.removeEventListener( 'error', this );\n};\n\nBackground.prototype.confirm = function( isLoaded, message ) {\n  this.isLoaded = isLoaded;\n  this.emitEvent( 'progress', [ this, this.element, message ] );\n};\n\n// -------------------------- jQuery -------------------------- //\n\nEnviraImagesLoaded.makeJQueryPlugin = function( jQuery ) {\n  jQuery = jQuery || window.jQuery;\n  if ( !jQuery ) {\n    return;\n  }\n  // set local variable\n  $ = jQuery;\n  // $().enviraImagesLoaded()\n  $.fn.enviraImagesLoaded = function( options, callback ) {\n    var instance = new EnviraImagesLoaded( this, options, callback );\n    return instance.jqDeferred.promise( $(this) );\n  };\n};\n// try making plugin\nEnviraImagesLoaded.makeJQueryPlugin();\n\n// --------------------------  -------------------------- //\n\nreturn EnviraImagesLoaded;\n\n});\n","/*!\n * Enviratope PACKAGED v3.0.0\n *\n * Licensed GPLv3 for open source use\n * or Enviratope Commercial License for commercial use\n *\n * http://enviratope.metafizzy.co\n * Copyright 2016 Metafizzy\n */\n\n/**\n * Bridget makes jQuery widgets\n * v2.0.0\n * MIT license\n */\n\n/* jshint browser: true, strict: true, undef: true, unused: true */\n\n( function( window, factory ) {\n  'use strict';\n  /* globals define: false, module: false, require: false */\n\n  if ( typeof define == 'function' && define.amd ) {\n    // AMD\n    define( 'jquery-bridget/jquery-bridget',[ 'jquery' ], function( jQuery ) {\n      factory( window, jQuery );\n    });\n  } else if ( typeof module == 'object' && module.exports ) {\n    // CommonJS\n    module.exports = factory(\n      window,\n      require('jquery')\n    );\n  } else {\n    // browser global\n    window.jQueryBridget = factory(\n      window,\n      window.jQuery\n    );\n  }\n\n}( window, function factory( window, jQuery ) {\n'use strict';\n\n// ----- utils ----- //\n\nvar arraySlice = Array.prototype.slice;\n\n// helper function for logging errors\n// $.error breaks jQuery chaining\nvar console = window.console;\nvar logError = typeof console == 'undefined' ? function() {} :\n  function( message ) {\n    console.error( message );\n  };\n\n// ----- jQueryBridget ----- //\n\nfunction jQueryBridget( namespace, PluginClass, $ ) {\n  $ = $ || jQuery || window.jQuery;\n  if ( !$ ) {\n    return;\n  }\n\n  // add option method -> $().plugin('option', {...})\n  if ( !PluginClass.prototype.option ) {\n    // option setter\n    PluginClass.prototype.option = function( opts ) {\n      // bail out if not an object\n      if ( !$.isPlainObject( opts ) ){\n        return;\n      }\n      this.options = $.extend( true, this.options, opts );\n    };\n  }\n\n  // make jQuery plugin\n  $.fn[ namespace ] = function( arg0 /*, arg1 */ ) {\n    if ( typeof arg0 == 'string' ) {\n      // method call $().plugin( 'methodName', { options } )\n      // shift arguments by 1\n      var args = arraySlice.call( arguments, 1 );\n      return methodCall( this, arg0, args );\n    }\n    // just $().plugin({ options })\n    plainCall( this, arg0 );\n    return this;\n  };\n\n  // $().plugin('methodName')\n  function methodCall( $elems, methodName, args ) {\n    var returnValue;\n    var pluginMethodStr = '$().' + namespace + '(\"' + methodName + '\")';\n\n    $elems.each( function( i, elem ) {\n      // get instance\n      var instance = $.data( elem, namespace );\n      if ( !instance ) {\n        logError( namespace + ' not initialized. Cannot call methods, i.e. ' +\n          pluginMethodStr );\n        return;\n      }\n\n      var method = instance[ methodName ];\n      if ( !method || methodName.charAt(0) == '_' ) {\n        logError( pluginMethodStr + ' is not a valid method' );\n        return;\n      }\n\n      // apply method, get return value\n      var value = method.apply( instance, args );\n      // set return value if value is returned, use only first value\n      returnValue = returnValue === undefined ? value : returnValue;\n    });\n\n    return returnValue !== undefined ? returnValue : $elems;\n  }\n\n  function plainCall( $elems, options ) {\n    $elems.each( function( i, elem ) {\n      var instance = $.data( elem, namespace );\n      if ( instance ) {\n        // set options & init\n        instance.option( options );\n        instance._init();\n      } else {\n        // initialize new instance\n        instance = new PluginClass( elem, options );\n        $.data( elem, namespace, instance );\n      }\n    });\n  }\n\n  updateJQuery( $ );\n\n}\n\n// ----- updateJQuery ----- //\n\n// set $.bridget for v1 backwards compatibility\nfunction updateJQuery( $ ) {\n  if ( !$ || ( $ && $.bridget ) ) {\n    return;\n  }\n  $.bridget = jQueryBridget;\n}\n\nupdateJQuery( jQuery || window.jQuery );\n\n// -----  ----- //\n\nreturn jQueryBridget;\n\n}));\n\n/**\n * EvEmitter v1.0.2\n * Lil' event emitter\n * MIT License\n */\n\n/* jshint unused: true, undef: true, strict: true */\n\n( function( global, factory ) {\n  // universal module definition\n  /* jshint strict: false */ /* globals define, module */\n  if ( typeof define == 'function' && define.amd ) {\n    // AMD - RequireJS\n    define( 'ev-emitter/ev-emitter',factory );\n  } else if ( typeof module == 'object' && module.exports ) {\n    // CommonJS - Browserify, Webpack\n    module.exports = factory();\n  } else {\n    // Browser globals\n    global.EvEmitter = factory();\n  }\n\n}( this, function() {\n\n\n\nfunction EvEmitter() {}\n\nvar proto = EvEmitter.prototype;\n\nproto.on = function( eventName, listener ) {\n  if ( !eventName || !listener ) {\n    return;\n  }\n  // set events hash\n  var events = this._events = this._events || {};\n  // set listeners array\n  var listeners = events[ eventName ] = events[ eventName ] || [];\n  // only add once\n  if ( listeners.indexOf( listener ) == -1 ) {\n    listeners.push( listener );\n  }\n\n  return this;\n};\n\nproto.once = function( eventName, listener ) {\n  if ( !eventName || !listener ) {\n    return;\n  }\n  // add event\n  this.on( eventName, listener );\n  // set once flag\n  // set onceEvents hash\n  var onceEvents = this._onceEvents = this._onceEvents || {};\n  // set onceListeners object\n  var onceListeners = onceEvents[ eventName ] = onceEvents[ eventName ] || {};\n  // set flag\n  onceListeners[ listener ] = true;\n\n  return this;\n};\n\nproto.off = function( eventName, listener ) {\n  var listeners = this._events && this._events[ eventName ];\n  if ( !listeners || !listeners.length ) {\n    return;\n  }\n  var index = listeners.indexOf( listener );\n  if ( index != -1 ) {\n    listeners.splice( index, 1 );\n  }\n\n  return this;\n};\n\nproto.emitEvent = function( eventName, args ) {\n  var listeners = this._events && this._events[ eventName ];\n  if ( !listeners || !listeners.length ) {\n    return;\n  }\n  var i = 0;\n  var listener = listeners[i];\n  args = args || [];\n  // once stuff\n  var onceListeners = this._onceEvents && this._onceEvents[ eventName ];\n\n  while ( listener ) {\n    var isOnce = onceListeners && onceListeners[ listener ];\n    if ( isOnce ) {\n      // remove listener\n      // remove before trigger to prevent recursion\n      this.off( eventName, listener );\n      // unset once flag\n      delete onceListeners[ listener ];\n    }\n    // trigger listener\n    listener.apply( this, args );\n    // get next listener\n    i += isOnce ? 0 : 1;\n    listener = listeners[i];\n  }\n\n  return this;\n};\n\nreturn EvEmitter;\n\n}));\n\n/*!\n * getSize v2.0.2\n * measure size of elements\n * MIT license\n */\n\n/*jshint browser: true, strict: true, undef: true, unused: true */\n/*global define: false, module: false, console: false */\n\n( function( window, factory ) {\n  'use strict';\n\n  if ( typeof define == 'function' && define.amd ) {\n    // AMD\n    define( 'get-size/get-size',[],function() {\n      return factory();\n    });\n  } else if ( typeof module == 'object' && module.exports ) {\n    // CommonJS\n    module.exports = factory();\n  } else {\n    // browser global\n    window.getSize = factory();\n  }\n\n})( window, function factory() {\n'use strict';\n\n// -------------------------- helpers -------------------------- //\n\n// get a number from a string, not a percentage\nfunction getStyleSize( value ) {\n  var num = parseFloat( value );\n  // not a percent like '100%', and a number\n  var isValid = value.indexOf('%') == -1 && !isNaN( num );\n  return isValid && num;\n}\n\nfunction noop() {}\n\nvar logError = typeof console == 'undefined' ? noop :\n  function( message ) {\n    console.error( message );\n  };\n\n// -------------------------- measurements -------------------------- //\n\nvar measurements = [\n  'paddingLeft',\n  'paddingRight',\n  'paddingTop',\n  'paddingBottom',\n  'marginLeft',\n  'marginRight',\n  'marginTop',\n  'marginBottom',\n  'borderLeftWidth',\n  'borderRightWidth',\n  'borderTopWidth',\n  'borderBottomWidth'\n];\n\nvar measurementsLength = measurements.length;\n\nfunction getZeroSize() {\n  var size = {\n    width: 0,\n    height: 0,\n    innerWidth: 0,\n    innerHeight: 0,\n    outerWidth: 0,\n    outerHeight: 0\n  };\n  for ( var i=0; i < measurementsLength; i++ ) {\n    var measurement = measurements[i];\n    size[ measurement ] = 0;\n  }\n  return size;\n}\n\n// -------------------------- getStyle -------------------------- //\n\n/**\n * getStyle, get style of element, check for Firefox bug\n * https://bugzilla.mozilla.org/show_bug.cgi?id=548397\n */\nfunction getStyle( elem ) {\n  var style = getComputedStyle( elem );\n  if ( !style ) {\n    logError( 'Style returned ' + style +\n      '. Are you running this code in a hidden iframe on Firefox? ' +\n      'See http://bit.ly/getsizebug1' );\n  }\n  return style;\n}\n\n// -------------------------- setup -------------------------- //\n\nvar isSetup = false;\n\nvar isBoxSizeOuter;\n\n/**\n * setup\n * check isBoxSizerOuter\n * do on first getSize() rather than on page load for Firefox bug\n */\nfunction setup() {\n  // setup once\n  if ( isSetup ) {\n    return;\n  }\n  isSetup = true;\n\n  // -------------------------- box sizing -------------------------- //\n\n  /**\n   * WebKit measures the outer-width on style.width on border-box elems\n   * IE & Firefox<29 measures the inner-width\n   */\n  var div = document.createElement('div');\n  div.style.width = '200px';\n  div.style.padding = '1px 2px 3px 4px';\n  div.style.borderStyle = 'solid';\n  div.style.borderWidth = '1px 2px 3px 4px';\n  div.style.boxSizing = 'border-box';\n\n  var body = document.body || document.documentElement;\n  body.appendChild( div );\n  var style = getStyle( div );\n\n  getSize.isBoxSizeOuter = isBoxSizeOuter = getStyleSize( style.width ) == 200;\n  body.removeChild( div );\n\n}\n\n// -------------------------- getSize -------------------------- //\n\nfunction getSize( elem ) {\n  setup();\n\n  // use querySeletor if elem is string\n  if ( typeof elem == 'string' ) {\n    elem = document.querySelector( elem );\n  }\n\n  // do not proceed on non-objects\n  if ( !elem || typeof elem != 'object' || !elem.nodeType ) {\n    return;\n  }\n\n  var style = getStyle( elem );\n\n  // if hidden, everything is 0\n  if ( style.display == 'none' ) {\n    return getZeroSize();\n  }\n\n  var size = {};\n  size.width = elem.offsetWidth;\n  size.height = elem.offsetHeight;\n\n  var isBorderBox = size.isBorderBox = style.boxSizing == 'border-box';\n\n  // get all measurements\n  for ( var i=0; i < measurementsLength; i++ ) {\n    var measurement = measurements[i];\n    var value = style[ measurement ];\n    var num = parseFloat( value );\n    // any 'auto', 'medium' value will be 0\n    size[ measurement ] = !isNaN( num ) ? num : 0;\n  }\n\n  var paddingWidth = size.paddingLeft + size.paddingRight;\n  var paddingHeight = size.paddingTop + size.paddingBottom;\n  var marginWidth = size.marginLeft + size.marginRight;\n  var marginHeight = size.marginTop + size.marginBottom;\n  var borderWidth = size.borderLeftWidth + size.borderRightWidth;\n  var borderHeight = size.borderTopWidth + size.borderBottomWidth;\n\n  var isBorderBoxSizeOuter = isBorderBox && isBoxSizeOuter;\n\n  // overwrite width and height if we can get it from style\n  var styleWidth = getStyleSize( style.width );\n  if ( styleWidth !== false ) {\n    size.width = styleWidth +\n      // add padding and border unless it's already including it\n      ( isBorderBoxSizeOuter ? 0 : paddingWidth + borderWidth );\n  }\n\n  var styleHeight = getStyleSize( style.height );\n  if ( styleHeight !== false ) {\n    size.height = styleHeight +\n      // add padding and border unless it's already including it\n      ( isBorderBoxSizeOuter ? 0 : paddingHeight + borderHeight );\n  }\n\n  size.innerWidth = size.width - ( paddingWidth + borderWidth );\n  size.innerHeight = size.height - ( paddingHeight + borderHeight );\n\n  size.outerWidth = size.width + marginWidth;\n  size.outerHeight = size.height + marginHeight;\n\n  return size;\n}\n\nreturn getSize;\n\n});\n\n/**\n * matchesSelector v2.0.1\n * matchesSelector( element, '.selector' )\n * MIT license\n */\n\n/*jshint browser: true, strict: true, undef: true, unused: true */\n\n( function( window, factory ) {\n  /*global define: false, module: false */\n  'use strict';\n  // universal module definition\n  if ( typeof define == 'function' && define.amd ) {\n    // AMD\n    define( 'desandro-matches-selector/matches-selector',factory );\n  } else if ( typeof module == 'object' && module.exports ) {\n    // CommonJS\n    module.exports = factory();\n  } else {\n    // browser global\n    window.matchesSelector = factory();\n  }\n\n}( window, function factory() {\n  'use strict';\n\n  var matchesMethod = ( function() {\n    var ElemProto = Element.prototype;\n    // check for the standard method name first\n    if ( ElemProto.matches ) {\n      return 'matches';\n    }\n    // check un-prefixed\n    if ( ElemProto.matchesSelector ) {\n      return 'matchesSelector';\n    }\n    // check vendor prefixes\n    var prefixes = [ 'webkit', 'moz', 'ms', 'o' ];\n\n    for ( var i=0; i < prefixes.length; i++ ) {\n      var prefix = prefixes[i];\n      var method = prefix + 'MatchesSelector';\n      if ( ElemProto[ method ] ) {\n        return method;\n      }\n    }\n  })();\n\n  return function matchesSelector( elem, selector ) {\n    return elem[ matchesMethod ]( selector );\n  };\n\n}));\n\n/**\n * Fizzy UI utils v2.0.1\n * MIT license\n */\n\n/*jshint browser: true, undef: true, unused: true, strict: true */\n\n( function( window, factory ) {\n  // universal module definition\n  /*jshint strict: false */ /*globals define, module, require */\n\n  if ( typeof define == 'function' && define.amd ) {\n    // AMD\n    define( 'fizzy-ui-utils/utils',[\n      'desandro-matches-selector/matches-selector'\n    ], function( matchesSelector ) {\n      return factory( window, matchesSelector );\n    });\n  } else if ( typeof module == 'object' && module.exports ) {\n    // CommonJS\n    module.exports = factory(\n      window,\n      require('desandro-matches-selector')\n    );\n  } else {\n    // browser global\n    window.fizzyUIUtils = factory(\n      window,\n      window.matchesSelector\n    );\n  }\n\n}( window, function factory( window, matchesSelector ) {\n\n\n\nvar utils = {};\n\n// ----- extend ----- //\n\n// extends objects\nutils.extend = function( a, b ) {\n  for ( var prop in b ) {\n    a[ prop ] = b[ prop ];\n  }\n  return a;\n};\n\n// ----- modulo ----- //\n\nutils.modulo = function( num, div ) {\n  return ( ( num % div ) + div ) % div;\n};\n\n// ----- makeArray ----- //\n\n// turn element or nodeList into an array\nutils.makeArray = function( obj ) {\n  var ary = [];\n  if ( Array.isArray( obj ) ) {\n    // use object if already an array\n    ary = obj;\n  } else if ( obj && typeof obj.length == 'number' ) {\n    // convert nodeList to array\n    for ( var i=0; i < obj.length; i++ ) {\n      ary.push( obj[i] );\n    }\n  } else {\n    // array of single index\n    ary.push( obj );\n  }\n  return ary;\n};\n\n// ----- removeFrom ----- //\n\nutils.removeFrom = function( ary, obj ) {\n  var index = ary.indexOf( obj );\n  if ( index != -1 ) {\n    ary.splice( index, 1 );\n  }\n};\n\n// ----- getParent ----- //\n\nutils.getParent = function( elem, selector ) {\n  while ( elem != document.body ) {\n    elem = elem.parentNode;\n    if ( matchesSelector( elem, selector ) ) {\n      return elem;\n    }\n  }\n};\n\n// ----- getQueryElement ----- //\n\n// use element as selector string\nutils.getQueryElement = function( elem ) {\n  if ( typeof elem == 'string' ) {\n    return document.querySelector( elem );\n  }\n  return elem;\n};\n\n// ----- handleEvent ----- //\n\n// enable .ontype to trigger from .addEventListener( elem, 'type' )\nutils.handleEvent = function( event ) {\n  var method = 'on' + event.type;\n  if ( this[ method ] ) {\n    this[ method ]( event );\n  }\n};\n\n// ----- filterFindElements ----- //\n\nutils.filterFindElements = function( elems, selector ) {\n  // make array of elems\n  elems = utils.makeArray( elems );\n  var ffElems = [];\n\n  elems.forEach( function( elem ) {\n    // check that elem is an actual element\n    if ( !( elem instanceof HTMLElement ) ) {\n      return;\n    }\n    // add elem if no selector\n    if ( !selector ) {\n      ffElems.push( elem );\n      return;\n    }\n    // filter & find items if we have a selector\n    // filter\n    if ( matchesSelector( elem, selector ) ) {\n      ffElems.push( elem );\n    }\n    // find children\n    var childElems = elem.querySelectorAll( selector );\n    // concat childElems to filterFound array\n    for ( var i=0; i < childElems.length; i++ ) {\n      ffElems.push( childElems[i] );\n    }\n  });\n\n  return ffElems;\n};\n\n// ----- debounceMethod ----- //\n\nutils.debounceMethod = function( _class, methodName, threshold ) {\n  // original method\n  var method = _class.prototype[ methodName ];\n  var timeoutName = methodName + 'Timeout';\n\n  _class.prototype[ methodName ] = function() {\n    var timeout = this[ timeoutName ];\n    if ( timeout ) {\n      clearTimeout( timeout );\n    }\n    var args = arguments;\n\n    var _this = this;\n    this[ timeoutName ] = setTimeout( function() {\n      method.apply( _this, args );\n      delete _this[ timeoutName ];\n    }, threshold || 100 );\n  };\n};\n\n// ----- docReady ----- //\n\nutils.docReady = function( callback ) {\n  if ( document.readyState == 'complete' ) {\n    callback();\n  } else {\n    document.addEventListener( 'DOMContentLoaded', callback );\n  }\n};\n\n// ----- htmlInit ----- //\n\n// http://jamesroberts.name/blog/2010/02/22/string-functions-for-javascript-trim-to-camel-case-to-dashed-and-to-underscore/\nutils.toDashed = function( str ) {\n  return str.replace( /(.)([A-Z])/g, function( match, $1, $2 ) {\n    return $1 + '-' + $2;\n  }).toLowerCase();\n};\n\nvar console = window.console;\n/**\n * allow user to initialize classes via [data-namespace] or .js-namespace class\n * htmlInit( Widget, 'widgetName' )\n * options are parsed from data-namespace-options\n */\nutils.htmlInit = function( WidgetClass, namespace ) {\n  utils.docReady( function() {\n    var dashedNamespace = utils.toDashed( namespace );\n    var dataAttr = 'data-' + dashedNamespace;\n    var dataAttrElems = document.querySelectorAll( '[' + dataAttr + ']' );\n    var jsDashElems = document.querySelectorAll( '.js-' + dashedNamespace );\n    var elems = utils.makeArray( dataAttrElems )\n      .concat( utils.makeArray( jsDashElems ) );\n    var dataOptionsAttr = dataAttr + '-options';\n    var jQuery = window.jQuery;\n\n    elems.forEach( function( elem ) {\n      var attr = elem.getAttribute( dataAttr ) ||\n        elem.getAttribute( dataOptionsAttr );\n      var options;\n      try {\n        options = attr && JSON.parse( attr );\n      } catch ( error ) {\n        // log error, do not initialize\n        if ( console ) {\n          console.error( 'Error parsing ' + dataAttr + ' on ' + elem.className +\n          ': ' + error );\n        }\n        return;\n      }\n      // initialize\n      var instance = new WidgetClass( elem, options );\n      // make available via $().data('layoutname')\n      if ( jQuery ) {\n        jQuery.data( elem, namespace, instance );\n      }\n    });\n\n  });\n};\n\n// -----  ----- //\n\nreturn utils;\n\n}));\n\n/**\n * Outlayer Item\n */\n\n( function( window, factory ) {\n  // universal module definition\n  /* jshint strict: false */ /* globals define, module, require */\n  if ( typeof define == 'function' && define.amd ) {\n    // AMD - RequireJS\n    define( 'outlayer/enviratope-item',[\n        'ev-emitter/ev-emitter',\n        'get-size/get-size'\n      ],\n      factory\n    );\n  } else if ( typeof module == 'object' && module.exports ) {\n    // CommonJS - Browserify, Webpack\n    module.exports = factory(\n      require('ev-emitter'),\n      require('get-size')\n    );\n  } else {\n    // browser global\n    window.Outlayer = {};\n    window.Outlayer.Item = factory(\n      window.EvEmitter,\n      window.getSize\n    );\n  }\n\n}( window, function factory( EvEmitter, getSize ) {\n'use strict';\n\n// ----- helpers ----- //\n\nfunction isEmptyObj( obj ) {\n  for ( var prop in obj ) {\n    return false;\n  }\n  prop = null;\n  return true;\n}\n\n// -------------------------- CSS3 support -------------------------- //\n\n\nvar docElemStyle = document.documentElement.style;\n\nvar transitionProperty = typeof docElemStyle.transition == 'string' ?\n  'transition' : 'WebkitTransition';\nvar transformProperty = typeof docElemStyle.transform == 'string' ?\n  'transform' : 'WebkitTransform';\n\nvar transitionEndEvent = {\n  WebkitTransition: 'webkitTransitionEnd',\n  transition: 'transitionend'\n}[ transitionProperty ];\n\n// cache all vendor properties that could have vendor prefix\nvar vendorProperties = {\n  transform: transformProperty,\n  transition: transitionProperty,\n  transitionDuration: transitionProperty + 'Duration',\n  transitionProperty: transitionProperty + 'Property',\n  transitionDelay: transitionProperty + 'Delay'\n};\n\n// -------------------------- Item -------------------------- //\n\nfunction Item( element, layout ) {\n  if ( !element ) {\n    return;\n  }\n\n  this.element = element;\n  // parent layout class, i.e. Masonry, Enviratope, or Packery\n  this.layout = layout;\n  this.position = {\n    x: 0,\n    y: 0\n  };\n\n  this._create();\n}\n\n// inherit EvEmitter\nvar proto = Item.prototype = Object.create( EvEmitter.prototype );\nproto.constructor = Item;\n\nproto._create = function() {\n  // transition objects\n  this._transn = {\n    ingProperties: {},\n    clean: {},\n    onEnd: {}\n  };\n\n  this.css({\n    position: 'absolute'\n  });\n};\n\n// trigger specified handler for event type\nproto.handleEvent = function( event ) {\n  var method = 'on' + event.type;\n  if ( this[ method ] ) {\n    this[ method ]( event );\n  }\n};\n\nproto.getSize = function() {\n  this.size = getSize( this.element );\n};\n\n/**\n * apply CSS styles to element\n * @param {Object} style\n */\nproto.css = function( style ) {\n  var elemStyle = this.element.style;\n\n  for ( var prop in style ) {\n    // use vendor property if available\n    var supportedProp = vendorProperties[ prop ] || prop;\n    elemStyle[ supportedProp ] = style[ prop ];\n  }\n};\n\n // measure position, and sets it\nproto.getPosition = function() {\n  var style = getComputedStyle( this.element );\n  var isOriginLeft = this.layout._getOption('originLeft');\n  var isOriginTop = this.layout._getOption('originTop');\n  var xValue = style[ isOriginLeft ? 'left' : 'right' ];\n  var yValue = style[ isOriginTop ? 'top' : 'bottom' ];\n  // convert percent to pixels\n  var layoutSize = this.layout.size;\n  var x = xValue.indexOf('%') != -1 ?\n    ( parseFloat( xValue ) / 100 ) * layoutSize.width : parseInt( xValue, 10 );\n  var y = yValue.indexOf('%') != -1 ?\n    ( parseFloat( yValue ) / 100 ) * layoutSize.height : parseInt( yValue, 10 );\n\n  // clean up 'auto' or other non-integer values\n  x = isNaN( x ) ? 0 : x;\n  y = isNaN( y ) ? 0 : y;\n  // remove padding from measurement\n  x -= isOriginLeft ? layoutSize.paddingLeft : layoutSize.paddingRight;\n  y -= isOriginTop ? layoutSize.paddingTop : layoutSize.paddingBottom;\n\n  this.position.x = x;\n  this.position.y = y;\n};\n\n// set settled position, apply padding\nproto.layoutPosition = function() {\n  var layoutSize = this.layout.size;\n  var style = {};\n  var isOriginLeft = this.layout._getOption('originLeft');\n  var isOriginTop = this.layout._getOption('originTop');\n\n  // x\n  var xPadding = isOriginLeft ? 'paddingLeft' : 'paddingRight';\n  var xProperty = isOriginLeft ? 'left' : 'right';\n  var xResetProperty = isOriginLeft ? 'right' : 'left';\n\n  var x = this.position.x + layoutSize[ xPadding ];\n  // set in percentage or pixels\n  style[ xProperty ] = this.getXValue( x );\n  // reset other property\n  style[ xResetProperty ] = '';\n\n  // y\n  var yPadding = isOriginTop ? 'paddingTop' : 'paddingBottom';\n  var yProperty = isOriginTop ? 'top' : 'bottom';\n  var yResetProperty = isOriginTop ? 'bottom' : 'top';\n\n  var y = this.position.y + layoutSize[ yPadding ];\n  // set in percentage or pixels\n  style[ yProperty ] = this.getYValue( y );\n  // reset other property\n  style[ yResetProperty ] = '';\n\n  this.css( style );\n  this.emitEvent( 'layout', [ this ] );\n};\n\nproto.getXValue = function( x ) {\n  var isHorizontal = this.layout._getOption('horizontal');\n  return this.layout.options.percentPosition && !isHorizontal ?\n    ( ( x / this.layout.size.width ) * 100 ) + '%' : x + 'px';\n};\n\nproto.getYValue = function( y ) {\n  var isHorizontal = this.layout._getOption('horizontal');\n  return this.layout.options.percentPosition && isHorizontal ?\n    ( ( y / this.layout.size.height ) * 100 ) + '%' : y + 'px';\n};\n\nproto._transitionTo = function( x, y ) {\n  this.getPosition();\n  // get current x & y from top/left\n  var curX = this.position.x;\n  var curY = this.position.y;\n\n  var compareX = parseInt( x, 10 );\n  var compareY = parseInt( y, 10 );\n  var didNotMove = compareX === this.position.x && compareY === this.position.y;\n\n  // save end position\n  this.setPosition( x, y );\n\n  // if did not move and not transitioning, just go to layout\n  if ( didNotMove && !this.isTransitioning ) {\n    this.layoutPosition();\n    return;\n  }\n\n  var transX = x - curX;\n  var transY = y - curY;\n  var transitionStyle = {};\n  transitionStyle.transform = this.getTranslate( transX, transY );\n\n  this.transition({\n    to: transitionStyle,\n    onTransitionEnd: {\n      transform: this.layoutPosition\n    },\n    isCleaning: true\n  });\n};\n\nproto.getTranslate = function( x, y ) {\n  // flip cooridinates if origin on right or bottom\n  var isOriginLeft = this.layout._getOption('originLeft');\n  var isOriginTop = this.layout._getOption('originTop');\n  x = isOriginLeft ? x : -x;\n  y = isOriginTop ? y : -y;\n  return 'translate3d(' + x + 'px, ' + y + 'px, 0)';\n};\n\n// non transition + transform support\nproto.goTo = function( x, y ) {\n  this.setPosition( x, y );\n  this.layoutPosition();\n};\n\nproto.moveTo = proto._transitionTo;\n\nproto.setPosition = function( x, y ) {\n  this.position.x = parseInt( x, 10 );\n  this.position.y = parseInt( y, 10 );\n};\n\n// ----- transition ----- //\n\n/**\n * @param {Object} style - CSS\n * @param {Function} onTransitionEnd\n */\n\n// non transition, just trigger callback\nproto._nonTransition = function( args ) {\n  this.css( args.to );\n  if ( args.isCleaning ) {\n    this._removeStyles( args.to );\n  }\n  for ( var prop in args.onTransitionEnd ) {\n    args.onTransitionEnd[ prop ].call( this );\n  }\n};\n\n/**\n * proper transition\n * @param {Object} args - arguments\n *   @param {Object} to - style to transition to\n *   @param {Object} from - style to start transition from\n *   @param {Boolean} isCleaning - removes transition styles after transition\n *   @param {Function} onTransitionEnd - callback\n */\nproto.transition = function( args ) {\n  // redirect to nonTransition if no transition duration\n  if ( !parseFloat( this.layout.options.transitionDuration ) ) {\n    this._nonTransition( args );\n    return;\n  }\n\n  var _transition = this._transn;\n  // keep track of onTransitionEnd callback by css property\n  for ( var prop in args.onTransitionEnd ) {\n    _transition.onEnd[ prop ] = args.onTransitionEnd[ prop ];\n  }\n  // keep track of properties that are transitioning\n  for ( prop in args.to ) {\n    _transition.ingProperties[ prop ] = true;\n    // keep track of properties to clean up when transition is done\n    if ( args.isCleaning ) {\n      _transition.clean[ prop ] = true;\n    }\n  }\n\n  // set from styles\n  if ( args.from ) {\n    this.css( args.from );\n    // force redraw. http://blog.alexmaccaw.com/css-transitions\n    var h = this.element.offsetHeight;\n    // hack for JSHint to hush about unused var\n    h = null;\n  }\n  // enable transition\n  this.enableTransition( args.to );\n  // set styles that are transitioning\n  this.css( args.to );\n\n  this.isTransitioning = true;\n\n};\n\n// dash before all cap letters, including first for\n// WebkitTransform => -webkit-transform\nfunction toDashedAll( str ) {\n  return str.replace( /([A-Z])/g, function( $1 ) {\n    return '-' + $1.toLowerCase();\n  });\n}\n\nvar transitionProps = 'opacity,' + toDashedAll( transformProperty );\n\nproto.enableTransition = function(/* style */) {\n  // HACK changing transitionProperty during a transition\n  // will cause transition to jump\n  if ( this.isTransitioning ) {\n    return;\n  }\n\n  // make `transition: foo, bar, baz` from style object\n  // HACK un-comment this when enableTransition can work\n  // while a transition is happening\n  // var transitionValues = [];\n  // for ( var prop in style ) {\n  //   // dash-ify camelCased properties like WebkitTransition\n  //   prop = vendorProperties[ prop ] || prop;\n  //   transitionValues.push( toDashedAll( prop ) );\n  // }\n  // munge number to millisecond, to match stagger\n  var duration = this.layout.options.transitionDuration;\n  duration = typeof duration == 'number' ? duration + 'ms' : duration;\n  // enable transition styles\n  this.css({\n    transitionProperty: transitionProps,\n    transitionDuration: duration,\n    transitionDelay: this.staggerDelay || 0\n  });\n  // listen for transition end event\n  this.element.addEventListener( transitionEndEvent, this, false );\n};\n\n// ----- events ----- //\n\nproto.onwebkitTransitionEnd = function( event ) {\n  this.ontransitionend( event );\n};\n\nproto.onotransitionend = function( event ) {\n  this.ontransitionend( event );\n};\n\n// properties that I munge to make my life easier\nvar dashedVendorProperties = {\n  '-webkit-transform': 'transform'\n};\n\nproto.ontransitionend = function( event ) {\n  // disregard bubbled events from children\n  if ( event.target !== this.element ) {\n    return;\n  }\n  var _transition = this._transn;\n  // get property name of transitioned property, convert to prefix-free\n  var propertyName = dashedVendorProperties[ event.propertyName ] || event.propertyName;\n\n  // remove property that has completed transitioning\n  delete _transition.ingProperties[ propertyName ];\n  // check if any properties are still transitioning\n  if ( isEmptyObj( _transition.ingProperties ) ) {\n    // all properties have completed transitioning\n    this.disableTransition();\n  }\n  // clean style\n  if ( propertyName in _transition.clean ) {\n    // clean up style\n    this.element.style[ event.propertyName ] = '';\n    delete _transition.clean[ propertyName ];\n  }\n  // trigger onTransitionEnd callback\n  if ( propertyName in _transition.onEnd ) {\n    var onTransitionEnd = _transition.onEnd[ propertyName ];\n    onTransitionEnd.call( this );\n    delete _transition.onEnd[ propertyName ];\n  }\n\n  this.emitEvent( 'transitionEnd', [ this ] );\n};\n\nproto.disableTransition = function() {\n  this.removeTransitionStyles();\n  this.element.removeEventListener( transitionEndEvent, this, false );\n  this.isTransitioning = false;\n};\n\n/**\n * removes style property from element\n * @param {Object} style\n**/\nproto._removeStyles = function( style ) {\n  // clean up transition styles\n  var cleanStyle = {};\n  for ( var prop in style ) {\n    cleanStyle[ prop ] = '';\n  }\n  this.css( cleanStyle );\n};\n\nvar cleanTransitionStyle = {\n  transitionProperty: '',\n  transitionDuration: '',\n  transitionDelay: ''\n};\n\nproto.removeTransitionStyles = function() {\n  // remove transition\n  this.css( cleanTransitionStyle );\n};\n\n// ----- stagger ----- //\n\nproto.stagger = function( delay ) {\n  delay = isNaN( delay ) ? 0 : delay;\n  this.staggerDelay = delay + 'ms';\n};\n\n// ----- show/hide/remove ----- //\n\n// remove element from DOM\nproto.removeElem = function() {\n  this.element.parentNode.removeChild( this.element );\n  // remove display: none\n  this.css({ display: '' });\n  this.emitEvent( 'remove', [ this ] );\n};\n\nproto.remove = function() {\n  // just remove element if no transition support or no transition\n  if ( !transitionProperty || !parseFloat( this.layout.options.transitionDuration ) ) {\n    this.removeElem();\n    return;\n  }\n\n  // start transition\n  this.once( 'transitionEnd', function() {\n    this.removeElem();\n  });\n  this.hide();\n};\n\nproto.reveal = function() {\n  delete this.isHidden;\n  // remove display: none\n  this.css({ display: '' });\n\n  var options = this.layout.options;\n\n  var onTransitionEnd = {};\n  var transitionEndProperty = this.getHideRevealTransitionEndProperty('visibleStyle');\n  onTransitionEnd[ transitionEndProperty ] = this.onRevealTransitionEnd;\n\n  this.transition({\n    from: options.hiddenStyle,\n    to: options.visibleStyle,\n    isCleaning: true,\n    onTransitionEnd: onTransitionEnd\n  });\n};\n\nproto.onRevealTransitionEnd = function() {\n  // check if still visible\n  // during transition, item may have been hidden\n  if ( !this.isHidden ) {\n    this.emitEvent('reveal');\n  }\n};\n\n/**\n * get style property use for hide/reveal transition end\n * @param {String} styleProperty - hiddenStyle/visibleStyle\n * @returns {String}\n */\nproto.getHideRevealTransitionEndProperty = function( styleProperty ) {\n  var optionStyle = this.layout.options[ styleProperty ];\n  // use opacity\n  if ( optionStyle.opacity ) {\n    return 'opacity';\n  }\n  // get first property\n  for ( var prop in optionStyle ) {\n    return prop;\n  }\n};\n\nproto.hide = function() {\n  // set flag\n  this.isHidden = true;\n  // remove display: none\n  this.css({ display: '' });\n\n  var options = this.layout.options;\n\n  var onTransitionEnd = {};\n  var transitionEndProperty = this.getHideRevealTransitionEndProperty('hiddenStyle');\n  onTransitionEnd[ transitionEndProperty ] = this.onHideTransitionEnd;\n\n  this.transition({\n    from: options.visibleStyle,\n    to: options.hiddenStyle,\n    // keep hidden stuff hidden\n    isCleaning: true,\n    onTransitionEnd: onTransitionEnd\n  });\n};\n\nproto.onHideTransitionEnd = function() {\n  // check if still hidden\n  // during transition, item may have been un-hidden\n  if ( this.isHidden ) {\n    this.css({ display: 'none' });\n    this.emitEvent('hide');\n  }\n};\n\nproto.destroy = function() {\n  this.css({\n    position: '',\n    left: '',\n    right: '',\n    top: '',\n    bottom: '',\n    transition: '',\n    transform: ''\n  });\n};\n\nreturn Item;\n\n}));\n\n/*!\n * Outlayer v2.1.0\n * the brains and guts of a layout library\n * MIT license\n */\n\n( function( window, factory ) {\n  'use strict';\n  // universal module definition\n  /* jshint strict: false */ /* globals define, module, require */\n  if ( typeof define == 'function' && define.amd ) {\n    // AMD - RequireJS\n    define( 'outlayer/outlayer',[\n        'ev-emitter/ev-emitter',\n        'get-size/get-size',\n        'fizzy-ui-utils/utils',\n        './enviratope-item'\n      ],\n      function( EvEmitter, getSize, utils, Item ) {\n        return factory( window, EvEmitter, getSize, utils, Item);\n      }\n    );\n  } else if ( typeof module == 'object' && module.exports ) {\n    // CommonJS - Browserify, Webpack\n    module.exports = factory(\n      window,\n      require('ev-emitter'),\n      require('get-size'),\n      require('fizzy-ui-utils'),\n      require('./enviratope-item.js')\n    );\n  } else {\n    // browser global\n    window.Outlayer = factory(\n      window,\n      window.EvEmitter,\n      window.getSize,\n      window.fizzyUIUtils,\n      window.Outlayer.Item\n    );\n  }\n\n}( window, function factory( window, EvEmitter, getSize, utils, Item ) {\n'use strict';\n\n// ----- vars ----- //\n\nvar console = window.console;\nvar jQuery = window.jQuery;\nvar noop = function() {};\n\n// -------------------------- Outlayer -------------------------- //\n\n// globally unique identifiers\nvar GUID = 0;\n// internal store of all Outlayer intances\nvar instances = {};\n\n\n/**\n * @param {Element, String} element\n * @param {Object} options\n * @constructor\n */\nfunction Outlayer( element, options ) {\n  var queryElement = utils.getQueryElement( element );\n  if ( !queryElement ) {\n    if ( console ) {\n      console.error( 'Bad element for ' + this.constructor.namespace +\n        ': ' + ( queryElement || element ) );\n    }\n    return;\n  }\n  this.element = queryElement;\n  // add jQuery\n  if ( jQuery ) {\n    this.$element = jQuery( this.element );\n  }\n\n  // options\n  this.options = utils.extend( {}, this.constructor.defaults );\n  this.option( options );\n\n  // add id for Outlayer.getFromElement\n  var id = ++GUID;\n  this.element.outlayerGUID = id; // expando\n  instances[ id ] = this; // associate via id\n\n  // kick it off\n  this._create();\n\n  var isInitLayout = this._getOption('initLayout');\n  if ( isInitLayout ) {\n    this.layout();\n  }\n}\n\n// settings are for internal use only\nOutlayer.namespace = 'outlayer';\nOutlayer.Item = Item;\n\n// default options\nOutlayer.defaults = {\n  containerStyle: {\n    position: 'relative'\n  },\n  initLayout: true,\n  originLeft: true,\n  originTop: true,\n  resize: true,\n  resizeContainer: true,\n  // item options\n  transitionDuration: '0.4s',\n  hiddenStyle: {\n    opacity: 0,\n    transform: 'scale(0.001)'\n  },\n  visibleStyle: {\n    opacity: 1,\n    transform: 'scale(1)'\n  }\n};\n\nvar proto = Outlayer.prototype;\n// inherit EvEmitter\nutils.extend( proto, EvEmitter.prototype );\n\n/**\n * set options\n * @param {Object} opts\n */\nproto.option = function( opts ) {\n  utils.extend( this.options, opts );\n};\n\n/**\n * get backwards compatible option value, check old name\n */\nproto._getOption = function( option ) {\n  var oldOption = this.constructor.compatOptions[ option ];\n  return oldOption && this.options[ oldOption ] !== undefined ?\n    this.options[ oldOption ] : this.options[ option ];\n};\n\nOutlayer.compatOptions = {\n  // currentName: oldName\n  initLayout: 'isInitLayout',\n  horizontal: 'isHorizontal',\n  layoutInstant: 'isLayoutInstant',\n  originLeft: 'isOriginLeft',\n  originTop: 'isOriginTop',\n  resize: 'isResizeBound',\n  resizeContainer: 'isResizingContainer'\n};\n\nproto._create = function() {\n  // get items from children\n  this.reloadItems();\n  // elements that affect layout, but are not laid out\n  this.stamps = [];\n  this.stamp( this.options.stamp );\n  // set container style\n  utils.extend( this.element.style, this.options.containerStyle );\n\n  // bind resize method\n  var canBindResize = this._getOption('resize');\n  if ( canBindResize ) {\n    this.bindResize();\n  }\n};\n\n// goes through all children again and gets bricks in proper order\nproto.reloadItems = function() {\n  // collection of item elements\n  this.items = this._itemize( this.element.children );\n};\n\n\n/**\n * turn elements into Outlayer.Items to be used in layout\n * @param {Array or NodeList or HTMLElement} elems\n * @returns {Array} items - collection of new Outlayer Items\n */\nproto._itemize = function( elems ) {\n\n  var itemElems = this._filterFindItemElements( elems );\n  var Item = this.constructor.Item;\n\n  // create new Outlayer Items for collection\n  var items = [];\n  for ( var i=0; i < itemElems.length; i++ ) {\n    var elem = itemElems[i];\n    var item = new Item( elem, this );\n    items.push( item );\n  }\n\n  return items;\n};\n\n/**\n * get item elements to be used in layout\n * @param {Array or NodeList or HTMLElement} elems\n * @returns {Array} items - item elements\n */\nproto._filterFindItemElements = function( elems ) {\n  return utils.filterFindElements( elems, this.options.itemSelector );\n};\n\n/**\n * getter method for getting item elements\n * @returns {Array} elems - collection of item elements\n */\nproto.getItemElements = function() {\n  return this.items.map( function( item ) {\n    return item.element;\n  });\n};\n\n// ----- init & layout ----- //\n\n/**\n * lays out all items\n */\nproto.layout = function() {\n  this._resetLayout();\n  this._manageStamps();\n\n  // don't animate first layout\n  var layoutInstant = this._getOption('layoutInstant');\n  var isInstant = layoutInstant !== undefined ?\n    layoutInstant : !this._isLayoutInited;\n  this.layoutItems( this.items, isInstant );\n\n  // flag for initalized\n  this._isLayoutInited = true;\n};\n\n// _init is alias for layout\nproto._init = proto.layout;\n\n/**\n * logic before any new layout\n */\nproto._resetLayout = function() {\n  this.getSize();\n};\n\n\nproto.getSize = function() {\n  this.size = getSize( this.element );\n};\n\n/**\n * get measurement from option, for columnWidth, rowHeight, gutter\n * if option is String -> get element from selector string, & get size of element\n * if option is Element -> get size of element\n * else use option as a number\n *\n * @param {String} measurement\n * @param {String} size - width or height\n * @private\n */\nproto._getMeasurement = function( measurement, size ) {\n  var option = this.options[ measurement ];\n  var elem;\n  if ( !option ) {\n    // default to 0\n    this[ measurement ] = 0;\n  } else {\n    // use option as an element\n    if ( typeof option == 'string' ) {\n      elem = this.element.querySelector( option );\n    } else if ( option instanceof HTMLElement ) {\n      elem = option;\n    }\n    // use size of element, if element\n    this[ measurement ] = elem ? getSize( elem )[ size ] : option;\n  }\n};\n\n/**\n * layout a collection of item elements\n * @api public\n */\nproto.layoutItems = function( items, isInstant ) {\n  items = this._getItemsForLayout( items );\n\n  this._layoutItems( items, isInstant );\n\n  this._postLayout();\n};\n\n/**\n * get the items to be laid out\n * you may want to skip over some items\n * @param {Array} items\n * @returns {Array} items\n */\nproto._getItemsForLayout = function( items ) {\n  return items.filter( function( item ) {\n    return !item.isIgnored;\n  });\n};\n\n/**\n * layout items\n * @param {Array} items\n * @param {Boolean} isInstant\n */\nproto._layoutItems = function( items, isInstant ) {\n  this._emitCompleteOnItems( 'layout', items );\n\n  if ( !items || !items.length ) {\n    // no items, emit event with empty array\n    return;\n  }\n\n  var queue = [];\n\n  items.forEach( function( item ) {\n    // get x/y object from method\n    var position = this._getItemLayoutPosition( item );\n    // enqueue\n    position.item = item;\n    position.isInstant = isInstant || item.isLayoutInstant;\n    queue.push( position );\n  }, this );\n\n  this._processLayoutQueue( queue );\n};\n\n/**\n * get item layout position\n * @param {Outlayer.Item} item\n * @returns {Object} x and y position\n */\nproto._getItemLayoutPosition = function( /* item */ ) {\n  return {\n    x: 0,\n    y: 0\n  };\n};\n\n/**\n * iterate over array and position each item\n * Reason being - separating this logic prevents 'layout invalidation'\n * thx @paul_irish\n * @param {Array} queue\n */\nproto._processLayoutQueue = function( queue ) {\n  this.updateStagger();\n  queue.forEach( function( obj, i ) {\n    this._positionItem( obj.item, obj.x, obj.y, obj.isInstant, i );\n  }, this );\n};\n\n// set stagger from option in milliseconds number\nproto.updateStagger = function() {\n  var stagger = this.options.stagger;\n  if ( stagger === null || stagger === undefined ) {\n    this.stagger = 0;\n    return;\n  }\n  this.stagger = getMilliseconds( stagger );\n  return this.stagger;\n};\n\n/**\n * Sets position of item in DOM\n * @param {Outlayer.Item} item\n * @param {Number} x - horizontal position\n * @param {Number} y - vertical position\n * @param {Boolean} isInstant - disables transitions\n */\nproto._positionItem = function( item, x, y, isInstant, i ) {\n  if ( isInstant ) {\n    // if not transition, just set CSS\n    item.goTo( x, y );\n  } else {\n    item.stagger( i * this.stagger );\n    item.moveTo( x, y );\n  }\n};\n\n/**\n * Any logic you want to do after each layout,\n * i.e. size the container\n */\nproto._postLayout = function() {\n  this.resizeContainer();\n};\n\nproto.resizeContainer = function() {\n  var isResizingContainer = this._getOption('resizeContainer');\n  if ( !isResizingContainer ) {\n    return;\n  }\n  var size = this._getContainerSize();\n  if ( size ) {\n    this._setContainerMeasure( size.width, true );\n    this._setContainerMeasure( size.height, false );\n  }\n};\n\n/**\n * Sets width or height of container if returned\n * @returns {Object} size\n *   @param {Number} width\n *   @param {Number} height\n */\nproto._getContainerSize = noop;\n\n/**\n * @param {Number} measure - size of width or height\n * @param {Boolean} isWidth\n */\nproto._setContainerMeasure = function( measure, isWidth ) {\n  if ( measure === undefined ) {\n    return;\n  }\n\n  var elemSize = this.size;\n  // add padding and border width if border box\n  if ( elemSize.isBorderBox ) {\n    measure += isWidth ? elemSize.paddingLeft + elemSize.paddingRight +\n      elemSize.borderLeftWidth + elemSize.borderRightWidth :\n      elemSize.paddingBottom + elemSize.paddingTop +\n      elemSize.borderTopWidth + elemSize.borderBottomWidth;\n  }\n\n  measure = Math.max( measure, 0 );\n  this.element.style[ isWidth ? 'width' : 'height' ] = measure + 'px';\n};\n\n/**\n * emit eventComplete on a collection of items events\n * @param {String} eventName\n * @param {Array} items - Outlayer.Items\n */\nproto._emitCompleteOnItems = function( eventName, items ) {\n  var _this = this;\n  function onComplete() {\n    _this.dispatchEvent( eventName + 'Complete', null, [ items ] );\n  }\n\n  var count = items.length;\n  if ( !items || !count ) {\n    onComplete();\n    return;\n  }\n\n  var doneCount = 0;\n  function tick() {\n    doneCount++;\n    if ( doneCount == count ) {\n      onComplete();\n    }\n  }\n\n  // bind callback\n  items.forEach( function( item ) {\n    item.once( eventName, tick );\n  });\n};\n\n/**\n * emits events via EvEmitter and jQuery events\n * @param {String} type - name of event\n * @param {Event} event - original event\n * @param {Array} args - extra arguments\n */\nproto.dispatchEvent = function( type, event, args ) {\n  // add original event to arguments\n  var emitArgs = event ? [ event ].concat( args ) : args;\n  this.emitEvent( type, emitArgs );\n\n  if ( jQuery ) {\n    // set this.$element\n    this.$element = this.$element || jQuery( this.element );\n    if ( event ) {\n      // create jQuery event\n      var $event = jQuery.Event( event );\n      $event.type = type;\n      this.$element.trigger( $event, args );\n    } else {\n      // just trigger with type if no event available\n      this.$element.trigger( type, args );\n    }\n  }\n};\n\n// -------------------------- ignore & stamps -------------------------- //\n\n\n/**\n * keep item in collection, but do not lay it out\n * ignored items do not get skipped in layout\n * @param {Element} elem\n */\nproto.ignore = function( elem ) {\n  var item = this.getItem( elem );\n  if ( item ) {\n    item.isIgnored = true;\n  }\n};\n\n/**\n * return item to layout collection\n * @param {Element} elem\n */\nproto.unignore = function( elem ) {\n  var item = this.getItem( elem );\n  if ( item ) {\n    delete item.isIgnored;\n  }\n};\n\n/**\n * adds elements to stamps\n * @param {NodeList, Array, Element, or String} elems\n */\nproto.stamp = function( elems ) {\n  elems = this._find( elems );\n  if ( !elems ) {\n    return;\n  }\n\n  this.stamps = this.stamps.concat( elems );\n  // ignore\n  elems.forEach( this.ignore, this );\n};\n\n/**\n * removes elements to stamps\n * @param {NodeList, Array, or Element} elems\n */\nproto.unstamp = function( elems ) {\n  elems = this._find( elems );\n  if ( !elems ){\n    return;\n  }\n\n  elems.forEach( function( elem ) {\n    // filter out removed stamp elements\n    utils.removeFrom( this.stamps, elem );\n    this.unignore( elem );\n  }, this );\n};\n\n/**\n * finds child elements\n * @param {NodeList, Array, Element, or String} elems\n * @returns {Array} elems\n */\nproto._find = function( elems ) {\n  if ( !elems ) {\n    return;\n  }\n  // if string, use argument as selector string\n  if ( typeof elems == 'string' ) {\n    elems = this.element.querySelectorAll( elems );\n  }\n  elems = utils.makeArray( elems );\n  return elems;\n};\n\nproto._manageStamps = function() {\n  if ( !this.stamps || !this.stamps.length ) {\n    return;\n  }\n\n  this._getBoundingRect();\n\n  this.stamps.forEach( this._manageStamp, this );\n};\n\n// update boundingLeft / Top\nproto._getBoundingRect = function() {\n  // get bounding rect for container element\n  var boundingRect = this.element.getBoundingClientRect();\n  var size = this.size;\n  this._boundingRect = {\n    left: boundingRect.left + size.paddingLeft + size.borderLeftWidth,\n    top: boundingRect.top + size.paddingTop + size.borderTopWidth,\n    right: boundingRect.right - ( size.paddingRight + size.borderRightWidth ),\n    bottom: boundingRect.bottom - ( size.paddingBottom + size.borderBottomWidth )\n  };\n};\n\n/**\n * @param {Element} stamp\n**/\nproto._manageStamp = noop;\n\n/**\n * get x/y position of element relative to container element\n * @param {Element} elem\n * @returns {Object} offset - has left, top, right, bottom\n */\nproto._getElementOffset = function( elem ) {\n  var boundingRect = elem.getBoundingClientRect();\n  var thisRect = this._boundingRect;\n  var size = getSize( elem );\n  var offset = {\n    left: boundingRect.left - thisRect.left - size.marginLeft,\n    top: boundingRect.top - thisRect.top - size.marginTop,\n    right: thisRect.right - boundingRect.right - size.marginRight,\n    bottom: thisRect.bottom - boundingRect.bottom - size.marginBottom\n  };\n  return offset;\n};\n\n// -------------------------- resize -------------------------- //\n\n// enable event handlers for listeners\n// i.e. resize -> onresize\nproto.handleEvent = utils.handleEvent;\n\n/**\n * Bind layout to window resizing\n */\nproto.bindResize = function() {\n  window.addEventListener( 'resize', this );\n  this.isResizeBound = true;\n};\n\n/**\n * Unbind layout to window resizing\n */\nproto.unbindResize = function() {\n  window.removeEventListener( 'resize', this );\n  this.isResizeBound = false;\n};\n\nproto.onresize = function() {\n  this.resize();\n};\n\nutils.debounceMethod( Outlayer, 'onresize', 100 );\n\nproto.resize = function() {\n  // don't trigger if size did not change\n  // or if resize was unbound. See #9\n  if ( !this.isResizeBound || !this.needsResizeLayout() ) {\n    return;\n  }\n\n  this.layout();\n};\n\n/**\n * check if layout is needed post layout\n * @returns Boolean\n */\nproto.needsResizeLayout = function() {\n  var size = getSize( this.element );\n  // check that this.size and size are there\n  // IE8 triggers resize on body size change, so they might not be\n  var hasSizes = this.size && size;\n  return hasSizes && size.innerWidth !== this.size.innerWidth;\n};\n\n// -------------------------- methods -------------------------- //\n\n/**\n * add items to Outlayer instance\n * @param {Array or NodeList or Element} elems\n * @returns {Array} items - Outlayer.Items\n**/\nproto.addItems = function( elems ) {\n  var items = this._itemize( elems );\n  // add items to collection\n  if ( items.length ) {\n    this.items = this.items.concat( items );\n  }\n  return items;\n};\n\n/**\n * Layout newly-appended item elements\n * @param {Array or NodeList or Element} elems\n */\nproto.appended = function( elems ) {\n  var items = this.addItems( elems );\n  if ( !items.length ) {\n    return;\n  }\n  // layout and reveal just the new items\n  this.layoutItems( items, true );\n  this.reveal( items );\n};\n\n/**\n * Layout prepended elements\n * @param {Array or NodeList or Element} elems\n */\nproto.prepended = function( elems ) {\n  var items = this._itemize( elems );\n  if ( !items.length ) {\n    return;\n  }\n  // add items to beginning of collection\n  var previousItems = this.items.slice(0);\n  this.items = items.concat( previousItems );\n  // start new layout\n  this._resetLayout();\n  this._manageStamps();\n  // layout new stuff without transition\n  this.layoutItems( items, true );\n  this.reveal( items );\n  // layout previous items\n  this.layoutItems( previousItems );\n};\n\n/**\n * reveal a collection of items\n * @param {Array of Outlayer.Items} items\n */\nproto.reveal = function( items ) {\n  this._emitCompleteOnItems( 'reveal', items );\n  if ( !items || !items.length ) {\n    return;\n  }\n  var stagger = this.updateStagger();\n  items.forEach( function( item, i ) {\n    item.stagger( i * stagger );\n    item.reveal();\n  });\n};\n\n/**\n * hide a collection of items\n * @param {Array of Outlayer.Items} items\n */\nproto.hide = function( items ) {\n  this._emitCompleteOnItems( 'hide', items );\n  if ( !items || !items.length ) {\n    return;\n  }\n  var stagger = this.updateStagger();\n  items.forEach( function( item, i ) {\n    item.stagger( i * stagger );\n    item.hide();\n  });\n};\n\n/**\n * reveal item elements\n * @param {Array}, {Element}, {NodeList} items\n */\nproto.revealItemElements = function( elems ) {\n  var items = this.getItems( elems );\n  this.reveal( items );\n};\n\n/**\n * hide item elements\n * @param {Array}, {Element}, {NodeList} items\n */\nproto.hideItemElements = function( elems ) {\n  var items = this.getItems( elems );\n  this.hide( items );\n};\n\n/**\n * get Outlayer.Item, given an Element\n * @param {Element} elem\n * @param {Function} callback\n * @returns {Outlayer.Item} item\n */\nproto.getItem = function( elem ) {\n  // loop through items to get the one that matches\n  for ( var i=0; i < this.items.length; i++ ) {\n    var item = this.items[i];\n    if ( item.element == elem ) {\n      // return item\n      return item;\n    }\n  }\n};\n\n/**\n * get collection of Outlayer.Items, given Elements\n * @param {Array} elems\n * @returns {Array} items - Outlayer.Items\n */\nproto.getItems = function( elems ) {\n  elems = utils.makeArray( elems );\n  var items = [];\n  elems.forEach( function( elem ) {\n    var item = this.getItem( elem );\n    if ( item ) {\n      items.push( item );\n    }\n  }, this );\n\n  return items;\n};\n\n/**\n * remove element(s) from instance and DOM\n * @param {Array or NodeList or Element} elems\n */\nproto.remove = function( elems ) {\n  var removeItems = this.getItems( elems );\n\n  this._emitCompleteOnItems( 'remove', removeItems );\n\n  // bail if no items to remove\n  if ( !removeItems || !removeItems.length ) {\n    return;\n  }\n\n  removeItems.forEach( function( item ) {\n    item.remove();\n    // remove item from collection\n    utils.removeFrom( this.items, item );\n  }, this );\n};\n\n// ----- destroy ----- //\n\n// remove and disable Outlayer instance\nproto.destroy = function() {\n  // clean up dynamic styles\n  var style = this.element.style;\n  style.height = '';\n  style.position = '';\n  style.width = '';\n  // destroy items\n  this.items.forEach( function( item ) {\n    item.destroy();\n  });\n\n  this.unbindResize();\n\n  var id = this.element.outlayerGUID;\n  delete instances[ id ]; // remove reference to instance by id\n  delete this.element.outlayerGUID;\n  // remove data for jQuery\n  if ( jQuery ) {\n    jQuery.removeData( this.element, this.constructor.namespace );\n  }\n\n};\n\n// -------------------------- data -------------------------- //\n\n/**\n * get Outlayer instance from element\n * @param {Element} elem\n * @returns {Outlayer}\n */\nOutlayer.data = function( elem ) {\n  elem = utils.getQueryElement( elem );\n  var id = elem && elem.outlayerGUID;\n  return id && instances[ id ];\n};\n\n\n// -------------------------- create Outlayer class -------------------------- //\n\n/**\n * create a layout class\n * @param {String} namespace\n */\nOutlayer.create = function( namespace, options ) {\n  // sub-class Outlayer\n  var Layout = subclass( Outlayer );\n  // apply new options and compatOptions\n  Layout.defaults = utils.extend( {}, Outlayer.defaults );\n  utils.extend( Layout.defaults, options );\n  Layout.compatOptions = utils.extend( {}, Outlayer.compatOptions  );\n\n  Layout.namespace = namespace;\n\n  Layout.data = Outlayer.data;\n\n  // sub-class Item\n  Layout.Item = subclass( Item );\n\n  // -------------------------- declarative -------------------------- //\n\n  utils.htmlInit( Layout, namespace );\n\n  // -------------------------- jQuery bridge -------------------------- //\n\n  // make into jQuery plugin\n  if ( jQuery && jQuery.bridget ) {\n    jQuery.bridget( namespace, Layout );\n  }\n\n  return Layout;\n};\n\nfunction subclass( Parent ) {\n  function SubClass() {\n    Parent.apply( this, arguments );\n  }\n\n  SubClass.prototype = Object.create( Parent.prototype );\n  SubClass.prototype.constructor = SubClass;\n\n  return SubClass;\n}\n\n// ----- helpers ----- //\n\n// how many milliseconds are in each unit\nvar msUnits = {\n  ms: 1,\n  s: 1000\n};\n\n// munge time-like parameter into millisecond number\n// '0.4s' -> 40\nfunction getMilliseconds( time ) {\n  if ( typeof time == 'number' ) {\n    return time;\n  }\n  var matches = time.match( /(^\\d*\\.?\\d*)(\\w*)/ );\n  var num = matches && matches[1];\n  var unit = matches && matches[2];\n  if ( !num.length ) {\n    return 0;\n  }\n  num = parseFloat( num );\n  var mult = msUnits[ unit ] || 1;\n  return num * mult;\n}\n\n// ----- fin ----- //\n\n// back in global\nOutlayer.Item = Item;\n\nreturn Outlayer;\n\n}));\n\n/**\n * Enviratope Item\n**/\n\n( function( window, factory ) {\n  // universal module definition\n  /* jshint strict: false */ /*globals define, module, require */\n  if ( typeof define == 'function' && define.amd ) {\n    // AMD\n    define( 'enviratope/item',[\n        'outlayer/outlayer'\n      ],\n      factory );\n  } else if ( typeof module == 'object' && module.exports ) {\n    // CommonJS\n    module.exports = factory(\n      require('outlayer')\n    );\n  } else {\n    // browser global\n    window.Enviratope = window.Enviratope || {};\n    window.Enviratope.Item = factory(\n      window.Outlayer\n    );\n  }\n\n}( window, function factory( Outlayer ) {\n'use strict';\n\n// -------------------------- Item -------------------------- //\n\n// sub-class Outlayer Item\nfunction Item() {\n  Outlayer.Item.apply( this, arguments );\n}\n\nvar proto = Item.prototype = Object.create( Outlayer.Item.prototype );\n\nvar _create = proto._create;\nproto._create = function() {\n  // assign id, used for original-order sorting\n  this.id = this.layout.itemGUID++;\n  _create.call( this );\n  this.sortData = {};\n};\n\nproto.updateSortData = function() {\n  if ( this.isIgnored ) {\n    return;\n  }\n  // default sorters\n  this.sortData.id = this.id;\n  // for backward compatibility\n  this.sortData['original-order'] = this.id;\n  this.sortData.random = Math.random();\n  // go thru getSortData obj and apply the sorters\n  var getSortData = this.layout.options.getSortData;\n  var sorters = this.layout._sorters;\n  for ( var key in getSortData ) {\n    var sorter = sorters[ key ];\n    this.sortData[ key ] = sorter( this.element, this );\n  }\n};\n\nvar _destroy = proto.destroy;\nproto.destroy = function() {\n  // call super\n  _destroy.apply( this, arguments );\n  // reset display, #741\n  this.css({\n    display: ''\n  });\n};\n\nreturn Item;\n\n}));\n\n/**\n * Enviratope LayoutMode\n */\n\n( function( window, factory ) {\n  // universal module definition\n  /* jshint strict: false */ /*globals define, module, require */\n  if ( typeof define == 'function' && define.amd ) {\n    // AMD\n    define( 'enviratope/layout-mode',[\n        'get-size/get-size',\n        'outlayer/outlayer'\n      ],\n      factory );\n  } else if ( typeof module == 'object' && module.exports ) {\n    // CommonJS\n    module.exports = factory(\n      require('get-size'),\n      require('outlayer')\n    );\n  } else {\n    // browser global\n    window.Enviratope = window.Enviratope || {};\n    window.Enviratope.LayoutMode = factory(\n      window.getSize,\n      window.Outlayer\n    );\n  }\n\n}( window, function factory( getSize, Outlayer ) {\n  'use strict';\n\n  // layout mode class\n  function LayoutMode( enviratope ) {\n    this.enviratope = enviratope;\n    // link properties\n    if ( enviratope ) {\n      this.options = enviratope.options[ this.namespace ];\n      this.element = enviratope.element;\n      this.items = enviratope.filteredItems;\n      this.size = enviratope.size;\n    }\n  }\n\n  var proto = LayoutMode.prototype;\n\n  /**\n   * some methods should just defer to default Outlayer method\n   * and reference the Enviratope instance as `this`\n  **/\n  var facadeMethods = [\n    '_resetLayout',\n    '_getItemLayoutPosition',\n    '_manageStamp',\n    '_getContainerSize',\n    '_getElementOffset',\n    'needsResizeLayout',\n    '_getOption'\n  ];\n\n  facadeMethods.forEach( function( methodName ) {\n    proto[ methodName ] = function() {\n      return Outlayer.prototype[ methodName ].apply( this.enviratope, arguments );\n    };\n  });\n\n  // -----  ----- //\n\n  // for horizontal layout modes, check vertical size\n  proto.needsVerticalResizeLayout = function() {\n    // don't trigger if size did not change\n    var size = getSize( this.enviratope.element );\n    // check that this.size and size are there\n    // IE8 triggers resize on body size change, so they might not be\n    var hasSizes = this.enviratope.size && size;\n    return hasSizes && size.innerHeight != this.enviratope.size.innerHeight;\n  };\n\n  // ----- measurements ----- //\n\n  proto._getMeasurement = function() {\n    this.enviratope._getMeasurement.apply( this, arguments );\n  };\n\n  proto.getColumnWidth = function() {\n    this.getSegmentSize( 'column', 'Width' );\n  };\n\n  proto.getRowHeight = function() {\n    this.getSegmentSize( 'row', 'Height' );\n  };\n\n  /**\n   * get columnWidth or rowHeight\n   * segment: 'column' or 'row'\n   * size 'Width' or 'Height'\n  **/\n  proto.getSegmentSize = function( segment, size ) {\n    var segmentName = segment + size;\n    var outerSize = 'outer' + size;\n    // columnWidth / outerWidth // rowHeight / outerHeight\n    this._getMeasurement( segmentName, outerSize );\n    // got rowHeight or columnWidth, we can chill\n    if ( this[ segmentName ] ) {\n      return;\n    }\n    // fall back to item of first element\n    var firstItemSize = this.getFirstItemSize();\n    this[ segmentName ] = firstItemSize && firstItemSize[ outerSize ] ||\n      // or size of container\n      this.enviratope.size[ 'inner' + size ];\n  };\n\n  proto.getFirstItemSize = function() {\n    var firstItem = this.enviratope.filteredItems[0];\n    return firstItem && firstItem.element && getSize( firstItem.element );\n  };\n\n  // ----- methods that should reference enviratope ----- //\n\n  proto.layout = function() {\n    this.enviratope.layout.apply( this.enviratope, arguments );\n  };\n\n  proto.getSize = function() {\n    this.enviratope.getSize();\n    this.size = this.enviratope.size;\n  };\n\n  // -------------------------- create -------------------------- //\n\n  LayoutMode.modes = {};\n\n  LayoutMode.create = function( namespace, options ) {\n\n    function Mode() {\n      LayoutMode.apply( this, arguments );\n    }\n\n    Mode.prototype = Object.create( proto );\n    Mode.prototype.constructor = Mode;\n\n    // default options\n    if ( options ) {\n      Mode.options = options;\n    }\n\n    Mode.prototype.namespace = namespace;\n    // register in Enviratope\n    LayoutMode.modes[ namespace ] = Mode;\n\n    return Mode;\n  };\n\n  return LayoutMode;\n\n}));\n\n/*!\n * Masonry v4.1.0\n * Cascading grid layout library\n * http://masonry.desandro.com\n * MIT License\n * by David DeSandro\n */\n\n( function( window, factory ) {\n  // universal module definition\n  /* jshint strict: false */ /*globals define, module, require */\n  if ( typeof define == 'function' && define.amd ) {\n    // AMD\n    define( 'masonry/masonry',[\n        'outlayer/outlayer',\n        'get-size/get-size'\n      ],\n      factory );\n  } else if ( typeof module == 'object' && module.exports ) {\n    // CommonJS\n    module.exports = factory(\n      require('outlayer'),\n      require('get-size')\n    );\n  } else {\n    // browser global\n    window.Masonry = factory(\n      window.Outlayer,\n      window.getSize\n    );\n  }\n\n}( window, function factory( Outlayer, getSize ) {\n\n\n\n// -------------------------- masonryDefinition -------------------------- //\n\n  // create an Outlayer layout class\n  var Masonry = Outlayer.create('masonry');\n  // isFitWidth -> fitWidth\n  Masonry.compatOptions.fitWidth = 'isFitWidth';\n\n  Masonry.prototype._resetLayout = function() {\n    this.getSize();\n    this._getMeasurement( 'columnWidth', 'outerWidth' );\n    this._getMeasurement( 'gutter', 'outerWidth' );\n    this.measureColumns();\n\n    // reset column Y\n    this.colYs = [];\n    for ( var i=0; i < this.cols; i++ ) {\n      this.colYs.push( 0 );\n    }\n\n    this.maxY = 0;\n  };\n\n  Masonry.prototype.measureColumns = function() {\n    this.getContainerWidth();\n    // if columnWidth is 0, default to outerWidth of first item\n    if ( !this.columnWidth ) {\n      var firstItem = this.items[0];\n      var firstItemElem = firstItem && firstItem.element;\n      // columnWidth fall back to item of first element\n      this.columnWidth = firstItemElem && getSize( firstItemElem ).outerWidth ||\n        // if first elem has no width, default to size of container\n        this.containerWidth;\n    }\n\n    var columnWidth = this.columnWidth += this.gutter;\n\n    // calculate columns\n    var containerWidth = this.containerWidth + this.gutter;\n    var cols = containerWidth / columnWidth;\n    // fix rounding errors, typically with gutters\n    var excess = columnWidth - containerWidth % columnWidth;\n    // if overshoot is less than a pixel, round up, otherwise floor it\n    var mathMethod = excess && excess < 1 ? 'round' : 'floor';\n    cols = Math[ mathMethod ]( cols );\n    this.cols = Math.max( cols, 1 );\n  };\n\n  Masonry.prototype.getContainerWidth = function() {\n    // container is parent if fit width\n    var isFitWidth = this._getOption('fitWidth');\n    var container = isFitWidth ? this.element.parentNode : this.element;\n    // check that this.size and size are there\n    // IE8 triggers resize on body size change, so they might not be\n    var size = getSize( container );\n    this.containerWidth = size && size.innerWidth;\n  };\n\n  Masonry.prototype._getItemLayoutPosition = function( item ) {\n    item.getSize();\n    // how many columns does this brick span\n    var remainder = item.size.outerWidth % this.columnWidth;\n    var mathMethod = remainder && remainder < 1 ? 'round' : 'ceil';\n    // round if off by 1 pixel, otherwise use ceil\n    var colSpan = Math[ mathMethod ]( item.size.outerWidth / this.columnWidth );\n    colSpan = Math.min( colSpan, this.cols );\n\n    var colGroup = this._getColGroup( colSpan );\n    // get the minimum Y value from the columns\n    var minimumY = Math.min.apply( Math, colGroup );\n    var shortColIndex = colGroup.indexOf( minimumY );\n\n    // position the brick\n    var position = {\n      x: this.columnWidth * shortColIndex,\n      y: minimumY\n    };\n\n    // apply setHeight to necessary columns\n    var setHeight = minimumY + item.size.outerHeight;\n    var setSpan = this.cols + 1 - colGroup.length;\n    for ( var i = 0; i < setSpan; i++ ) {\n      this.colYs[ shortColIndex + i ] = setHeight;\n    }\n\n    return position;\n  };\n\n  /**\n   * @param {Number} colSpan - number of columns the element spans\n   * @returns {Array} colGroup\n   */\n  Masonry.prototype._getColGroup = function( colSpan ) {\n    if ( colSpan < 2 ) {\n      // if brick spans only one column, use all the column Ys\n      return this.colYs;\n    }\n\n    var colGroup = [];\n    // how many different places could this brick fit horizontally\n    var groupCount = this.cols + 1 - colSpan;\n    // for each group potential horizontal position\n    for ( var i = 0; i < groupCount; i++ ) {\n      // make an array of colY values for that one group\n      var groupColYs = this.colYs.slice( i, i + colSpan );\n      // and get the max value of the array\n      colGroup[i] = Math.max.apply( Math, groupColYs );\n    }\n    return colGroup;\n  };\n\n  Masonry.prototype._manageStamp = function( stamp ) {\n    var stampSize = getSize( stamp );\n    var offset = this._getElementOffset( stamp );\n    // get the columns that this stamp affects\n    var isOriginLeft = this._getOption('originLeft');\n    var firstX = isOriginLeft ? offset.left : offset.right;\n    var lastX = firstX + stampSize.outerWidth;\n    var firstCol = Math.floor( firstX / this.columnWidth );\n    firstCol = Math.max( 0, firstCol );\n    var lastCol = Math.floor( lastX / this.columnWidth );\n    // lastCol should not go over if multiple of columnWidth #425\n    lastCol -= lastX % this.columnWidth ? 0 : 1;\n    lastCol = Math.min( this.cols - 1, lastCol );\n    // set colYs to bottom of the stamp\n\n    var isOriginTop = this._getOption('originTop');\n    var stampMaxY = ( isOriginTop ? offset.top : offset.bottom ) +\n      stampSize.outerHeight;\n    for ( var i = firstCol; i <= lastCol; i++ ) {\n      this.colYs[i] = Math.max( stampMaxY, this.colYs[i] );\n    }\n  };\n\n  Masonry.prototype._getContainerSize = function() {\n    this.maxY = Math.max.apply( Math, this.colYs );\n    var size = {\n      height: this.maxY\n    };\n\n    if ( this._getOption('fitWidth') ) {\n      size.width = this._getContainerFitWidth();\n    }\n\n    return size;\n  };\n\n  Masonry.prototype._getContainerFitWidth = function() {\n    var unusedCols = 0;\n    // count unused columns\n    var i = this.cols;\n    while ( --i ) {\n      if ( this.colYs[i] !== 0 ) {\n        break;\n      }\n      unusedCols++;\n    }\n    // fit container to columns that have been used\n    return ( this.cols - unusedCols ) * this.columnWidth - this.gutter;\n  };\n\n  Masonry.prototype.needsResizeLayout = function() {\n    var previousWidth = this.containerWidth;\n    this.getContainerWidth();\n    return previousWidth != this.containerWidth;\n  };\n\n  return Masonry;\n\n}));\n\n/*!\n * Masonry layout mode\n * sub-classes Masonry\n * http://masonry.desandro.com\n */\n\n( function( window, factory ) {\n  // universal module definition\n  /* jshint strict: false */ /*globals define, module, require */\n  if ( typeof define == 'function' && define.amd ) {\n    // AMD\n    define( 'enviratope/layout-modes/masonry',[\n        '../layout-mode',\n        'masonry/masonry'\n      ],\n      factory );\n  } else if ( typeof module == 'object' && module.exports ) {\n    // CommonJS\n    module.exports = factory(\n      require('../layout-mode'),\n      require('masonry-layout')\n    );\n  } else {\n    // browser global\n    factory(\n      window.Enviratope.LayoutMode,\n      window.Masonry\n    );\n  }\n\n}( window, function factory( LayoutMode, Masonry ) {\n'use strict';\n\n// -------------------------- masonryDefinition -------------------------- //\n\n  // create an Outlayer layout class\n  var MasonryMode = LayoutMode.create('masonry');\n\n  var proto = MasonryMode.prototype;\n\n  var keepModeMethods = {\n    _getElementOffset: true,\n    layout: true,\n    _getMeasurement: true\n  };\n\n  // inherit Masonry prototype\n  for ( var method in Masonry.prototype ) {\n    // do not inherit mode methods\n    if ( !keepModeMethods[ method ] ) {\n      proto[ method ] = Masonry.prototype[ method ];\n    }\n  }\n\n  var measureColumns = proto.measureColumns;\n  proto.measureColumns = function() {\n    // set items, used if measuring first item\n    this.items = this.enviratope.filteredItems;\n    measureColumns.call( this );\n  };\n\n  // point to mode options for fitWidth\n  var _getOption = proto._getOption;\n  proto._getOption = function( option ) {\n    if ( option == 'fitWidth' ) {\n      return this.options.isFitWidth !== undefined ?\n        this.options.isFitWidth : this.options.fitWidth;\n    }\n    return _getOption.apply( this.enviratope, arguments );\n  };\n\n  return MasonryMode;\n\n}));\n\n/**\n * fitRows layout mode\n */\n\n( function( window, factory ) {\n  // universal module definition\n  /* jshint strict: false */ /*globals define, module, require */\n  if ( typeof define == 'function' && define.amd ) {\n    // AMD\n    define( 'enviratope/layout-modes/fit-rows',[\n        '../layout-mode'\n      ],\n      factory );\n  } else if ( typeof exports == 'object' ) {\n    // CommonJS\n    module.exports = factory(\n      require('../layout-mode')\n    );\n  } else {\n    // browser global\n    factory(\n      window.Enviratope.LayoutMode\n    );\n  }\n\n}( window, function factory( LayoutMode ) {\n'use strict';\n\nvar FitRows = LayoutMode.create('fitRows');\n\nvar proto = FitRows.prototype;\n\nproto._resetLayout = function() {\n  this.x = 0;\n  this.y = 0;\n  this.maxY = 0;\n  this._getMeasurement( 'gutter', 'outerWidth' );\n};\n\nproto._getItemLayoutPosition = function( item ) {\n  item.getSize();\n\n  var itemWidth = item.size.outerWidth + this.gutter;\n  // if this element cannot fit in the current row\n  var containerWidth = this.enviratope.size.innerWidth + this.gutter;\n  if ( this.x !== 0 && itemWidth + this.x > containerWidth ) {\n    this.x = 0;\n    this.y = this.maxY;\n  }\n\n  var position = {\n    x: this.x,\n    y: this.y\n  };\n\n  this.maxY = Math.max( this.maxY, this.y + item.size.outerHeight );\n  this.x += itemWidth;\n\n  return position;\n};\n\nproto._getContainerSize = function() {\n  return { height: this.maxY };\n};\n\nreturn FitRows;\n\n}));\n\n/**\n * vertical layout mode\n */\n\n( function( window, factory ) {\n  // universal module definition\n  /* jshint strict: false */ /*globals define, module, require */\n  if ( typeof define == 'function' && define.amd ) {\n    // AMD\n    define( 'enviratope/layout-modes/vertical',[\n        '../layout-mode'\n      ],\n      factory );\n  } else if ( typeof module == 'object' && module.exports ) {\n    // CommonJS\n    module.exports = factory(\n      require('../layout-mode')\n    );\n  } else {\n    // browser global\n    factory(\n      window.Enviratope.LayoutMode\n    );\n  }\n\n}( window, function factory( LayoutMode ) {\n'use strict';\n\nvar Vertical = LayoutMode.create( 'vertical', {\n  horizontalAlignment: 0\n});\n\nvar proto = Vertical.prototype;\n\nproto._resetLayout = function() {\n  this.y = 0;\n};\n\nproto._getItemLayoutPosition = function( item ) {\n  item.getSize();\n  var x = ( this.enviratope.size.innerWidth - item.size.outerWidth ) *\n    this.options.horizontalAlignment;\n  var y = this.y;\n  this.y += item.size.outerHeight;\n  return { x: x, y: y };\n};\n\nproto._getContainerSize = function() {\n  return { height: this.y };\n};\n\nreturn Vertical;\n\n}));\n\n/*!\n * Enviratope v3.0.0\n *\n * Licensed GPLv3 for open source use\n * or Enviratope Commercial License for commercial use\n *\n * http://enviratope.metafizzy.co\n * Copyright 2016 Metafizzy\n */\n\n( function( window, factory ) {\n  // universal module definition\n  /* jshint strict: false */ /*globals define, module, require */\n  if ( typeof define == 'function' && define.amd ) {\n    // AMD\n    define( [\n        'outlayer/outlayer',\n        'get-size/get-size',\n        'desandro-matches-selector/matches-selector',\n        'fizzy-ui-utils/utils',\n        './enviratope-item',\n        './layout-mode',\n        // include default layout modes\n        './layout-modes/masonry',\n        './layout-modes/fit-rows',\n        './layout-modes/vertical'\n      ],\n      function( Outlayer, getSize, matchesSelector, utils, Item, LayoutMode ) {\n        return factory( window, Outlayer, getSize, matchesSelector, utils, Item, LayoutMode );\n      });\n  } else if ( typeof module == 'object' && module.exports ) {\n    // CommonJS\n    module.exports = factory(\n      window,\n      require('outlayer'),\n      require('get-size'),\n      require('desandro-matches-selector'),\n      require('fizzy-ui-utils'),\n      require('./enviratope-item'),\n      require('./layout-mode'),\n      // include default layout modes\n      require('./layout-modes/masonry'),\n      require('./layout-modes/fit-rows'),\n      require('./layout-modes/vertical')\n    );\n  } else {\n    // browser global\n    window.Enviratope = factory(\n      window,\n      window.Outlayer,\n      window.getSize,\n      window.matchesSelector,\n      window.fizzyUIUtils,\n      window.Enviratope.Item,\n      window.Enviratope.LayoutMode\n    );\n  }\n\n}( window, function factory( window, Outlayer, getSize, matchesSelector, utils,\n  Item, LayoutMode ) {\n\n\n\n// -------------------------- vars -------------------------- //\n\nvar jQuery = window.jQuery;\n\n// -------------------------- helpers -------------------------- //\n\nvar trim = String.prototype.trim ?\n  function( str ) {\n    return str.trim();\n  } :\n  function( str ) {\n    return str.replace( /^\\s+|\\s+$/g, '' );\n  };\n\n// -------------------------- enviratopeDefinition -------------------------- //\n\n  // create an Outlayer layout class\n  var Enviratope = Outlayer.create( 'enviratope', {\n    layoutMode: 'masonry',\n    isJQueryFiltering: true,\n    sortAscending: true\n  });\n\n  Enviratope.Item = Item;\n  Enviratope.LayoutMode = LayoutMode;\n\n  var proto = Enviratope.prototype;\n\n  proto._create = function() {\n    this.itemGUID = 0;\n    // functions that sort items\n    this._sorters = {};\n    this._getSorters();\n    // call super\n    Outlayer.prototype._create.call( this );\n\n    // create layout modes\n    this.modes = {};\n    // start filteredItems with all items\n    this.filteredItems = this.items;\n    // keep of track of sortBys\n    this.sortHistory = [ 'original-order' ];\n    // create from registered layout modes\n    for ( var name in LayoutMode.modes ) {\n      this._initLayoutMode( name );\n    }\n  };\n\n  proto.reloadItems = function() {\n    // reset item ID counter\n    this.itemGUID = 0;\n    // call super\n    Outlayer.prototype.reloadItems.call( this );\n  };\n\n  proto._itemize = function() {\n    var items = Outlayer.prototype._itemize.apply( this, arguments );\n    // assign ID for original-order\n    for ( var i=0; i < items.length; i++ ) {\n      var item = items[i];\n      item.id = this.itemGUID++;\n    }\n    this._updateItemsSortData( items );\n    return items;\n  };\n\n\n  // -------------------------- layout -------------------------- //\n\n  proto._initLayoutMode = function( name ) {\n    var Mode = LayoutMode.modes[ name ];\n    // set mode options\n    // HACK extend initial options, back-fill in default options\n    var initialOpts = this.options[ name ] || {};\n    this.options[ name ] = Mode.options ?\n      utils.extend( Mode.options, initialOpts ) : initialOpts;\n    // init layout mode instance\n    this.modes[ name ] = new Mode( this );\n  };\n\n\n  proto.layout = function() {\n    // if first time doing layout, do all magic\n    if ( !this._isLayoutInited && this._getOption('initLayout') ) {\n      this.arrange();\n      return;\n    }\n    this._layout();\n  };\n\n  // private method to be used in layout() & magic()\n  proto._layout = function() {\n    // don't animate first layout\n    var isInstant = this._getIsInstant();\n    // layout flow\n    this._resetLayout();\n    this._manageStamps();\n    this.layoutItems( this.filteredItems, isInstant );\n\n    // flag for initalized\n    this._isLayoutInited = true;\n  };\n\n  // filter + sort + layout\n  proto.arrange = function( opts ) {\n    // set any options pass\n    this.option( opts );\n    this._getIsInstant();\n    // filter, sort, and layout\n\n    // filter\n    var filtered = this._filter( this.items );\n    this.filteredItems = filtered.matches;\n\n    this._bindArrangeComplete();\n\n    if ( this._isInstant ) {\n      this._noTransition( this._hideReveal, [ filtered ] );\n    } else {\n      this._hideReveal( filtered );\n    }\n\n    this._sort();\n    this._layout();\n  };\n  // alias to _init for main plugin method\n  proto._init = proto.arrange;\n\n  proto._hideReveal = function( filtered ) {\n    this.reveal( filtered.needReveal );\n    this.hide( filtered.needHide );\n  };\n\n  // HACK\n  // Don't animate/transition first layout\n  // Or don't animate/transition other layouts\n  proto._getIsInstant = function() {\n    var isLayoutInstant = this._getOption('layoutInstant');\n    var isInstant = isLayoutInstant !== undefined ? isLayoutInstant :\n      !this._isLayoutInited;\n    this._isInstant = isInstant;\n    return isInstant;\n  };\n\n  // listen for layoutComplete, hideComplete and revealComplete\n  // to trigger arrangeComplete\n  proto._bindArrangeComplete = function() {\n    // listen for 3 events to trigger arrangeComplete\n    var isLayoutComplete, isHideComplete, isRevealComplete;\n    var _this = this;\n    function arrangeParallelCallback() {\n      if ( isLayoutComplete && isHideComplete && isRevealComplete ) {\n        _this.dispatchEvent( 'arrangeComplete', null, [ _this.filteredItems ] );\n      }\n    }\n    this.once( 'layoutComplete', function() {\n      isLayoutComplete = true;\n      arrangeParallelCallback();\n    });\n    this.once( 'hideComplete', function() {\n      isHideComplete = true;\n      arrangeParallelCallback();\n    });\n    this.once( 'revealComplete', function() {\n      isRevealComplete = true;\n      arrangeParallelCallback();\n    });\n  };\n\n  // -------------------------- filter -------------------------- //\n\n  proto._filter = function( items ) {\n    var filter = this.options.filter;\n    filter = filter || '*';\n    var matches = [];\n    var hiddenMatched = [];\n    var visibleUnmatched = [];\n\n    var test = this._getFilterTest( filter );\n\n    // test each item\n    for ( var i=0; i < items.length; i++ ) {\n      var item = items[i];\n      if ( item.isIgnored ) {\n        continue;\n      }\n      // add item to either matched or unmatched group\n      var isMatched = test( item );\n      // item.isFilterMatched = isMatched;\n      // add to matches if its a match\n      if ( isMatched ) {\n        matches.push( item );\n      }\n      // add to additional group if item needs to be hidden or revealed\n      if ( isMatched && item.isHidden ) {\n        hiddenMatched.push( item );\n      } else if ( !isMatched && !item.isHidden ) {\n        visibleUnmatched.push( item );\n      }\n    }\n\n    // return collections of items to be manipulated\n    return {\n      matches: matches,\n      needReveal: hiddenMatched,\n      needHide: visibleUnmatched\n    };\n  };\n\n  // get a jQuery, function, or a matchesSelector test given the filter\n  proto._getFilterTest = function( filter ) {\n    if ( jQuery && this.options.isJQueryFiltering ) {\n      // use jQuery\n      return function( item ) {\n        return jQuery( item.element ).is( filter );\n      };\n    }\n    if ( typeof filter == 'function' ) {\n      // use filter as function\n      return function( item ) {\n        return filter( item.element );\n      };\n    }\n    // default, use filter as selector string\n    return function( item ) {\n      return matchesSelector( item.element, filter );\n    };\n  };\n\n  // -------------------------- sorting -------------------------- //\n\n  /**\n   * @params {Array} elems\n   * @public\n   */\n  proto.updateSortData = function( elems ) {\n    // get items\n    var items;\n    if ( elems ) {\n      elems = utils.makeArray( elems );\n      items = this.getItems( elems );\n    } else {\n      // update all items if no elems provided\n      items = this.items;\n    }\n\n    this._getSorters();\n    this._updateItemsSortData( items );\n  };\n\n  proto._getSorters = function() {\n    var getSortData = this.options.getSortData;\n    for ( var key in getSortData ) {\n      var sorter = getSortData[ key ];\n      this._sorters[ key ] = mungeSorter( sorter );\n    }\n  };\n\n  /**\n   * @params {Array} items - of Enviratope.Items\n   * @private\n   */\n  proto._updateItemsSortData = function( items ) {\n    // do not update if no items\n    var len = items && items.length;\n\n    for ( var i=0; len && i < len; i++ ) {\n      var item = items[i];\n      item.updateSortData();\n    }\n  };\n\n  // ----- munge sorter ----- //\n\n  // encapsulate this, as we just need mungeSorter\n  // other functions in here are just for munging\n  var mungeSorter = ( function() {\n    // add a magic layer to sorters for convienent shorthands\n    // `.foo-bar` will use the text of .foo-bar querySelector\n    // `[foo-bar]` will use attribute\n    // you can also add parser\n    // `.foo-bar parseInt` will parse that as a number\n    function mungeSorter( sorter ) {\n      // if not a string, return function or whatever it is\n      if ( typeof sorter != 'string' ) {\n        return sorter;\n      }\n      // parse the sorter string\n      var args = trim( sorter ).split(' ');\n      var query = args[0];\n      // check if query looks like [an-attribute]\n      var attrMatch = query.match( /^\\[(.+)\\]$/ );\n      var attr = attrMatch && attrMatch[1];\n      var getValue = getValueGetter( attr, query );\n      // use second argument as a parser\n      var parser = Enviratope.sortDataParsers[ args[1] ];\n      // parse the value, if there was a parser\n      sorter = parser ? function( elem ) {\n        return elem && parser( getValue( elem ) );\n      } :\n      // otherwise just return value\n      function( elem ) {\n        return elem && getValue( elem );\n      };\n\n      return sorter;\n    }\n\n    // get an attribute getter, or get text of the querySelector\n    function getValueGetter( attr, query ) {\n      // if query looks like [foo-bar], get attribute\n      if ( attr ) {\n        return function getAttribute( elem ) {\n          return elem.getAttribute( attr );\n        };\n      }\n\n      // otherwise, assume its a querySelector, and get its text\n      return function getChildText( elem ) {\n        var child = elem.querySelector( query );\n        return child && child.textContent;\n      };\n    }\n\n    return mungeSorter;\n  })();\n\n  // parsers used in getSortData shortcut strings\n  Enviratope.sortDataParsers = {\n    'parseInt': function( val ) {\n      return parseInt( val, 10 );\n    },\n    'parseFloat': function( val ) {\n      return parseFloat( val );\n    }\n  };\n\n  // ----- sort method ----- //\n\n  // sort filteredItem order\n  proto._sort = function() {\n    var sortByOpt = this.options.sortBy;\n    if ( !sortByOpt ) {\n      return;\n    }\n    // concat all sortBy and sortHistory\n    var sortBys = [].concat.apply( sortByOpt, this.sortHistory );\n    // sort magic\n    var itemSorter = getItemSorter( sortBys, this.options.sortAscending );\n    this.filteredItems.sort( itemSorter );\n    // keep track of sortBy History\n    if ( sortByOpt != this.sortHistory[0] ) {\n      // add to front, oldest goes in last\n      this.sortHistory.unshift( sortByOpt );\n    }\n  };\n\n  // returns a function used for sorting\n  function getItemSorter( sortBys, sortAsc ) {\n    return function sorter( itemA, itemB ) {\n      // cycle through all sortKeys\n      for ( var i = 0; i < sortBys.length; i++ ) {\n        var sortBy = sortBys[i];\n        var a = itemA.sortData[ sortBy ];\n        var b = itemB.sortData[ sortBy ];\n        if ( a > b || a < b ) {\n          // if sortAsc is an object, use the value given the sortBy key\n          var isAscending = sortAsc[ sortBy ] !== undefined ? sortAsc[ sortBy ] : sortAsc;\n          var direction = isAscending ? 1 : -1;\n          return ( a > b ? 1 : -1 ) * direction;\n        }\n      }\n      return 0;\n    };\n  }\n\n  // -------------------------- methods -------------------------- //\n\n  // get layout mode\n  proto._mode = function() {\n    var layoutMode = this.options.layoutMode;\n    var mode = this.modes[ layoutMode ];\n    if ( !mode ) {\n      // TODO console.error\n      throw new Error( 'No layout mode: ' + layoutMode );\n    }\n    // HACK sync mode's options\n    // any options set after init for layout mode need to be synced\n    mode.options = this.options[ layoutMode ];\n    return mode;\n  };\n\n  proto._resetLayout = function() {\n    // trigger original reset layout\n    Outlayer.prototype._resetLayout.call( this );\n    this._mode()._resetLayout();\n  };\n\n  proto._getItemLayoutPosition = function( item  ) {\n    return this._mode()._getItemLayoutPosition( item );\n  };\n\n  proto._manageStamp = function( stamp ) {\n    this._mode()._manageStamp( stamp );\n  };\n\n  proto._getContainerSize = function() {\n    return this._mode()._getContainerSize();\n  };\n\n  proto.needsResizeLayout = function() {\n    return this._mode().needsResizeLayout();\n  };\n\n  // -------------------------- adding & removing -------------------------- //\n\n  // HEADS UP overwrites default Outlayer appended\n  proto.appended = function( elems ) {\n    var items = this.addItems( elems );\n    if ( !items.length ) {\n      return;\n    }\n    // filter, layout, reveal new items\n    var filteredItems = this._filterRevealAdded( items );\n    // add to filteredItems\n    this.filteredItems = this.filteredItems.concat( filteredItems );\n  };\n\n  // HEADS UP overwrites default Outlayer prepended\n  proto.prepended = function( elems ) {\n    var items = this._itemize( elems );\n    if ( !items.length ) {\n      return;\n    }\n    // start new layout\n    this._resetLayout();\n    this._manageStamps();\n    // filter, layout, reveal new items\n    var filteredItems = this._filterRevealAdded( items );\n    // layout previous items\n    this.layoutItems( this.filteredItems );\n    // add to items and filteredItems\n    this.filteredItems = filteredItems.concat( this.filteredItems );\n    this.items = items.concat( this.items );\n  };\n\n  proto._filterRevealAdded = function( items ) {\n    var filtered = this._filter( items );\n    this.hide( filtered.needHide );\n    // reveal all new items\n    this.reveal( filtered.matches );\n    // layout new items, no transition\n    this.layoutItems( filtered.matches, true );\n    return filtered.matches;\n  };\n\n  /**\n   * Filter, sort, and layout newly-appended item elements\n   * @param {Array or NodeList or Element} elems\n   */\n  proto.insert = function( elems ) {\n    var items = this.addItems( elems );\n    if ( !items.length ) {\n      return;\n    }\n    // append item elements\n    var i, item;\n    var len = items.length;\n    for ( i=0; i < len; i++ ) {\n      item = items[i];\n      this.element.appendChild( item.element );\n    }\n    // filter new stuff\n    var filteredInsertItems = this._filter( items ).matches;\n    // set flag\n    for ( i=0; i < len; i++ ) {\n      items[i].isLayoutInstant = true;\n    }\n    this.arrange();\n    // reset flag\n    for ( i=0; i < len; i++ ) {\n      delete items[i].isLayoutInstant;\n    }\n    this.reveal( filteredInsertItems );\n  };\n\n  var _remove = proto.remove;\n  proto.remove = function( elems ) {\n    elems = utils.makeArray( elems );\n    var removeItems = this.getItems( elems );\n    // do regular thing\n    _remove.call( this, elems );\n    // bail if no items to remove\n    var len = removeItems && removeItems.length;\n    // remove elems from filteredItems\n    for ( var i=0; len && i < len; i++ ) {\n      var item = removeItems[i];\n      // remove item from collection\n      utils.removeFrom( this.filteredItems, item );\n    }\n  };\n\n  proto.shuffle = function() {\n    // update random sortData\n    for ( var i=0; i < this.items.length; i++ ) {\n      var item = this.items[i];\n      item.sortData.random = Math.random();\n    }\n    this.options.sortBy = 'random';\n    this._sort();\n    this._layout();\n  };\n\n  /**\n   * trigger fn without transition\n   * kind of hacky to have this in the first place\n   * @param {Function} fn\n   * @param {Array} args\n   * @returns ret\n   * @private\n   */\n  proto._noTransition = function( fn, args ) {\n    // save transitionDuration before disabling\n    var transitionDuration = this.options.transitionDuration;\n    // disable transition\n    this.options.transitionDuration = 0;\n    // do it\n    var returnValue = fn.apply( this, args );\n    // re-enable transition for reveal\n    this.options.transitionDuration = transitionDuration;\n    return returnValue;\n  };\n\n  // ----- helper methods ----- //\n\n  /**\n   * getter method for getting filtered item elements\n   * @returns {Array} elems - collection of item elements\n   */\n  proto.getFilteredItemElements = function() {\n    return this.filteredItems.map( function( item ) {\n      return item.element;\n    });\n  };\n\n  // -----  ----- //\n\n  return Enviratope;\n\n}));","/*!\n * Justified Gallery - v3.6.2\n * http://miromannino.github.io/Justified-Gallery/\n * Copyright (c) 2016 Miro Mannino\n * Licensed under the MIT license.\n */\n(function($) {\n\n\tfunction hasScrollBar() {\n\t\treturn $( \"body\" ).height() > $( window ).height();\n\t}\n\t/**\n\t * Justified Gallery controller constructor\n\t *\n\t * @param $gallery the gallery to build\n\t * @param settings the settings (the defaults are in $.fn.justifiedGallery.defaults)\n\t * @constructor\n\t */\n\tvar JustifiedGallery = function ($gallery, settings) {\n\n\t\tthis.settings = settings;\n\t\tthis.checkSettings();\n\n\t\tthis.imgAnalyzerTimeout   = null;\n\t\tthis.entries              = null;\n\t\tthis.buildingRow          = {\n\t\t\tentriesBuff : [],\n\t\t\twidth : 0,\n\t\t\theight : 0,\n\t\t\taspectRatio : 0\n\t\t};\n\t\tthis.lastAnalyzedIndex    = -1;\n\t\tthis.yield                = {\n\t\t\tevery : 2, // do a flush every n flushes (must be greater than 1)\n\t\t\tflushed : 0 // flushed rows without a yield\n\t\t};\n\t\tthis.border               = settings.border >= 0 ? settings.border : settings.margins;\n\t\tthis.maxRowHeight         = this.retrieveMaxRowHeight();\n\t\tthis.suffixRanges         = this.retrieveSuffixRanges();\n\t\tthis.offY                 = this.border;\n\t\tthis.rows                 = 0;\n\t\tthis.spinner              = {\n\t\t\tphase : 0,\n\t\t\ttimeSlot : 150,\n\t\t\t$el : $( '<div class=\"spinner\"><span></span><span></span><span></span></div>' ),\n\t\t\tintervalId : null\n\t\t};\n\t\tthis.checkWidthIntervalId = null;\n\t\tthis.galleryWidth         = $gallery.width();\n\t\tthis.$gallery             = $gallery;\n\n\t};\n\n\t/** @returns {String} the best suffix given the width and the height */\n\tJustifiedGallery.prototype.getSuffix = function (width, height) {\n\t\tvar longestSide, i;\n\t\tlongestSide = (width > height) ? width : height;\n\t\tfor (i = 0; i < this.suffixRanges.length; i++) {\n\t\t\tif (longestSide <= this.suffixRanges[i]) {\n\t\t\t\treturn this.settings.sizeRangeSuffixes[this.suffixRanges[i]];\n\t\t\t}\n\t\t}\n\t\treturn this.settings.sizeRangeSuffixes[this.suffixRanges[i - 1]];\n\t};\n\n\t/**\n\t * Remove the suffix from the string\n\t *\n\t * @returns {string} a new string without the suffix\n\t */\n\tJustifiedGallery.prototype.removeSuffix = function (str, suffix) {\n\t\treturn str.substring( 0, str.length - suffix.length );\n\t};\n\n\t/**\n\t * @returns {boolean} a boolean to say if the suffix is contained in the str or not\n\t */\n\tJustifiedGallery.prototype.endsWith = function (str, suffix) {\n\t\treturn str.indexOf( suffix, str.length - suffix.length ) !== -1;\n\t};\n\n\t/**\n\t * Get the used suffix of a particular url\n\t *\n\t * @param str\n\t * @returns {String} return the used suffix\n\t */\n\tJustifiedGallery.prototype.getUsedSuffix = function (str) {\n\t\tfor (var si in this.settings.sizeRangeSuffixes) {\n\t\t\tif (this.settings.sizeRangeSuffixes.hasOwnProperty( si )) {\n\t\t\t\tif (this.settings.sizeRangeSuffixes[si].length === 0) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif (this.endsWith( str, this.settings.sizeRangeSuffixes[si] )) {\n\t\t\t\t\treturn this.settings.sizeRangeSuffixes[si];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn '';\n\t};\n\n\t/**\n\t * Given an image src, with the width and the height, returns the new image src with the\n\t * best suffix to show the best quality thumbnail.\n\t *\n\t * @returns {String} the suffix to use\n\t */\n\tJustifiedGallery.prototype.newSrc = function (imageSrc, imgWidth, imgHeight) {\n\t\tvar newImageSrc;\n\n\t\tif (this.settings.thumbnailPath) {\n\t\t\tnewImageSrc = this.settings.thumbnailPath( imageSrc, imgWidth, imgHeight );\n\t\t} else {\n\t\t\tvar matchRes = imageSrc.match( this.settings.extension );\n\t\t\tvar ext      = (matchRes !== null) ? matchRes[0] : '';\n\t\t\tnewImageSrc  = imageSrc.replace( this.settings.extension, '' );\n\t\t\tnewImageSrc  = this.removeSuffix( newImageSrc, this.getUsedSuffix( newImageSrc ) );\n\t\t\tnewImageSrc += this.getSuffix( imgWidth, imgHeight ) + ext;\n\t\t}\n\n\t\treturn newImageSrc;\n\t};\n\n\t/**\n\t * Shows the images that is in the given entry\n\t *\n\t * @param $entry the entry\n\t * @param callback the callback that is called when the show animation is finished\n\t */\n\tJustifiedGallery.prototype.showImg = function ($entry, callback) {\n\t\tif (this.settings.cssAnimation) {\n\t\t\t$entry.addClass( 'entry-visible' );\n\t\t\tif (callback) {\n\t\t\t\tcallback();\n\t\t\t}\n\t\t} else {\n\t\t\t$entry.stop().fadeTo( this.settings.imagesAnimationDuration, 1.0, callback );\n\t\t}\n\t};\n\n\t/**\n\t * Extract the image src form the image, looking from the 'safe-src', and if it can't be found, from the\n\t * 'src' attribute. It saves in the image data the 'jg.originalSrc' field, with the extracted src.\n\t *\n\t * @param $image the image to analyze\n\t * @returns {String} the extracted src\n\t */\n\tJustifiedGallery.prototype.extractImgSrcFromImage = function ($image) {\n\t\tvar imageSrc = (typeof $image.data( 'safe-src' ) !== 'undefined') ? $image.data( 'safe-src' ) : $image.attr( 'src' );\n\t\t$image.data( 'jg.originalSrc', imageSrc );\n\t\treturn imageSrc;\n\t};\n\n\t/** @returns {jQuery} the image in the given entry */\n\tJustifiedGallery.prototype.imgFromEntry = function ($entry) {\n\t\tvar $img = $entry.find( '> img' );\n\t\tif ($img.length === 0) {\n\t\t\t$img = $entry.find( '> a > img' );\n\t\t}\n\t\treturn $img.length === 0 ? null : $img;\n\t};\n\n\t/** @returns {jQuery} the caption in the given entry */\n\tJustifiedGallery.prototype.captionFromEntry = function ($entry) {\n\t\tvar $caption = $entry.find( '.caption' );\n\t\treturn $caption.length === 0 ? null : $caption;\n\t};\n\n\t/**\n\t * Display the entry\n\t *\n\t * @param {jQuery} $entry the entry to display\n\t * @param {int} x the x position where the entry must be positioned\n\t * @param y the y position where the entry must be positioned\n\t * @param imgWidth the image width\n\t * @param imgHeight the image height\n\t * @param rowHeight the row height of the row that owns the entry\n\t */\n\tJustifiedGallery.prototype.displayEntry = function ($entry, x, y, imgWidth, imgHeight, rowHeight) {\n\t\t$entry.width( imgWidth );\n\t\t$entry.height( rowHeight );\n\t\t$entry.css( 'top', y );\n\t\t$entry.css( 'left', x );\n\n\t\tvar $image = this.imgFromEntry( $entry );\n\t\tif ($image !== null) {\n\t\t\t$image.css( 'width', imgWidth );\n\t\t\t$image.css( 'height', imgHeight );\n\t\t\t$image.css( 'margin-left', - imgWidth / 2 );\n\t\t\t$image.css( 'margin-top', - imgHeight / 2 );\n\n\t\t\t// Image reloading for an high quality of thumbnails\n\t\t\tvar imageSrc    = $image.attr( 'src' );\n\t\t\tvar newImageSrc = this.newSrc( imageSrc, imgWidth, imgHeight );\n\n\t\t\t$image.one(\n\t\t\t\t'error',\n\t\t\t\tfunction () {\n\t\t\t\t\t$image.attr( 'src', $image.data( 'jg.originalSrc' ) ); // revert to the original thumbnail, we got it.\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tvar loadNewImage = function () {\n\t\t\t\tif (imageSrc !== newImageSrc) { // load the new image after the fadeIn\n\t\t\t\t\t$image.attr( 'src', newImageSrc );\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tif ($entry.data( 'jg.loaded' ) === 'skipped') {\n\t\t\t\tthis.onImageEvent(\n\t\t\t\t\timageSrc,\n\t\t\t\t\t$.proxy(\n\t\t\t\t\t\tfunction() {\n\t\t\t\t\t\t\tthis.showImg( $entry, loadNewImage );\n\t\t\t\t\t\t\t$entry.data( 'jg.loaded', true );\n\t\t\t\t\t\t},\n\t\t\t\t\t\tthis\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tthis.showImg( $entry, loadNewImage );\n\t\t\t}\n\n\t\t} else {\n\t\t\tthis.showImg( $entry );\n\t\t}\n\n\t\tthis.displayEntryCaption( $entry );\n\t};\n\n\t/**\n\t * Display the entry caption. If the caption element doesn't exists, it creates the caption using the 'alt'\n\t * or the 'title' attributes.\n\t *\n\t * @param {jQuery} $entry the entry to process\n\t */\n\tJustifiedGallery.prototype.displayEntryCaption = function ($entry) {\n\t\tvar $image = this.imgFromEntry( $entry );\n\t\tif ($image !== null && this.settings.captions) {\n\t\t\tvar $imgCaption = this.captionFromEntry( $entry );\n\n\t\t\t// Create it if it doesn't exists\n\t\t\tif ($imgCaption === null) {\n\t\t\t\tvar caption = $image.attr( 'alt' );\n\t\t\t\tif ( ! this.isValidCaption( caption )) {\n\t\t\t\t\tcaption = $entry.attr( 'title' );\n\t\t\t\t}\n\t\t\t\tif (this.isValidCaption( caption )) { // Create only we found something\n\t\t\t\t\t$imgCaption = $( '<div class=\"caption\">' + caption + '</div>' );\n\t\t\t\t\t$entry.append( $imgCaption );\n\t\t\t\t\t$entry.data( 'jg.createdCaption', true );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Create events (we check again the $imgCaption because it can be still inexistent)\n\t\t\tif ($imgCaption !== null) {\n\t\t\t\tif ( ! this.settings.cssAnimation) {\n\t\t\t\t\t$imgCaption.stop().fadeTo( 0, this.settings.captionSettings.nonVisibleOpacity );\n\t\t\t\t}\n\t\t\t\tthis.addCaptionEventsHandlers( $entry );\n\t\t\t}\n\t\t} else {\n\t\t\tthis.removeCaptionEventsHandlers( $entry );\n\t\t}\n\t};\n\n\t/**\n\t * Validates the caption\n\t *\n\t * @param caption The caption that should be validated\n\t * @return {boolean} Validation result\n\t */\n\tJustifiedGallery.prototype.isValidCaption = function (caption) {\n\t\treturn (typeof caption !== 'undefined' && caption.length > 0);\n\t};\n\n\t/**\n\t * The callback for the event 'mouseenter'. It assumes that the event currentTarget is an entry.\n\t * It shows the caption using jQuery (or using CSS if it is configured so)\n\t *\n\t * @param {Event} eventObject the event object\n\t */\n\tJustifiedGallery.prototype.onEntryMouseEnterForCaption = function (eventObject) {\n\t\tvar $caption = this.captionFromEntry( $( eventObject.currentTarget ) );\n\t\tif (this.settings.cssAnimation) {\n\t\t\tif (typeof $caption !== 'undefined' && $caption != null ) {\n\t\t\t\t$caption.addClass( 'caption-visible' ).removeClass( 'caption-hidden' );\n\t\t\t}\n\t\t} else {\n\t\t\tif (typeof $caption !== 'undefined' && $caption != null ) {\n\t\t\t\t$caption.stop().fadeTo(\n\t\t\t\t\tthis.settings.captionSettings.animationDuration,\n\t\t\t\t\tthis.settings.captionSettings.visibleOpacity\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t};\n\n\t/**\n\t * The callback for the event 'mouseleave'. It assumes that the event currentTarget is an entry.\n\t * It hides the caption using jQuery (or using CSS if it is configured so)\n\t *\n\t * @param {Event} eventObject the event object\n\t */\n\tJustifiedGallery.prototype.onEntryMouseLeaveForCaption = function (eventObject) {\n\t\tvar $caption = this.captionFromEntry( $( eventObject.currentTarget ) );\n\t\tif (this.settings.cssAnimation) {\n\t\t\tif (typeof $caption !== 'undefined' && $caption != null ) {\n\t\t\t\t$caption.removeClass( 'caption-visible' ).removeClass( 'caption-hidden' );\n\t\t\t}\n\t\t} else {\n\t\t\tif (typeof $caption !== 'undefined' && $caption != null ) {\n\t\t\t\t$caption.stop().fadeTo(\n\t\t\t\t\tthis.settings.captionSettings.animationDuration,\n\t\t\t\t\tthis.settings.captionSettings.nonVisibleOpacity\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t};\n\n\t/**\n\t * Add the handlers of the entry for the caption\n\t *\n\t * @param $entry the entry to modify\n\t */\n\tJustifiedGallery.prototype.addCaptionEventsHandlers = function ($entry) {\n\t\tvar captionMouseEvents = $entry.data( 'jg.captionMouseEvents' );\n\t\tif (typeof captionMouseEvents === 'undefined') {\n\t\t\tcaptionMouseEvents = {\n\t\t\t\tmouseenter: $.proxy( this.onEntryMouseEnterForCaption, this ),\n\t\t\t\tmouseleave: $.proxy( this.onEntryMouseLeaveForCaption, this )\n\t\t\t};\n\t\t\t$entry.on( 'mouseenter', undefined, undefined, captionMouseEvents.mouseenter );\n\t\t\t$entry.on( 'mouseleave', undefined, undefined, captionMouseEvents.mouseleave );\n\t\t\t$entry.data( 'jg.captionMouseEvents', captionMouseEvents );\n\t\t}\n\t};\n\n\t/**\n\t * Remove the handlers of the entry for the caption\n\t *\n\t * @param $entry the entry to modify\n\t */\n\tJustifiedGallery.prototype.removeCaptionEventsHandlers = function ($entry) {\n\t\tvar captionMouseEvents = $entry.data( 'jg.captionMouseEvents' );\n\t\tif (typeof captionMouseEvents !== 'undefined') {\n\t\t\t$entry.off( 'mouseenter', undefined, captionMouseEvents.mouseenter );\n\t\t\t$entry.off( 'mouseleave', undefined, captionMouseEvents.mouseleave );\n\t\t\t$entry.removeData( 'jg.captionMouseEvents' );\n\t\t}\n\t};\n\n\t/**\n\t * Justify the building row, preparing it to\n\t *\n\t * @param isLastRow\n\t * @returns a boolean to know if the row has been justified or not\n\t */\n\tJustifiedGallery.prototype.prepareBuildingRow = function (isLastRow) {\n\t\tvar i, $entry, imgAspectRatio, newImgW, newImgH, justify = true;\n\t\tvar minHeight        = 0;\n\t\tvar availableWidth   = this.galleryWidth - 2 * this.border - (\n\t\t(this.buildingRow.entriesBuff.length - 1) * this.settings.margins);\n\t\tvar rowHeight        = availableWidth / this.buildingRow.aspectRatio;\n\t\tvar defaultRowHeight = this.settings.rowHeight;\n\t\tvar justifiable      = this.buildingRow.width / availableWidth > this.settings.justifyThreshold;\n\n\t\t// Skip the last row if we can't justify it and the lastRow == 'hide'\n\t\tif (isLastRow && this.settings.lastRow === 'hide' && ! justifiable) {\n\t\t\tfor (i = 0; i < this.buildingRow.entriesBuff.length; i++) {\n\t\t\t\t$entry = this.buildingRow.entriesBuff[i];\n\t\t\t\tif (this.settings.cssAnimation) {\n\t\t\t\t\t$entry.removeClass( 'entry-visible' );\n\t\t\t\t} else {\n\t\t\t\t\t$entry.stop().fadeTo( 0, 0 );\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn -1;\n\t\t}\n\n\t\t// With lastRow = nojustify, justify if is justificable (the images will not become too big)\n\t\tif (isLastRow && ! justifiable && this.settings.lastRow !== 'justify' && this.settings.lastRow !== 'hide') {\n\t\t\tjustify = false;\n\n\t\t\tif (this.rows > 0) {\n\t\t\t\tdefaultRowHeight = (this.offY - this.border - this.settings.margins * this.rows) / this.rows;\n\t\t\t\tif (defaultRowHeight * this.buildingRow.aspectRatio / availableWidth > this.settings.justifyThreshold) {\n\t\t\t\t\tjustify = true;\n\t\t\t\t} else {\n\t\t\t\t\tjustify = false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor (i = 0; i < this.buildingRow.entriesBuff.length; i++) {\n\t\t\t$entry         = this.buildingRow.entriesBuff[i];\n\t\t\timgAspectRatio = $entry.data( 'jg.width' ) / $entry.data( 'jg.height' );\n\n\t\t\tif (justify) {\n\t\t\t\tnewImgW = (i === this.buildingRow.entriesBuff.length - 1) ? availableWidth : rowHeight * imgAspectRatio;\n\t\t\t\tnewImgH = rowHeight;\n\n\t\t\t\t/* With fixedHeight the newImgH must be greater than rowHeight.\n\t\t\t\t In some cases here this is not satisfied (due to the justification).\n\t\t\t\t But we comment it, because is better to have a shorter but justified row instead\n\t\t\t\t to have a cropped image at the end. */\n\t\t\t\t/*if (this.settings.fixedHeight && newImgH < this.settings.rowHeight) {\n\t\t\t\t newImgW = this.settings.rowHeight * imgAspectRatio;\n\t\t\t\t newImgH = this.settings.rowHeight;\n\t\t\t\t }*/\n\n\t\t\t} else {\n\t\t\t\tnewImgW = defaultRowHeight * imgAspectRatio;\n\t\t\t\tnewImgH = defaultRowHeight;\n\t\t\t}\n\n\t\t\tavailableWidth -= Math.round( newImgW );\n\t\t\t$entry.data( 'jg.jwidth', Math.round( newImgW ) );\n\t\t\t$entry.data( 'jg.jheight', Math.ceil( newImgH ) );\n\t\t\tif (i === 0 || minHeight > newImgH) {\n\t\t\t\tminHeight = newImgH;\n\t\t\t}\n\t\t}\n\n\t\tif (this.settings.fixedHeight && minHeight > this.settings.rowHeight) {\n\t\t\tminHeight = this.settings.rowHeight;\n\t\t}\n\n\t\tthis.buildingRow.height = minHeight;\n\t\treturn justify;\n\t};\n\n\t/**\n\t * Clear the building row data to be used for a new row\n\t */\n\tJustifiedGallery.prototype.clearBuildingRow = function () {\n\t\tthis.buildingRow.entriesBuff = [];\n\t\tthis.buildingRow.aspectRatio = 0;\n\t\tthis.buildingRow.width       = 0;\n\t};\n\n\t/**\n\t * Flush a row: justify it, modify the gallery height accordingly to the row height\n\t *\n\t * @param isLastRow\n\t */\n\tJustifiedGallery.prototype.flushRow = function (isLastRow) {\n\t\tvar settings                     = this.settings;\n\t\tvar $entry, buildingRowRes, offX = this.border, i;\n\n\t\tbuildingRowRes = this.prepareBuildingRow( isLastRow );\n\t\tif (isLastRow && settings.lastRow === 'hide' && buildingRowRes === -1) {\n\t\t\tthis.clearBuildingRow();\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.maxRowHeight.isPercentage) {\n\t\t\tif (this.maxRowHeight.value * settings.rowHeight < this.buildingRow.height) {\n\t\t\t\tthis.buildingRow.height = this.maxRowHeight.value * settings.rowHeight;\n\t\t\t}\n\t\t} else {\n\t\t\tif (this.maxRowHeight.value > 0 && this.maxRowHeight.value < this.buildingRow.height) {\n\t\t\t\tthis.buildingRow.height = this.maxRowHeight.value;\n\t\t\t}\n\t\t}\n\n\t\t// Align last (unjustified) row\n\t\tif (settings.lastRow === 'center' || settings.lastRow === 'right') {\n\t\t\tvar availableWidth = this.galleryWidth - 2 * this.border - (this.buildingRow.entriesBuff.length - 1) * settings.margins;\n\n\t\t\tfor (i = 0; i < this.buildingRow.entriesBuff.length; i++) {\n\t\t\t\t$entry          = this.buildingRow.entriesBuff[i];\n\t\t\t\tavailableWidth -= $entry.data( 'jg.jwidth' );\n\t\t\t}\n\n\t\t\tif (settings.lastRow === 'center') {\n\t\t\t\toffX += availableWidth / 2;\n\t\t\t} else if (settings.lastRow === 'right') {\n\t\t\t\toffX += availableWidth;\n\t\t\t}\n\t\t}\n\n\t\tfor (i = 0; i < this.buildingRow.entriesBuff.length; i++) {\n\t\t\t$entry = this.buildingRow.entriesBuff[i];\n\t\t\tthis.displayEntry( $entry, offX, this.offY, $entry.data( 'jg.jwidth' ), $entry.data( 'jg.jheight' ), this.buildingRow.height );\n\t\t\toffX += $entry.data( 'jg.jwidth' ) + settings.margins;\n\t\t}\n\n\t\t// Gallery Height\n\t\tthis.galleryHeightToSet = this.offY + this.buildingRow.height + this.border;\n\t\tthis.$gallery.height( this.galleryHeightToSet + this.getSpinnerHeight() );\n\n\t\tif ( ! isLastRow || (this.buildingRow.height <= settings.rowHeight && buildingRowRes)) {\n\t\t\t// Ready for a new row\n\t\t\tthis.offY += this.buildingRow.height + settings.margins;\n\t\t\tthis.rows += 1;\n\t\t\tthis.clearBuildingRow();\n\t\t\tthis.$gallery.trigger( 'jg.rowflush' );\n\t\t}\n\t};\n\n\t/**\n\t * Checks the width of the gallery container, to know if a new justification is needed\n\t */\n\tvar scrollBarOn                       = false;\n\tJustifiedGallery.prototype.checkWidth = function () {\n\t\tthis.checkWidthIntervalId = setInterval(\n\t\t\t$.proxy(\n\t\t\t\tfunction () {\n\t\t\t\t\tvar galleryWidth = parseFloat( this.$gallery.width() );\n\t\t\t\t\tif (hasScrollBar() === scrollBarOn) {\n\n\t\t\t\t\t\tif (Math.abs( galleryWidth - this.galleryWidth ) > this.settings.refreshSensitivity) {\n\t\t\t\t\t\t\tthis.galleryWidth = galleryWidth;\n\t\t\t\t\t\t\tthis.rewind();\n\n\t\t\t\t\t\t\t// Restart to analyze\n\t\t\t\t\t\t\tthis.startImgAnalyzer( true );\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tscrollBarOn       = hasScrollBar();\n\t\t\t\t\t\tthis.galleryWidth = galleryWidth;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tthis\n\t\t\t),\n\t\t\tthis.settings.refreshTime\n\t\t);\n\t};\n\n\t/**\n\t * @returns {boolean} a boolean saying if the spinner is active or not\n\t */\n\tJustifiedGallery.prototype.isSpinnerActive = function () {\n\t\treturn this.spinner.intervalId !== null;\n\t};\n\n\t/**\n\t * @returns {int} the spinner height\n\t */\n\tJustifiedGallery.prototype.getSpinnerHeight = function () {\n\t\treturn this.spinner.$el.innerHeight();\n\t};\n\n\t/**\n\t * Stops the spinner animation and modify the gallery height to exclude the spinner\n\t */\n\tJustifiedGallery.prototype.stopLoadingSpinnerAnimation = function () {\n\t\tclearInterval( this.spinner.intervalId );\n\t\tthis.spinner.intervalId = null;\n\t\tthis.$gallery.height( this.$gallery.height() - this.getSpinnerHeight() );\n\t\tthis.spinner.$el.detach();\n\t};\n\n\t/**\n\t * Starts the spinner animation\n\t */\n\tJustifiedGallery.prototype.startLoadingSpinnerAnimation = function () {\n\t\tvar spinnerContext = this.spinner;\n\t\tvar $spinnerPoints = spinnerContext.$el.find( 'span' );\n\t\tclearInterval( spinnerContext.intervalId );\n\t\tthis.$gallery.append( spinnerContext.$el );\n\t\tthis.$gallery.height( this.offY + this.buildingRow.height + this.getSpinnerHeight() );\n\t\tspinnerContext.intervalId = setInterval(\n\t\t\tfunction () {\n\t\t\t\tif (spinnerContext.phase < $spinnerPoints.length) {\n\t\t\t\t\t$spinnerPoints.eq( spinnerContext.phase ).fadeTo( spinnerContext.timeSlot, 1 );\n\t\t\t\t} else {\n\t\t\t\t\t$spinnerPoints.eq( spinnerContext.phase - $spinnerPoints.length ).fadeTo( spinnerContext.timeSlot, 0 );\n\t\t\t\t}\n\t\t\t\tspinnerContext.phase = (spinnerContext.phase + 1) % ($spinnerPoints.length * 2);\n\t\t\t},\n\t\t\tspinnerContext.timeSlot\n\t\t);\n\t};\n\n\t/**\n\t * Rewind the image analysis to start from the first entry.\n\t */\n\tJustifiedGallery.prototype.rewind = function () {\n\t\tthis.lastAnalyzedIndex = -1;\n\t\tthis.offY              = this.border;\n\t\tthis.rows              = 0;\n\t\tthis.clearBuildingRow();\n\t};\n\n\t/**\n\t * Update the entries searching it from the justified gallery HTML element\n\t *\n\t * @param norewind if norewind only the new entries will be changed (i.e. randomized, sorted or filtered)\n\t * @returns {boolean} true if some entries has been founded\n\t */\n\tJustifiedGallery.prototype.updateEntries = function (norewind) {\n\t\tthis.entries = this.$gallery.find( this.settings.selector ).toArray();\n\t\tif (this.entries.length === 0) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Filter\n\t\tif (this.settings.filter) {\n\t\t\tthis.modifyEntries( this.filterArray, norewind );\n\t\t} else {\n\t\t\tthis.modifyEntries( this.resetFilters, norewind );\n\t\t}\n\n\t\t// Sort or randomize\n\t\tif ($.isFunction( this.settings.sort )) {\n\t\t\tthis.modifyEntries( this.sortArray, norewind );\n\t\t} else if (this.settings.randomize) {\n\t\t\tthis.modifyEntries( this.shuffleArray, norewind );\n\t\t}\n\n\t\treturn true;\n\t};\n\n\t/**\n\t * Apply the entries order to the DOM, iterating the entries and appending the images\n\t *\n\t * @param entries the entries that has been modified and that must be re-ordered in the DOM\n\t */\n\tJustifiedGallery.prototype.insertToGallery = function (entries) {\n\t\tvar that = this;\n\t\t$.each(\n\t\t\tentries,\n\t\t\tfunction () {\n\t\t\t\t$( this ).appendTo( that.$gallery );\n\t\t\t}\n\t\t);\n\t};\n\n\t/**\n\t * Shuffle the array using the Fisher-Yates shuffle algorithm\n\t *\n\t * @param a the array to shuffle\n\t * @return the shuffled array\n\t */\n\tJustifiedGallery.prototype.shuffleArray = function (a) {\n\t\tvar i, j, temp;\n\t\tfor (i = a.length - 1; i > 0; i--) {\n\t\t\tj    = Math.floor( Math.random() * (i + 1) );\n\t\t\ttemp = a[i];\n\t\t\ta[i] = a[j];\n\t\t\ta[j] = temp;\n\t\t}\n\t\tthis.insertToGallery( a );\n\t\treturn a;\n\t};\n\n\t/**\n\t * Sort the array using settings.comparator as comparator\n\t *\n\t * @param a the array to sort (it is sorted)\n\t * @return the sorted array\n\t */\n\tJustifiedGallery.prototype.sortArray = function (a) {\n\t\ta.sort( this.settings.sort );\n\t\tthis.insertToGallery( a );\n\t\treturn a;\n\t};\n\n\t/**\n\t * Reset the filters removing the 'jg-filtered' class from all the entries\n\t *\n\t * @param a the array to reset\n\t */\n\tJustifiedGallery.prototype.resetFilters = function (a) {\n\t\tfor (var i = 0; i < a.length; i++) {\n\t\t\t$( a[i] ).removeClass( 'jg-filtered' );\n\t\t}\n\t\treturn a;\n\t};\n\n\t/**\n\t * Filter the entries considering theirs classes (if a string has been passed) or using a function for filtering.\n\t *\n\t * @param a the array to filter\n\t * @return the filtered array\n\t */\n\tJustifiedGallery.prototype.filterArray = function (a) {\n\t\tvar settings = this.settings;\n\t\tif ($.type( settings.filter ) === 'string') {\n\t\t\t// Filter only keeping the entries passed in the string\n\t\t\treturn a.filter(\n\t\t\t\tfunction (el) {\n\t\t\t\t\tvar $el = $( el );\n\t\t\t\t\tif ($el.is( settings.filter )) {\n\t\t\t\t\t\t$el.removeClass( 'jg-filtered' );\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$el.addClass( 'jg-filtered' );\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t\t} else if ($.isFunction( settings.filter )) {\n\t\t\t// Filter using the passed function\n\t\t\treturn a.filter( settings.filter );\n\t\t}\n\t};\n\n\t/**\n\t * Modify the entries. With norewind only the new inserted images will be modified (the ones after lastAnalyzedIndex)\n\t *\n\t * @param functionToApply the function to call to modify the entries (e.g. sorting, randomization, filtering)\n\t * @param norewind specify if the norewind has been called or not\n\t */\n\tJustifiedGallery.prototype.modifyEntries = function (functionToApply, norewind) {\n\t\tvar lastEntries = norewind ?\n\t\tthis.entries.splice( this.lastAnalyzedIndex + 1, this.entries.length - this.lastAnalyzedIndex - 1 )\n\t\t: this.entries;\n\t\tlastEntries     = functionToApply.call( this, lastEntries );\n\t\tthis.entries    = norewind ? this.entries.concat( lastEntries ) : lastEntries;\n\t};\n\n\t/**\n\t * Destroy the Justified Gallery instance.\n\t *\n\t * It clears all the css properties added in the style attributes. We doesn't backup the original\n\t * values for those css attributes, because it costs (performance) and because in general one\n\t * shouldn't use the style attribute for an uniform set of images (where we suppose the use of\n\t * classes). Creating a backup is also difficult because JG could be called multiple times and\n\t * with different style attributes.\n\t */\n\tJustifiedGallery.prototype.destroy = function () {\n\t\tclearInterval( this.checkWidthIntervalId );\n\n\t\t$.each(\n\t\t\tthis.entries,\n\t\t\t$.proxy(\n\t\t\t\tfunction(_, entry) {\n\t\t\t\t\tvar $entry = $( entry );\n\n\t\t\t\t\t// Reset entry style\n\t\t\t\t\t$entry.css( 'width', '' );\n\t\t\t\t\t$entry.css( 'height', '' );\n\t\t\t\t\t$entry.css( 'top', '' );\n\t\t\t\t\t$entry.css( 'left', '' );\n\t\t\t\t\t$entry.data( 'jg.loaded', undefined );\n\t\t\t\t\t$entry.removeClass( 'jg-entry' );\n\n\t\t\t\t\t// Reset image style\n\t\t\t\t\tvar $img = this.imgFromEntry( $entry );\n\t\t\t\t\t$img.css( 'width', '' );\n\t\t\t\t\t$img.css( 'height', '' );\n\t\t\t\t\t$img.css( 'margin-left', '' );\n\t\t\t\t\t$img.css( 'margin-top', '' );\n\t\t\t\t\t$img.attr( 'src', $img.data( 'jg.originalSrc' ) );\n\t\t\t\t\t$img.data( 'jg.originalSrc', undefined );\n\n\t\t\t\t\t// Remove caption\n\t\t\t\t\tthis.removeCaptionEventsHandlers( $entry );\n\t\t\t\t\tvar $caption = this.captionFromEntry( $entry );\n\t\t\t\t\tif ($entry.data( 'jg.createdCaption' )) {\n\t\t\t\t\t\t// remove also the caption element (if created by jg)\n\t\t\t\t\t\t$entry.data( 'jg.createdCaption', undefined );\n\t\t\t\t\t\tif ($caption !== null) {\n\t\t\t\t\t\t\t$caption.remove();\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif ($caption !== null) {\n\t\t\t\t\t\t\t$caption.fadeTo( 0, 1 );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t},\n\t\t\t\tthis\n\t\t\t)\n\t\t);\n\n\t\tthis.$gallery.css( 'height', '' );\n\t\tthis.$gallery.removeClass( 'envira-justified-gallery' );\n\t\tthis.$gallery.data( 'jg.controller', undefined );\n\t};\n\n\t/**\n\t * Analyze the images and builds the rows. It returns if it found an image that is not loaded.\n\t *\n\t * @param isForResize if the image analyzer is called for resizing or not, to call a different callback at the end\n\t */\n\tJustifiedGallery.prototype.analyzeImages = function (isForResize) {\n\t\tfor (var i = this.lastAnalyzedIndex + 1; i < this.entries.length; i++) {\n\t\t\tvar $entry = $( this.entries[i] );\n\t\t\tif ($entry.data( 'jg.loaded' ) === true || $entry.data( 'jg.loaded' ) === 'skipped') {\n\t\t\t\tvar availableWidth = this.galleryWidth - 2 * this.border - (\n\t\t\t\t(this.buildingRow.entriesBuff.length - 1) * this.settings.margins);\n\t\t\t\tvar imgAspectRatio = $entry.data( 'jg.width' ) / $entry.data( 'jg.height' );\n\t\t\t\tif (availableWidth / (this.buildingRow.aspectRatio + imgAspectRatio) < this.settings.rowHeight) {\n\t\t\t\t\t  this.flushRow( false );\n\t\t\t\t\tif (++this.yield.flushed >= this.yield.every) {\n\t\t\t\t\t\tthis.startImgAnalyzer( isForResize );\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis.buildingRow.entriesBuff.push( $entry );\n\t\t\t\tthis.buildingRow.aspectRatio += imgAspectRatio;\n\t\t\t\tthis.buildingRow.width       += imgAspectRatio * this.settings.rowHeight;\n\t\t\t\tthis.lastAnalyzedIndex        = i;\n\n\t\t\t} else if ($entry.data( 'jg.loaded' ) !== 'error') {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\t// Last row flush (the row is not full)\n\t\tif (this.buildingRow.entriesBuff.length > 0) {\n\t\t\tthis.flushRow( true );\n\t\t}\n\n\t\tif (this.isSpinnerActive()) {\n\t\t\tthis.stopLoadingSpinnerAnimation();\n\t\t}\n\n\t\t/* Stop, if there is, the timeout to start the analyzeImages.\n\t\tThis is because an image can be set loaded, and the timeout can be set,\n\t\tbut this image can be analyzed yet.\n\t\t*/\n\t\tthis.stopImgAnalyzerStarter();\n\n\t\t// On complete callback\n\t\tthis.$gallery.trigger( isForResize ? 'jg.resize' : 'jg.complete' );\n\t\tthis.$gallery.height( this.galleryHeightToSet );\n\t};\n\n\t/**\n\t * Stops any ImgAnalyzer starter (that has an assigned timeout)\n\t */\n\tJustifiedGallery.prototype.stopImgAnalyzerStarter = function () {\n\t\tthis.yield.flushed = 0;\n\t\tif (this.imgAnalyzerTimeout !== null) {\n\t\t\tclearTimeout( this.imgAnalyzerTimeout );\n\t\t}\n\t};\n\n\t/**\n\t * Starts the image analyzer. It is not immediately called to let the browser to update the view\n\t *\n\t * @param isForResize specifies if the image analyzer must be called for resizing or not\n\t */\n\tJustifiedGallery.prototype.startImgAnalyzer = function (isForResize) {\n\t\tvar that = this;\n\t\tthis.stopImgAnalyzerStarter();\n\t\tthis.imgAnalyzerTimeout = setTimeout(\n\t\t\tfunction () {\n\t\t\t\tthat.analyzeImages( isForResize );\n\t\t\t},\n\t\t\t0.001\n\t\t); // we can't start it immediately due to a IE different behaviour\n\t};\n\n\t/**\n\t * Checks if the image is loaded or not using another image object. We cannot use the 'complete' image property,\n\t * because some browsers, with a 404 set complete = true.\n\t *\n\t * @param imageSrc the image src to load\n\t * @param onLoad callback that is called when the image has been loaded\n\t * @param onError callback that is called in case of an error\n\t */\n\tJustifiedGallery.prototype.onImageEvent = function (imageSrc, onLoad, onError) {\n\t\tif ( ! onLoad && ! onError) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar memImage  = new Image();\n\t\tvar $memImage = $( memImage );\n\t\tif (onLoad) {\n\t\t\t$memImage.one(\n\t\t\t\t'load',\n\t\t\t\tfunction () {\n\t\t\t\t\t$memImage.off( 'load error' );\n\t\t\t\t\tonLoad( memImage );\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\tif (onError) {\n\t\t\t$memImage.one(\n\t\t\t\t'error',\n\t\t\t\tfunction() {\n\t\t\t\t\t$memImage.off( 'load error' );\n\t\t\t\t\tonError( memImage );\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\tmemImage.src = imageSrc;\n\t};\n\n\t/**\n\t * Init of Justified Gallery controlled\n\t * It analyzes all the entries starting theirs loading and calling the image analyzer (that works with loaded images)\n\t */\n\tJustifiedGallery.prototype.init = function () {\n\t\tvar imagesToLoad = false, skippedImages = false, that = this;\n\t\t$.each(\n\t\t\tthis.entries,\n\t\t\tfunction (index, entry) {\n\t\t\t\tvar $entry = $( entry );\n\t\t\t\tvar $image = that.imgFromEntry( $entry );\n\n\t\t\t\t$entry.addClass( 'jg-entry' );\n\n\t\t\t\tif ($entry.data( 'jg.loaded' ) !== true && $entry.data( 'jg.loaded' ) !== 'skipped') {\n\n\t\t\t\t\t// Link Rel global overwrite\n\t\t\t\t\tif (that.settings.rel !== null) {\n\t\t\t\t\t\t$entry.attr( 'rel', that.settings.rel );\n\t\t\t\t\t}\n\n\t\t\t\t\t// Link Target global overwrite\n\t\t\t\t\tif (that.settings.target !== null) {\n\t\t\t\t\t\t$entry.attr( 'target', that.settings.target );\n\t\t\t\t\t}\n\n\t\t\t\t\tif ($image !== null) {\n\n\t\t\t\t\t\t// Image src\n\t\t\t\t\t\tvar imageSrc = that.extractImgSrcFromImage( $image );\n\t\t\t\t\t\t$image.attr( 'src', imageSrc );\n\n\t\t\t\t\t\t/* If we have the height and the width, we don't wait that the image is loaded, but we start directly\n\t\t\t\t\t\t* with the justification */\n\t\t\t\t\t\tif (that.settings.waitThumbnailsLoad === false) {\n\t\t\t\t\t\t\tvar width  = parseFloat( $image.attr( 'width' ) );\n\t\t\t\t\t\t\tvar height = parseFloat( $image.attr( 'height' ) );\n\t\t\t\t\t\t\tif ( ! isNaN( width ) && ! isNaN( height )) {\n\t\t\t\t\t\t\t\t$entry.data( 'jg.width', width );\n\t\t\t\t\t\t\t\t$entry.data( 'jg.height', height );\n\t\t\t\t\t\t\t\t$entry.data( 'jg.loaded', 'skipped' );\n\t\t\t\t\t\t\t\tskippedImages = true;\n\t\t\t\t\t\t\t\tthat.startImgAnalyzer( false );\n\t\t\t\t\t\t\t\treturn true; // continue\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t$entry.data( 'jg.loaded', false );\n\t\t\t\t\t\timagesToLoad = true;\n\n\t\t\t\t\t\t// Spinner start\n\t\t\t\t\t\tif ( ! that.isSpinnerActive()) {\n\t\t\t\t\t\t\tthat.startLoadingSpinnerAnimation();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthat.onImageEvent(\n\t\t\t\t\t\t\timageSrc,\n\t\t\t\t\t\t\tfunction (loadImg) { // image loaded\n\t\t\t\t\t\t\t\t$entry.data( 'jg.width', $entry.find( '.envira-gallery-image' ).data( 'envira-width' ) );\n\t\t\t\t\t\t\t\t$entry.data( 'jg.height', $entry.find( '.envira-gallery-image' ).data( 'envira-height' ) );\n\n\t\t\t\t\t\t\t\t$entry.data( 'jg.loaded', true );\n\n\t\t\t\t\t\t\t\tthat.startImgAnalyzer( false );\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tfunction () { // image load error\n\t\t\t\t\t\t\t\t$entry.data( 'jg.loaded', 'error' );\n\t\t\t\t\t\t\t\tthat.startImgAnalyzer( false );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$entry.data( 'jg.loaded', true );\n\t\t\t\t\t\t$entry.data( 'jg.width', $entry.width() | parseFloat( $entry.css( 'width' ) ) | 1 );\n\t\t\t\t\t\t$entry.data( 'jg.height', $entry.height() | parseFloat( $entry.css( 'height' ) ) | 1 );\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t);\n\n\t\tif ( ! imagesToLoad && ! skippedImages) {\n\t\t\tthis.startImgAnalyzer( false );\n\t\t}\n\t\tthis.checkWidth();\n\t};\n\n\t/**\n\t * Checks that it is a valid number. If a string is passed it is converted to a number\n\t *\n\t * @param settingContainer the object that contains the setting (to allow the conversion)\n\t * @param settingName the setting name\n\t */\n\tJustifiedGallery.prototype.checkOrConvertNumber = function (settingContainer, settingName) {\n\t\tif ($.type( settingContainer[settingName] ) === 'string') {\n\t\t\tsettingContainer[settingName] = parseFloat( settingContainer[settingName] );\n\t\t}\n\n\t\tif ($.type( settingContainer[settingName] ) === 'number') {\n\t\t\tif (isNaN( settingContainer[settingName] )) {\n\t\t\t\tthrow 'invalid number for ' + settingName;\n\t\t\t}\n\t\t} else {\n\t\t\tthrow settingName + ' must be a number';\n\t\t}\n\t};\n\n\t/**\n\t * Checks the sizeRangeSuffixes and, if necessary, converts\n\t * its keys from string (e.g. old settings with 'lt100') to int.\n\t */\n\tJustifiedGallery.prototype.checkSizeRangesSuffixes = function () {\n\t\tif ($.type( this.settings.sizeRangeSuffixes ) !== 'object') {\n\t\t\tthrow 'sizeRangeSuffixes must be defined and must be an object';\n\t\t}\n\n\t\tvar suffixRanges = [];\n\t\tfor (var rangeIdx in this.settings.sizeRangeSuffixes) {\n\t\t\tif (this.settings.sizeRangeSuffixes.hasOwnProperty( rangeIdx )) {\n\t\t\t\tsuffixRanges.push( rangeIdx );\n\t\t\t}\n\t\t}\n\n\t\tvar newSizeRngSuffixes = {0: ''};\n\t\tfor (var i = 0; i < suffixRanges.length; i++) {\n\t\t\tif ($.type( suffixRanges[i] ) === 'string') {\n\t\t\t\ttry {\n\t\t\t\t\tvar numIdx                 = parseInt( suffixRanges[i].replace( /^[a-z]+/, '' ), 10 );\n\t\t\t\t\tnewSizeRngSuffixes[numIdx] = this.settings.sizeRangeSuffixes[suffixRanges[i]];\n\t\t\t\t} catch (e) {\n\t\t\t\t\tthrow 'sizeRangeSuffixes keys must contains correct numbers (' + e + ')';\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tnewSizeRngSuffixes[suffixRanges[i]] = this.settings.sizeRangeSuffixes[suffixRanges[i]];\n\t\t\t}\n\t\t}\n\n\t\tthis.settings.sizeRangeSuffixes = newSizeRngSuffixes;\n\t};\n\n\t/**\n\t * check and convert the maxRowHeight setting\n\t */\n\tJustifiedGallery.prototype.retrieveMaxRowHeight = function () {\n\t\tvar newMaxRowHeight = { };\n\n\t\tif ($.type( this.settings.maxRowHeight ) === 'string') {\n\t\t\tif (this.settings.maxRowHeight.match( /^[0-9]+%$/ )) {\n\t\t\t\tnewMaxRowHeight.value        = parseFloat( this.settings.maxRowHeight.match( /^([0-9]+)%$/ )[1] ) / 100;\n\t\t\t\tnewMaxRowHeight.isPercentage = false;\n\t\t\t} else {\n\t\t\t\tnewMaxRowHeight.value        = parseFloat( this.settings.maxRowHeight );\n\t\t\t\tnewMaxRowHeight.isPercentage = true;\n\t\t\t}\n\t\t} else if ($.type( this.settings.maxRowHeight ) === 'number') {\n\t\t\tnewMaxRowHeight.value        = this.settings.maxRowHeight;\n\t\t\tnewMaxRowHeight.isPercentage = false;\n\t\t} else {\n\t\t\tthrow 'maxRowHeight must be a number or a percentage';\n\t\t}\n\n\t\t// check if the converted value is not a number\n\t\tif (isNaN( newMaxRowHeight.value )) {\n\t\t\tthrow 'invalid number for maxRowHeight';\n\t\t}\n\n\t\t// check values\n\t\tif (newMaxRowHeight.isPercentage) {\n\t\t\tif (newMaxRowHeight.value < 100) {\n\t\t\t\tnewMaxRowHeight.value = 100;\n\t\t\t}\n\t\t} else {\n\t\t\tif (newMaxRowHeight.value > 0 && newMaxRowHeight.value < this.settings.rowHeight) {\n\t\t\t\tnewMaxRowHeight.value = this.settings.rowHeight;\n\t\t\t}\n\t\t}\n\n\t\treturn newMaxRowHeight;\n\n\t};\n\n\t/**\n\t * Checks the settings\n\t */\n\tJustifiedGallery.prototype.checkSettings = function () {\n\t\tthis.checkSizeRangesSuffixes();\n\n\t\tthis.checkOrConvertNumber( this.settings, 'rowHeight' );\n\t\tthis.checkOrConvertNumber( this.settings, 'margins' );\n\t\tthis.checkOrConvertNumber( this.settings, 'border' );\n\n\t\tvar lastRowModes = [\n\t\t'justify',\n\t\t'nojustify',\n\t\t'left',\n\t\t'center',\n\t\t'right',\n\t\t'hide'\n\t\t];\n\t\tif (lastRowModes.indexOf( this.settings.lastRow ) === -1) {\n\t\t\tthrow 'lastRow must be one of: ' + lastRowModes.join( ', ' );\n\t\t}\n\n\t\tthis.checkOrConvertNumber( this.settings, 'justifyThreshold' );\n\t\tif (this.settings.justifyThreshold < 0 || this.settings.justifyThreshold > 1) {\n\t\t\tthrow 'justifyThreshold must be in the interval [0,1]';\n\t\t}\n\t\tif ($.type( this.settings.cssAnimation ) !== 'boolean') {\n\t\t\tthrow 'cssAnimation must be a boolean';\n\t\t}\n\n\t\tif ($.type( this.settings.captions ) !== 'boolean') {\n\t\t\tthrow 'captions must be a boolean';\n\t\t}\n\t\tthis.checkOrConvertNumber( this.settings.captionSettings, 'animationDuration' );\n\n\t\tthis.checkOrConvertNumber( this.settings.captionSettings, 'visibleOpacity' );\n\t\tif (this.settings.captionSettings.visibleOpacity < 0 ||\n\t\tthis.settings.captionSettings.visibleOpacity > 1) {\n\t\t\tthrow 'captionSettings.visibleOpacity must be in the interval [0, 1]';\n\t\t}\n\n\t\tthis.checkOrConvertNumber( this.settings.captionSettings, 'nonVisibleOpacity' );\n\t\tif (this.settings.captionSettings.nonVisibleOpacity < 0 ||\n\t\tthis.settings.captionSettings.nonVisibleOpacity > 1) {\n\t\t\tthrow 'captionSettings.nonVisibleOpacity must be in the interval [0, 1]';\n\t\t}\n\n\t\tif ($.type( this.settings.fixedHeight ) !== 'boolean') {\n\t\t\tthrow 'fixedHeight must be a boolean';\n\t\t}\n\t\tthis.checkOrConvertNumber( this.settings, 'imagesAnimationDuration' );\n\t\tthis.checkOrConvertNumber( this.settings, 'refreshTime' );\n\t\tthis.checkOrConvertNumber( this.settings, 'refreshSensitivity' );\n\t\tif ($.type( this.settings.randomize ) !== 'boolean') {\n\t\t\tthrow 'randomize must be a boolean';\n\t\t}\n\t\tif ($.type( this.settings.selector ) !== 'string') {\n\t\t\tthrow 'selector must be a string';\n\t\t}\n\n\t\tif (this.settings.sort !== false && ! $.isFunction( this.settings.sort )) {\n\t\t\tthrow 'sort must be false or a comparison function';\n\t\t}\n\n\t\tif (this.settings.filter !== false && ! $.isFunction( this.settings.filter ) &&\n\t\t$.type( this.settings.filter ) !== 'string') {\n\t\t\tthrow 'filter must be false, a string or a filter function';\n\t\t}\n\t};\n\n\t/**\n\t * It brings all the indexes from the sizeRangeSuffixes and it orders them. They are then sorted and returned.\n\t *\n\t * @returns {Array} sorted suffix ranges\n\t */\n\tJustifiedGallery.prototype.retrieveSuffixRanges = function () {\n\t\tvar suffixRanges = [];\n\t\tfor (var rangeIdx in this.settings.sizeRangeSuffixes) {\n\t\t\tif (this.settings.sizeRangeSuffixes.hasOwnProperty( rangeIdx )) {\n\t\t\t\tsuffixRanges.push( parseInt( rangeIdx, 10 ) );\n\t\t\t}\n\t\t}\n\t\tsuffixRanges.sort( function (a, b) { return a > b ? 1 : a < b ? -1 : 0; } );\n\t\treturn suffixRanges;\n\t};\n\n\t/**\n\t * Update the existing settings only changing some of them\n\t *\n\t * @param newSettings the new settings (or a subgroup of them)\n\t */\n\tJustifiedGallery.prototype.updateSettings = function (newSettings) {\n\t\t// In this case Justified Gallery has been called again changing only some options\n\t\tthis.settings = $.extend( {}, this.settings, newSettings );\n\t\tthis.checkSettings();\n\n\t\t// As reported in the settings: negative value = same as margins, 0 = disabled\n\t\tthis.border = this.settings.border >= 0 ? this.settings.border : this.settings.margins;\n\n\t\tthis.maxRowHeight = this.retrieveMaxRowHeight();\n\t\tthis.suffixRanges = this.retrieveSuffixRanges();\n\t};\n\n\t/**\n\t * Justified Gallery plugin for jQuery\n\t *\n\t * Events\n\t *  - jg.complete : called when all the gallery has been created\n\t *  - jg.resize : called when the gallery has been resized\n\t *  - jg.rowflush : when a new row appears\n\t *\n\t * @param arg the action (or the settings) passed when the plugin is called\n\t * @returns {*} the object itself\n\t */\n\t$.fn.justifiedGallery = function (arg) {\n\t\treturn this.each(\n\t\t\tfunction (index, gallery) {\n\n\t\t\t\tvar $gallery = $( gallery );\n\n\t\t\t\t$gallery.addClass( 'envira-justified-gallery' );\n\n\t\t\t\tvar controller = $gallery.data( 'jg.controller' );\n\t\t\t\tif (typeof controller === 'undefined') {\n\t\t\t\t\t// Create controller and assign it to the object data\n\t\t\t\t\tif (typeof arg !== 'undefined' && arg !== null && $.type( arg ) !== 'object') {\n\t\t\t\t\t\tif (arg === 'destroy') {\n\t\t\t\t\t\t\treturn; // Just a call to an unexisting object\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthrow 'The argument must be an object';\n\t\t\t\t\t}\n\t\t\t\t\tcontroller = new JustifiedGallery( $gallery, $.extend( {}, $.fn.justifiedGallery.defaults, arg ) );\n\t\t\t\t\t$gallery.data( 'jg.controller', controller );\n\t\t\t\t} else if (arg === 'norewind') {\n\t\t\t\t\t// In this case we don't rewind: we analyze only the latest images (e.g. to complete the last unfinished row\n\t\t\t\t\t// ... left to be more readable\n\t\t\t\t} else if (arg === 'destroy') {\n\t\t\t\t\tcontroller.destroy();\n\t\t\t\t\treturn;\n\t\t\t\t} else {\n\t\t\t\t\t// In this case Justified Gallery has been called again changing only some options\n\t\t\t\t\tcontroller.updateSettings( arg );\n\t\t\t\t\tcontroller.rewind();\n\t\t\t\t}\n\n\t\t\t\t// Update the entries list\n\t\t\t\tif ( ! controller.updateEntries( arg === 'norewind' )) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// Init justified gallery\n\t\t\t\tcontroller.init();\n\n\t\t\t}\n\t\t);\n\t};\n\n\t// Default options\n\t$.fn.justifiedGallery.defaults = {\n\t\tsizeRangeSuffixes: { }, /* e.g. Flickr configuration\n\t\t{\n\t\t  100: '_t',  // used when longest is less than 100px\n\t\t  240: '_m',  // used when longest is between 101px and 240px\n\t\t  320: '_n',  // ...\n\t\t  500: '',\n\t\t  640: '_z',\n\t\t  1024: '_b'  // used as else case because it is the last\n\t\t}\n\t\t*/\n\t\tthumbnailPath: undefined, /* If defined, sizeRangeSuffixes is not used, and this function is used to determine the\n\t\tpath relative to a specific thumbnail size. The function should accept respectively three arguments:\n\t\tcurrent path, width and height */\n\t\trowHeight: 120,\n\t\tmaxRowHeight: -1, // negative value = no limits, number to express the value in pixels,\n\t\t\t\t\t\t  // '[0-9]+%' to express in percentage (e.g. 300% means that the row height\n\t\t\t\t\t\t  // can't exceed 3 * rowHeight)\n\t\tmargins: 1,\n\t\tborder: -1, // negative value = same as margins, 0 = disabled, any other value to set the border\n\n\t\tlastRow: 'nojustify', // … which is the same as 'left', or can be 'justify', 'center', 'right' or 'hide'\n\n\t\tjustifyThreshold: 0.90, /* if row width / available space > 0.90 it will be always justified\n\t\t\t\t\t\t\t * (i.e. lastRow setting is not considered) */\n\t\tfixedHeight: false,\n\t\twaitThumbnailsLoad: true,\n\t\tcaptions: true,\n\t\tcssAnimation: false,\n\t\timagesAnimationDuration: 500, // ignored with css animations\n\t\tcaptionSettings: { // ignored with css animations\n\t\t\tanimationDuration: 500,\n\t\t\tvisibleOpacity: 0.7,\n\t\t\tnonVisibleOpacity: 0.0\n\t\t},\n\t\trel: null, // rewrite the rel of each analyzed links\n\t\ttarget: null, // rewrite the target of all links\n\t\textension: /\\.[^.\\\\/] + $ / , // regexp to capture the extension of an image\n\t\trefreshTime: 100, // time interval (in ms) to check if the page changes its width\n\t\trefreshSensitivity: 0, // change in width allowed (in px) without re-building the gallery\n\t\trandomize: false,\n\t\tsort: false, /*\n\t\t- false: to do not sort\n\t\t- function: to sort them using the function as comparator (see Array.prototype.sort())\n\t\t*/\n\t\tfilter: false, /*\n\t\t- false: for a disabled filter\n\t\t- a string: an entry is kept if entry.is(filter string) returns true\n\t\t\t\t  see jQuery's .is() function for further information\n\t\t- a function: invoked with arguments (entry, index, array). Return true to keep the entry, false otherwise.\n\t\t\t\t\tsee Array.prototype.filter for further information.\n\t\t*/\n\t\tselector: '> a, > div:not(.spinner)' // The selector that is used to know what are the entries of the gallery\n\t};\n\n}(jQuery));\n","/**\n * Isotope LayoutMode\n */\n\n( function( window, factory ) {\n\t// universal module definition\n\t/* jshint strict: false */ /*globals define, module, require */\n\tif ( typeof define == 'function' && define.amd ) {\n\t\t// AMD\n\t\tdefine(\n\t\t\t[\n\t\t\t'get-size/get-size',\n\t\t\t'outlayer/outlayer'\n\t\t\t],\n\t\t\tfactory\n\t\t);\n\t} else if ( typeof module == 'object' && module.exports ) {\n\t\t// CommonJS\n\t\tmodule.exports = factory(\n\t\t\trequire( 'get-size' ),\n\t\t\trequire( 'outlayer' )\n\t\t);\n\t} else {\n\t\t// browser global\n\t\twindow.Isotope            = window.Isotope || {};\n\t\twindow.Isotope.LayoutMode = factory(\n\t\t\twindow.getSize,\n\t\t\twindow.Outlayer\n\t\t);\n\t}\n\n}( window, function factory( getSize, Outlayer ) {\n\t'use strict';\n\n\t// layout mode class\n\tfunction LayoutMode( isotope ) {\n\t\tthis.isotope = isotope;\n\t\t// link properties\n\t\tif ( isotope ) {\n\t\t\tthis.options = isotope.options[ this.namespace ];\n\t\t\tthis.element = isotope.element;\n\t\t\tthis.items   = isotope.filteredItems;\n\t\t\tthis.size    = isotope.size;\n\t\t}\n\t}\n\n\tvar proto = LayoutMode.prototype;\n\n\t/**\n\t * some methods should just defer to default Outlayer method\n\t * and reference the Isotope instance as `this`\n\t **/\n\tvar facadeMethods = [\n\t'_resetLayout',\n\t'_getItemLayoutPosition',\n\t'_manageStamp',\n\t'_getContainerSize',\n\t'_getElementOffset',\n\t'needsResizeLayout',\n\t'_getOption'\n\t];\n\n\tfacadeMethods.forEach(\n\t\tfunction( methodName ) {\n\t\t\tproto[ methodName ] = function() {\n\t\t\t\t  return Outlayer.prototype[ methodName ].apply( this.isotope, arguments );\n\t\t\t};\n\t\t}\n\t);\n\n\t// -----  ----- //\n\t// for horizontal layout modes, check vertical size\n\tproto.needsVerticalResizeLayout = function() {\n\t\t// don't trigger if size did not change\n\t\tvar size = getSize( this.isotope.element );\n\t\t// check that this.size and size are there\n\t\t// IE8 triggers resize on body size change, so they might not be\n\t\tvar hasSizes = this.isotope.size && size;\n\t\treturn hasSizes && size.innerHeight != this.isotope.size.innerHeight;\n\t};\n\n\t// ----- measurements ----- //\n\tproto._getMeasurement = function() {\n\t\tthis.isotope._getMeasurement.apply( this, arguments );\n\t};\n\n\tproto.getColumnWidth = function() {\n\t\tthis.getSegmentSize( 'column', 'Width' );\n\t};\n\n\tproto.getRowHeight = function() {\n\t\tthis.getSegmentSize( 'row', 'Height' );\n\t};\n\n\t/**\n\t * get columnWidth or rowHeight\n\t * segment: 'column' or 'row'\n\t * size 'Width' or 'Height'\n\t**/\n\tproto.getSegmentSize = function( segment, size ) {\n\t\tvar segmentName = segment + size;\n\t\tvar outerSize   = 'outer' + size;\n\t\t// columnWidth / outerWidth // rowHeight / outerHeight\n\t\tthis._getMeasurement( segmentName, outerSize );\n\t\t// got rowHeight or columnWidth, we can chill\n\t\tif ( this[ segmentName ] ) {\n\t\t\treturn;\n\t\t}\n\t\t// fall back to item of first element\n\t\tvar firstItemSize   = this.getFirstItemSize();\n\t\tthis[ segmentName ] = firstItemSize && firstItemSize[ outerSize ] ||\n\t\t// or size of container\n\t\tthis.isotope.size[ 'inner' + size ];\n\t};\n\n\tproto.getFirstItemSize = function() {\n\t\tvar firstItem = this.isotope.filteredItems[0];\n\t\treturn firstItem && firstItem.element && getSize( firstItem.element );\n\t};\n\n\t// ----- methods that should reference isotope ----- //\n\tproto.layout = function() {\n\t\tthis.isotope.layout.apply( this.isotope, arguments );\n\t};\n\n\tproto.getSize = function() {\n\t\tthis.isotope.getSize();\n\t\tthis.size = this.isotope.size;\n\t};\n\n\t// -------------------------- create -------------------------- //\n\tLayoutMode.modes = {};\n\n\tLayoutMode.create = function( namespace, options ) {\n\n\t\tfunction Mode() {\n\t\t\tLayoutMode.apply( this, arguments );\n\t\t}\n\n\t\tMode.prototype             = Object.create( proto );\n\t\tMode.prototype.constructor = Mode;\n\n\t\t// default options\n\t\tif ( options ) {\n\t\t\tMode.options = options;\n\t\t}\n\n\t\tMode.prototype.namespace = namespace;\n\t\t// register in Isotope\n\t\tLayoutMode.modes[ namespace ] = Mode;\n\n\t\treturn Mode;\n\t};\n\n\treturn LayoutMode;\n\n}));\n","/**\n * fitRows layout mode\n */\n\n( function( window, factory ) {\n\t// universal module definition\n\t/* jshint strict: false */ /*globals define, module, require */\n\tif ( typeof define == 'function' && define.amd ) {\n\t\t// AMD\n\t\tdefine(\n\t\t\t[\n\t\t\t'../layout-mode'\n\t\t\t],\n\t\t\tfactory\n\t\t);\n\t} else if ( typeof exports == 'object' ) {\n\t\t// CommonJS\n\t\tmodule.exports = factory(\n\t\t\trequire( '../layout-mode' )\n\t\t);\n\t} else {\n\t\t// browser global\n\t\tfactory(\n\t\t\twindow.Isotope.LayoutMode\n\t\t);\n\t}\n\n}( window, function factory( LayoutMode ) {\n\t'use strict';\n\n\tvar FitRows = LayoutMode.create( 'fitRows' );\n\n\tvar proto = FitRows.prototype;\n\n\tproto._resetLayout = function() {\n\t\tthis.x    = 0;\n\t\tthis.y    = 0;\n\t\tthis.maxY = 0;\n\t\tthis._getMeasurement( 'gutter', 'outerWidth' );\n\t};\n\n\tproto._getItemLayoutPosition = function( item ) {\n\t\titem.getSize();\n\n\t\tvar itemWidth = item.size.outerWidth + this.gutter;\n\t\t// if this element cannot fit in the current row\n\t\tvar containerWidth = this.isotope.size.innerWidth + this.gutter;\n\t\tif ( this.x !== 0 && itemWidth + this.x > containerWidth ) {\n\t\t\tthis.x = 0;\n\t\t\tthis.y = this.maxY;\n\t\t}\n\n\t\tvar position = {\n\t\t\tx: this.x,\n\t\t\ty: this.y\n\t\t};\n\n\t\tthis.maxY = Math.max( this.maxY, this.y + item.size.outerHeight );\n\t\tthis.x   += itemWidth;\n\n\t\treturn position;\n\t};\n\n\tproto._getContainerSize = function() {\n\t\treturn { height: this.maxY };\n\t};\n\n\treturn FitRows;\n\n}));\n","/*!\n * Masonry layout mode\n * sub-classes Masonry\n * https://masonry.desandro.com\n */\n\n( function( window, factory ) {\n\t// universal module definition\n\t/* jshint strict: false */ /*globals define, module, require */\n\tif ( typeof define == 'function' && define.amd ) {\n\t\t// AMD\n\t\tdefine(\n\t\t\t[\n\t\t\t'../layout-mode',\n\t\t\t'masonry-layout/masonry'\n\t\t\t],\n\t\t\tfactory\n\t\t);\n\t} else if ( typeof module == 'object' && module.exports ) {\n\t\t// CommonJS\n\t\tmodule.exports = factory(\n\t\t\trequire( '../layout-mode' ),\n\t\t\trequire( 'masonry-layout' )\n\t\t);\n\t} else {\n\t\t// browser global\n\t\tfactory(\n\t\t\twindow.Isotope.LayoutMode,\n\t\t\twindow.Masonry\n\t\t);\n\t}\n\n}( window, function factory( LayoutMode, Masonry ) {\n\t'use strict';\n\n\t// -------------------------- masonryDefinition -------------------------- //\n\t// create an Outlayer layout class\n\tvar MasonryMode = LayoutMode.create( 'masonry' );\n\n\tvar proto = MasonryMode.prototype;\n\n\tvar keepModeMethods = {\n\t\t_getElementOffset: true,\n\t\tlayout: true,\n\t\t_getMeasurement: true\n\t};\n\n\t// inherit Masonry prototype\n\tfor ( var method in Masonry.prototype ) {\n\t\t// do not inherit mode methods\n\t\tif ( ! keepModeMethods[ method ] ) {\n\t\t\tproto[ method ] = Masonry.prototype[ method ];\n\t\t}\n\t}\n\n\tvar measureColumns   = proto.measureColumns;\n\tproto.measureColumns = function() {\n\t\t// set items, used if measuring first item\n\t\tthis.items = this.isotope.filteredItems;\n\t\tmeasureColumns.call( this );\n\t};\n\n\t// point to mode options for fitWidth\n\tvar _getOption   = proto._getOption;\n\tproto._getOption = function( option ) {\n\t\tif ( option == 'fitWidth' ) {\n\t\t\treturn this.options.isFitWidth !== undefined ?\n\t\t\tthis.options.isFitWidth : this.options.fitWidth;\n\t\t}\n\t\treturn _getOption.apply( this.isotope, arguments );\n\t};\n\n\treturn MasonryMode;\n\n}));\n","/**\n * vertical layout mode\n */\n\n( function( window, factory ) {\n\t// universal module definition\n\t/* jshint strict: false */ /*globals define, module, require */\n\tif ( typeof define == 'function' && define.amd ) {\n\t\t// AMD\n\t\tdefine(\n\t\t\t[\n\t\t\t'../layout-mode'\n\t\t\t],\n\t\t\tfactory\n\t\t);\n\t} else if ( typeof module == 'object' && module.exports ) {\n\t\t// CommonJS\n\t\tmodule.exports = factory(\n\t\t\trequire( '../layout-mode' )\n\t\t);\n\t} else {\n\t\t// browser global\n\t\tfactory(\n\t\t\twindow.Isotope.LayoutMode\n\t\t);\n\t}\n\n}( window, function factory( LayoutMode ) {\n\t'use strict';\n\n\tvar Vertical = LayoutMode.create(\n\t\t'vertical',\n\t\t{\n\t\t\thorizontalAlignment: 0\n\t\t}\n\t);\n\n\tvar proto = Vertical.prototype;\n\n\tproto._resetLayout = function() {\n\t\tthis.y = 0;\n\t};\n\n\tproto._getItemLayoutPosition = function( item ) {\n\t\titem.getSize();\n\t\tvar x   = ( this.isotope.size.innerWidth - item.size.outerWidth ) *\n\t\tthis.options.horizontalAlignment;\n\t\tvar y   = this.y;\n\t\tthis.y += item.size.outerHeight;\n\t\treturn { x: x, y: y };\n\t};\n\n\tproto._getContainerSize = function() {\n\t\treturn { height: this.y };\n\t};\n\n\treturn Vertical;\n\n}));\n","/*!\n * jQuery Mousewheel 3.1.13\n *\n * Copyright jQuery Foundation and other contributors\n * Released under the MIT license\n * http://jquery.org/license\n */\n\n(function (factory) {\n\tif ( typeof define === 'function' && define.amd ) {\n\t\t// AMD. Register as an anonymous module.\n\t\tdefine( ['jquery'], factory );\n\t} else if (typeof exports === 'object') {\n\t\t// Node/CommonJS style for Browserify\n\t\tmodule.exports = factory;\n\t} else {\n\t\t// Browser globals\n\t\tfactory( jQuery );\n\t}\n}(function ($) {\n\n\tvar toFix  = ['wheel', 'mousewheel', 'DOMMouseScroll', 'MozMousePixelScroll'],\n\t\ttoBind = ( 'onwheel' in document || document.documentMode >= 9 ) ?\n\t\t\t\t\t['wheel'] : ['mousewheel', 'DomMouseScroll', 'MozMousePixelScroll'],\n\t\tslice  = Array.prototype.slice,\n\t\tnullLowestDeltaTimeout, lowestDelta;\n\n\tif ( $.event.fixHooks ) {\n\t\tfor ( var i = toFix.length; i; ) {\n\t\t\t$.event.fixHooks[ toFix[--i] ] = $.event.mouseHooks;\n\t\t}\n\t}\n\n\tvar special = $.event.special.mousewheel = {\n\t\tversion: '3.1.12',\n\n\t\tsetup: function() {\n\t\t\tif ( this.addEventListener ) {\n\t\t\t\tfor ( var i = toBind.length; i; ) {\n\t\t\t\t\tthis.addEventListener( toBind[--i], handler, false );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.onmousewheel = handler;\n\t\t\t}\n\t\t\t// Store the line height and page height for this particular element\n\t\t\t$.data( this, 'mousewheel-line-height', special.getLineHeight( this ) );\n\t\t\t$.data( this, 'mousewheel-page-height', special.getPageHeight( this ) );\n\t\t},\n\n\t\tteardown: function() {\n\t\t\tif ( this.removeEventListener ) {\n\t\t\t\tfor ( var i = toBind.length; i; ) {\n\t\t\t\t\tthis.removeEventListener( toBind[--i], handler, false );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.onmousewheel = null;\n\t\t\t}\n\t\t\t// Clean up the data we added to the element\n\t\t\t$.removeData( this, 'mousewheel-line-height' );\n\t\t\t$.removeData( this, 'mousewheel-page-height' );\n\t\t},\n\n\t\tgetLineHeight: function(elem) {\n\t\t\tvar $elem   = $( elem ),\n\t\t\t\t$parent = $elem['offsetParent' in $.fn ? 'offsetParent' : 'parent']();\n\t\t\tif ( ! $parent.length) {\n\t\t\t\t$parent = $( 'body' );\n\t\t\t}\n\t\t\treturn parseInt( $parent.css( 'fontSize' ), 10 ) || parseInt( $elem.css( 'fontSize' ), 10 ) || 16;\n\t\t},\n\n\t\tgetPageHeight: function(elem) {\n\t\t\treturn $( elem ).height();\n\t\t},\n\n\t\tsettings: {\n\t\t\tadjustOldDeltas: true, // see shouldAdjustOldDeltas() below\n\t\t\tnormalizeOffset: true  // calls getBoundingClientRect for each event\n\t\t}\n\t};\n\n\t$.fn.extend(\n\t\t{\n\t\t\tmousewheel: function(fn) {\n\t\t\t\treturn fn ? this.bind( 'mousewheel', fn ) : this.trigger( 'mousewheel' );\n\t\t\t},\n\n\t\t\tunmousewheel: function(fn) {\n\t\t\t\treturn this.unbind( 'mousewheel', fn );\n\t\t\t}\n\t\t}\n\t);\n\n\tfunction handler(event) {\n\t\tvar orgEvent = event || window.event,\n\t\t\targs     = slice.call( arguments, 1 ),\n\t\t\tdelta    = 0,\n\t\t\tdeltaX   = 0,\n\t\t\tdeltaY   = 0,\n\t\t\tabsDelta = 0,\n\t\t\toffsetX  = 0,\n\t\t\toffsetY  = 0;\n\t\tevent        = $.event.fix( orgEvent );\n\t\tevent.type   = 'mousewheel';\n\n\t\t// Old school scrollwheel delta\n\t\tif ( 'detail'      in orgEvent ) {\n\t\t\tdeltaY = orgEvent.detail * -1;      }\n\t\tif ( 'wheelDelta'  in orgEvent ) {\n\t\t\tdeltaY = orgEvent.wheelDelta;       }\n\t\tif ( 'wheelDeltaY' in orgEvent ) {\n\t\t\tdeltaY = orgEvent.wheelDeltaY;      }\n\t\tif ( 'wheelDeltaX' in orgEvent ) {\n\t\t\tdeltaX = orgEvent.wheelDeltaX * -1; }\n\n\t\t// Firefox < 17 horizontal scrolling related to DOMMouseScroll event\n\t\tif ( 'axis' in orgEvent && orgEvent.axis === orgEvent.HORIZONTAL_AXIS ) {\n\t\t\tdeltaX = deltaY * -1;\n\t\t\tdeltaY = 0;\n\t\t}\n\n\t\t// Set delta to be deltaY or deltaX if deltaY is 0 for backwards compatabilitiy\n\t\tdelta = deltaY === 0 ? deltaX : deltaY;\n\n\t\t// New school wheel delta (wheel event)\n\t\tif ( 'deltaY' in orgEvent ) {\n\t\t\tdeltaY = orgEvent.deltaY * -1;\n\t\t\tdelta  = deltaY;\n\t\t}\n\t\tif ( 'deltaX' in orgEvent ) {\n\t\t\tdeltaX = orgEvent.deltaX;\n\t\t\tif ( deltaY === 0 ) {\n\t\t\t\tdelta = deltaX * -1; }\n\t\t}\n\n\t\t// No change actually happened, no reason to go any further\n\t\tif ( deltaY === 0 && deltaX === 0 ) {\n\t\t\treturn; }\n\n\t\t// Need to convert lines and pages to pixels if we aren't already in pixels\n\t\t// There are three delta modes:\n\t\t// * deltaMode 0 is by pixels, nothing to do\n\t\t// * deltaMode 1 is by lines\n\t\t// * deltaMode 2 is by pages\n\t\tif ( orgEvent.deltaMode === 1 ) {\n\t\t\tvar lineHeight = $.data( this, 'mousewheel-line-height' );\n\t\t\tdelta         *= lineHeight;\n\t\t\tdeltaY        *= lineHeight;\n\t\t\tdeltaX        *= lineHeight;\n\t\t} else if ( orgEvent.deltaMode === 2 ) {\n\t\t\tvar pageHeight = $.data( this, 'mousewheel-page-height' );\n\t\t\tdelta         *= pageHeight;\n\t\t\tdeltaY        *= pageHeight;\n\t\t\tdeltaX        *= pageHeight;\n\t\t}\n\n\t\t// Store lowest absolute delta to normalize the delta values\n\t\tabsDelta = Math.max( Math.abs( deltaY ), Math.abs( deltaX ) );\n\n\t\tif ( ! lowestDelta || absDelta < lowestDelta ) {\n\t\t\tlowestDelta = absDelta;\n\n\t\t\t// Adjust older deltas if necessary\n\t\t\tif ( shouldAdjustOldDeltas( orgEvent, absDelta ) ) {\n\t\t\t\tlowestDelta /= 40;\n\t\t\t}\n\t\t}\n\n\t\t// Adjust older deltas if necessary\n\t\tif ( shouldAdjustOldDeltas( orgEvent, absDelta ) ) {\n\t\t\t// Divide all the things by 40!\n\t\t\tdelta  /= 40;\n\t\t\tdeltaX /= 40;\n\t\t\tdeltaY /= 40;\n\t\t}\n\n\t\t// Get a whole, normalized value for the deltas\n\t\tdelta  = Math[ delta >= 1 ? 'floor' : 'ceil' ](delta / lowestDelta);\n\t\tdeltaX = Math[ deltaX >= 1 ? 'floor' : 'ceil' ](deltaX / lowestDelta);\n\t\tdeltaY = Math[ deltaY >= 1 ? 'floor' : 'ceil' ](deltaY / lowestDelta);\n\n\t\t// Normalise offsetX and offsetY properties\n\t\tif ( special.settings.normalizeOffset && this.getBoundingClientRect ) {\n\t\t\tvar boundingRect = this.getBoundingClientRect();\n\t\t\toffsetX          = event.clientX - boundingRect.left;\n\t\t\toffsetY          = event.clientY - boundingRect.top;\n\t\t}\n\n\t\t// Add information to the event object\n\t\tevent.deltaX      = deltaX;\n\t\tevent.deltaY      = deltaY;\n\t\tevent.deltaFactor = lowestDelta;\n\t\tevent.offsetX     = offsetX;\n\t\tevent.offsetY     = offsetY;\n\t\t// Go ahead and set deltaMode to 0 since we converted to pixels\n\t\t// Although this is a little odd since we overwrite the deltaX/Y\n\t\t// properties with normalized deltas.\n\t\tevent.deltaMode = 0;\n\n\t\t// Add event and delta to the front of the arguments\n\t\targs.unshift( event, delta, deltaX, deltaY );\n\n\t\t// Clearout lowestDelta after sometime to better\n\t\t// handle multiple device types that give different\n\t\t// a different lowestDelta\n\t\t// Ex: trackpad = 3 and mouse wheel = 120\n\t\tif (nullLowestDeltaTimeout) {\n\t\t\tclearTimeout( nullLowestDeltaTimeout ); }\n\t\tnullLowestDeltaTimeout = setTimeout( nullLowestDelta, 200 );\n\n\t\treturn ($.event.dispatch || $.event.handle).apply( this, args );\n\t}\n\n\tfunction nullLowestDelta() {\n\t\tlowestDelta = null;\n\t}\n\n\tfunction shouldAdjustOldDeltas(orgEvent, absDelta) {\n\t\t// If this is an older event and the delta is divisable by 120,\n\t\t// then we are assuming that the browser is treating this as an\n\t\t// older mouse wheel event and that we should divide the deltas\n\t\t// by 40 to try and get a more usable deltaFactor.\n\t\t// Side note, this actually impacts the reported scroll distance\n\t\t// in older browsers and can cause scrolling to be slower than native.\n\t\t// Turn this off by setting $.event.special.mousewheel.settings.adjustOldDeltas to false.\n\t\treturn special.settings.adjustOldDeltas && orgEvent.type === 'mousewheel' && absDelta % 120 === 0;\n\t}\n\n}));\n","/*!\n * Envira Pollyfills\n */\n\n/* add compatible Object.entries support for IE 11 */\n\nif ( ! Object.entries) {\n\tObject.entries = function( obj ){\n\t\tvar ownProps = Object.keys( obj ),\n\t\ti            = ownProps.length,\n\t\tresArray     = new Array( i ); // preallocate the Array\n\t\twhile (i--) {\n\t\t\tresArray[i] = [ownProps[i], obj[ownProps[i]]];\n\t\t}\n\n\t\treturn resArray;\n\t};\n}\n","/**\n * matchesSelector v2.0.2\n * matchesSelector( element, '.selector' )\n * MIT license\n */\n\n/*jshint browser: true, strict: true, undef: true, unused: true */\n\n( function( window, factory ) {\n  /*global define: false, module: false */\n  'use strict';\n  // universal module definition\n  if ( typeof define == 'function' && define.amd ) {\n    // AMD\n    define( factory );\n  } else if ( typeof module == 'object' && module.exports ) {\n    // CommonJS\n    module.exports = factory();\n  } else {\n    // browser global\n    window.matchesSelector = factory();\n  }\n\n}( window, function factory() {\n  'use strict';\n\n  var matchesMethod = ( function() {\n    var ElemProto = window.Element.prototype;\n    // check for the standard method name first\n    if ( ElemProto.matches ) {\n      return 'matches';\n    }\n    // check un-prefixed\n    if ( ElemProto.matchesSelector ) {\n      return 'matchesSelector';\n    }\n    // check vendor prefixes\n    var prefixes = [ 'webkit', 'moz', 'ms', 'o' ];\n\n    for ( var i=0; i < prefixes.length; i++ ) {\n      var prefix = prefixes[i];\n      var method = prefix + 'MatchesSelector';\n      if ( ElemProto[ method ] ) {\n        return method;\n      }\n    }\n  })();\n\n  return function matchesSelector( elem, selector ) {\n    return elem[ matchesMethod ]( selector );\n  };\n\n}));\n","/**\n * EvEmitter v1.1.0\n * Lil' event emitter\n * MIT License\n */\n\n/* jshint unused: true, undef: true, strict: true */\n\n( function( global, factory ) {\n  // universal module definition\n  /* jshint strict: false */ /* globals define, module, window */\n  if ( typeof define == 'function' && define.amd ) {\n    // AMD - RequireJS\n    define( factory );\n  } else if ( typeof module == 'object' && module.exports ) {\n    // CommonJS - Browserify, Webpack\n    module.exports = factory();\n  } else {\n    // Browser globals\n    global.EvEmitter = factory();\n  }\n\n}( typeof window != 'undefined' ? window : this, function() {\n\n\"use strict\";\n\nfunction EvEmitter() {}\n\nvar proto = EvEmitter.prototype;\n\nproto.on = function( eventName, listener ) {\n  if ( !eventName || !listener ) {\n    return;\n  }\n  // set events hash\n  var events = this._events = this._events || {};\n  // set listeners array\n  var listeners = events[ eventName ] = events[ eventName ] || [];\n  // only add once\n  if ( listeners.indexOf( listener ) == -1 ) {\n    listeners.push( listener );\n  }\n\n  return this;\n};\n\nproto.once = function( eventName, listener ) {\n  if ( !eventName || !listener ) {\n    return;\n  }\n  // add event\n  this.on( eventName, listener );\n  // set once flag\n  // set onceEvents hash\n  var onceEvents = this._onceEvents = this._onceEvents || {};\n  // set onceListeners object\n  var onceListeners = onceEvents[ eventName ] = onceEvents[ eventName ] || {};\n  // set flag\n  onceListeners[ listener ] = true;\n\n  return this;\n};\n\nproto.off = function( eventName, listener ) {\n  var listeners = this._events && this._events[ eventName ];\n  if ( !listeners || !listeners.length ) {\n    return;\n  }\n  var index = listeners.indexOf( listener );\n  if ( index != -1 ) {\n    listeners.splice( index, 1 );\n  }\n\n  return this;\n};\n\nproto.emitEvent = function( eventName, args ) {\n  var listeners = this._events && this._events[ eventName ];\n  if ( !listeners || !listeners.length ) {\n    return;\n  }\n  // copy over to avoid interference if .off() in listener\n  listeners = listeners.slice(0);\n  args = args || [];\n  // once stuff\n  var onceListeners = this._onceEvents && this._onceEvents[ eventName ];\n\n  for ( var i=0; i < listeners.length; i++ ) {\n    var listener = listeners[i]\n    var isOnce = onceListeners && onceListeners[ listener ];\n    if ( isOnce ) {\n      // remove listener\n      // remove before trigger to prevent recursion\n      this.off( eventName, listener );\n      // unset once flag\n      delete onceListeners[ listener ];\n    }\n    // trigger listener\n    listener.apply( this, args );\n  }\n\n  return this;\n};\n\nproto.allOff = function() {\n  delete this._events;\n  delete this._onceEvents;\n};\n\nreturn EvEmitter;\n\n}));\n","/**\n * Fizzy UI utils v2.0.5\n * MIT license\n */\n\n/*jshint browser: true, undef: true, unused: true, strict: true */\n\n( function( window, factory ) {\n  // universal module definition\n  /*jshint strict: false */ /*globals define, module, require */\n\n  if ( typeof define == 'function' && define.amd ) {\n    // AMD\n    define( [\n      'desandro-matches-selector/matches-selector'\n    ], function( matchesSelector ) {\n      return factory( window, matchesSelector );\n    });\n  } else if ( typeof module == 'object' && module.exports ) {\n    // CommonJS\n    module.exports = factory(\n      window,\n      require('desandro-matches-selector')\n    );\n  } else {\n    // browser global\n    window.fizzyUIUtils = factory(\n      window,\n      window.matchesSelector\n    );\n  }\n\n}( window, function factory( window, matchesSelector ) {\n\n'use strict';\n\nvar utils = {};\n\n// ----- extend ----- //\n\n// extends objects\nutils.extend = function( a, b ) {\n  for ( var prop in b ) {\n    a[ prop ] = b[ prop ];\n  }\n  return a;\n};\n\n// ----- modulo ----- //\n\nutils.modulo = function( num, div ) {\n  return ( ( num % div ) + div ) % div;\n};\n\n// ----- makeArray ----- //\n\n// turn element or nodeList into an array\nutils.makeArray = function( obj ) {\n  var ary = [];\n  if ( Array.isArray( obj ) ) {\n    // use object if already an array\n    ary = obj;\n  } else if ( obj && typeof obj == 'object' &&\n    typeof obj.length == 'number' ) {\n    // convert nodeList to array\n    for ( var i=0; i < obj.length; i++ ) {\n      ary.push( obj[i] );\n    }\n  } else {\n    // array of single index\n    ary.push( obj );\n  }\n  return ary;\n};\n\n// ----- removeFrom ----- //\n\nutils.removeFrom = function( ary, obj ) {\n  var index = ary.indexOf( obj );\n  if ( index != -1 ) {\n    ary.splice( index, 1 );\n  }\n};\n\n// ----- getParent ----- //\n\nutils.getParent = function( elem, selector ) {\n  while ( elem.parentNode && elem != document.body ) {\n    elem = elem.parentNode;\n    if ( matchesSelector( elem, selector ) ) {\n      return elem;\n    }\n  }\n};\n\n// ----- getQueryElement ----- //\n\n// use element as selector string\nutils.getQueryElement = function( elem ) {\n  if ( typeof elem == 'string' ) {\n    return document.querySelector( elem );\n  }\n  return elem;\n};\n\n// ----- handleEvent ----- //\n\n// enable .ontype to trigger from .addEventListener( elem, 'type' )\nutils.handleEvent = function( event ) {\n  var method = 'on' + event.type;\n  if ( this[ method ] ) {\n    this[ method ]( event );\n  }\n};\n\n// ----- filterFindElements ----- //\n\nutils.filterFindElements = function( elems, selector ) {\n  // make array of elems\n  elems = utils.makeArray( elems );\n  var ffElems = [];\n\n  elems.forEach( function( elem ) {\n    // check that elem is an actual element\n    if ( !( elem instanceof HTMLElement ) ) {\n      return;\n    }\n    // add elem if no selector\n    if ( !selector ) {\n      ffElems.push( elem );\n      return;\n    }\n    // filter & find items if we have a selector\n    // filter\n    if ( matchesSelector( elem, selector ) ) {\n      ffElems.push( elem );\n    }\n    // find children\n    var childElems = elem.querySelectorAll( selector );\n    // concat childElems to filterFound array\n    for ( var i=0; i < childElems.length; i++ ) {\n      ffElems.push( childElems[i] );\n    }\n  });\n\n  return ffElems;\n};\n\n// ----- debounceMethod ----- //\n\nutils.debounceMethod = function( _class, methodName, threshold ) {\n  // original method\n  var method = _class.prototype[ methodName ];\n  var timeoutName = methodName + 'Timeout';\n\n  _class.prototype[ methodName ] = function() {\n    var timeout = this[ timeoutName ];\n    if ( timeout ) {\n      clearTimeout( timeout );\n    }\n    var args = arguments;\n\n    var _this = this;\n    this[ timeoutName ] = setTimeout( function() {\n      method.apply( _this, args );\n      delete _this[ timeoutName ];\n    }, threshold || 100 );\n  };\n};\n\n// ----- docReady ----- //\n\nutils.docReady = function( callback ) {\n  var readyState = document.readyState;\n  if ( readyState == 'complete' || readyState == 'interactive' ) {\n    // do async to allow for other scripts to run. metafizzy/flickity#441\n    setTimeout( callback );\n  } else {\n    document.addEventListener( 'DOMContentLoaded', callback );\n  }\n};\n\n// ----- htmlInit ----- //\n\n// http://jamesroberts.name/blog/2010/02/22/string-functions-for-javascript-trim-to-camel-case-to-dashed-and-to-underscore/\nutils.toDashed = function( str ) {\n  return str.replace( /(.)([A-Z])/g, function( match, $1, $2 ) {\n    return $1 + '-' + $2;\n  }).toLowerCase();\n};\n\nvar console = window.console;\n/**\n * allow user to initialize classes via [data-namespace] or .js-namespace class\n * htmlInit( Widget, 'widgetName' )\n * options are parsed from data-namespace-options\n */\nutils.htmlInit = function( WidgetClass, namespace ) {\n  utils.docReady( function() {\n    var dashedNamespace = utils.toDashed( namespace );\n    var dataAttr = 'data-' + dashedNamespace;\n    var dataAttrElems = document.querySelectorAll( '[' + dataAttr + ']' );\n    var jsDashElems = document.querySelectorAll( '.js-' + dashedNamespace );\n    var elems = utils.makeArray( dataAttrElems )\n      .concat( utils.makeArray( jsDashElems ) );\n    var dataOptionsAttr = dataAttr + '-options';\n    var jQuery = window.jQuery;\n\n    elems.forEach( function( elem ) {\n      var attr = elem.getAttribute( dataAttr ) ||\n        elem.getAttribute( dataOptionsAttr );\n      var options;\n      try {\n        options = attr && JSON.parse( attr );\n      } catch ( error ) {\n        // log error, do not initialize\n        if ( console ) {\n          console.error( 'Error parsing ' + dataAttr + ' on ' + elem.className +\n          ': ' + error );\n        }\n        return;\n      }\n      // initialize\n      var instance = new WidgetClass( elem, options );\n      // make available via $().data('namespace')\n      if ( jQuery ) {\n        jQuery.data( elem, namespace, instance );\n      }\n    });\n\n  });\n};\n\n// -----  ----- //\n\nreturn utils;\n\n}));\n","/*!\n * getSize v2.0.2\n * measure size of elements\n * MIT license\n */\n\n/*jshint browser: true, strict: true, undef: true, unused: true */\n/*global define: false, module: false, console: false */\n\n( function( window, factory ) {\n  'use strict';\n\n  if ( typeof define == 'function' && define.amd ) {\n    // AMD\n    define( function() {\n      return factory();\n    });\n  } else if ( typeof module == 'object' && module.exports ) {\n    // CommonJS\n    module.exports = factory();\n  } else {\n    // browser global\n    window.getSize = factory();\n  }\n\n})( window, function factory() {\n'use strict';\n\n// -------------------------- helpers -------------------------- //\n\n// get a number from a string, not a percentage\nfunction getStyleSize( value ) {\n  var num = parseFloat( value );\n  // not a percent like '100%', and a number\n  var isValid = value.indexOf('%') == -1 && !isNaN( num );\n  return isValid && num;\n}\n\nfunction noop() {}\n\nvar logError = typeof console == 'undefined' ? noop :\n  function( message ) {\n    console.error( message );\n  };\n\n// -------------------------- measurements -------------------------- //\n\nvar measurements = [\n  'paddingLeft',\n  'paddingRight',\n  'paddingTop',\n  'paddingBottom',\n  'marginLeft',\n  'marginRight',\n  'marginTop',\n  'marginBottom',\n  'borderLeftWidth',\n  'borderRightWidth',\n  'borderTopWidth',\n  'borderBottomWidth'\n];\n\nvar measurementsLength = measurements.length;\n\nfunction getZeroSize() {\n  var size = {\n    width: 0,\n    height: 0,\n    innerWidth: 0,\n    innerHeight: 0,\n    outerWidth: 0,\n    outerHeight: 0\n  };\n  for ( var i=0; i < measurementsLength; i++ ) {\n    var measurement = measurements[i];\n    size[ measurement ] = 0;\n  }\n  return size;\n}\n\n// -------------------------- getStyle -------------------------- //\n\n/**\n * getStyle, get style of element, check for Firefox bug\n * https://bugzilla.mozilla.org/show_bug.cgi?id=548397\n */\nfunction getStyle( elem ) {\n  var style = getComputedStyle( elem );\n  if ( !style ) {\n    logError( 'Style returned ' + style +\n      '. Are you running this code in a hidden iframe on Firefox? ' +\n      'See http://bit.ly/getsizebug1' );\n  }\n  return style;\n}\n\n// -------------------------- setup -------------------------- //\n\nvar isSetup = false;\n\nvar isBoxSizeOuter;\n\n/**\n * setup\n * check isBoxSizerOuter\n * do on first getSize() rather than on page load for Firefox bug\n */\nfunction setup() {\n  // setup once\n  if ( isSetup ) {\n    return;\n  }\n  isSetup = true;\n\n  // -------------------------- box sizing -------------------------- //\n\n  /**\n   * WebKit measures the outer-width on style.width on border-box elems\n   * IE & Firefox<29 measures the inner-width\n   */\n  var div = document.createElement('div');\n  div.style.width = '200px';\n  div.style.padding = '1px 2px 3px 4px';\n  div.style.borderStyle = 'solid';\n  div.style.borderWidth = '1px 2px 3px 4px';\n  div.style.boxSizing = 'border-box';\n\n  var body = document.body || document.documentElement;\n  body.appendChild( div );\n  var style = getStyle( div );\n\n  getSize.isBoxSizeOuter = isBoxSizeOuter = getStyleSize( style.width ) == 200;\n  body.removeChild( div );\n\n}\n\n// -------------------------- getSize -------------------------- //\n\nfunction getSize( elem ) {\n  setup();\n\n  // use querySeletor if elem is string\n  if ( typeof elem == 'string' ) {\n    elem = document.querySelector( elem );\n  }\n\n  // do not proceed on non-objects\n  if ( !elem || typeof elem != 'object' || !elem.nodeType ) {\n    return;\n  }\n\n  var style = getStyle( elem );\n\n  // if hidden, everything is 0\n  if ( style.display == 'none' ) {\n    return getZeroSize();\n  }\n\n  var size = {};\n  size.width = elem.offsetWidth;\n  size.height = elem.offsetHeight;\n\n  var isBorderBox = size.isBorderBox = style.boxSizing == 'border-box';\n\n  // get all measurements\n  for ( var i=0; i < measurementsLength; i++ ) {\n    var measurement = measurements[i];\n    var value = style[ measurement ];\n    var num = parseFloat( value );\n    // any 'auto', 'medium' value will be 0\n    size[ measurement ] = !isNaN( num ) ? num : 0;\n  }\n\n  var paddingWidth = size.paddingLeft + size.paddingRight;\n  var paddingHeight = size.paddingTop + size.paddingBottom;\n  var marginWidth = size.marginLeft + size.marginRight;\n  var marginHeight = size.marginTop + size.marginBottom;\n  var borderWidth = size.borderLeftWidth + size.borderRightWidth;\n  var borderHeight = size.borderTopWidth + size.borderBottomWidth;\n\n  var isBorderBoxSizeOuter = isBorderBox && isBoxSizeOuter;\n\n  // overwrite width and height if we can get it from style\n  var styleWidth = getStyleSize( style.width );\n  if ( styleWidth !== false ) {\n    size.width = styleWidth +\n      // add padding and border unless it's already including it\n      ( isBorderBoxSizeOuter ? 0 : paddingWidth + borderWidth );\n  }\n\n  var styleHeight = getStyleSize( style.height );\n  if ( styleHeight !== false ) {\n    size.height = styleHeight +\n      // add padding and border unless it's already including it\n      ( isBorderBoxSizeOuter ? 0 : paddingHeight + borderHeight );\n  }\n\n  size.innerWidth = size.width - ( paddingWidth + borderWidth );\n  size.innerHeight = size.height - ( paddingHeight + borderHeight );\n\n  size.outerWidth = size.width + marginWidth;\n  size.outerHeight = size.height + marginHeight;\n\n  return size;\n}\n\nreturn getSize;\n\n});\n","/*!\n * Masonry v4.2.0\n * Cascading grid layout library\n * http://masonry.desandro.com\n * MIT License\n * by David DeSandro\n */\n\n( function( window, factory ) {\n  // universal module definition\n  /* jshint strict: false */ /*globals define, module, require */\n  if ( typeof define == 'function' && define.amd ) {\n    // AMD\n    define( [\n        'outlayer/outlayer',\n        'get-size/get-size'\n      ],\n      factory );\n  } else if ( typeof module == 'object' && module.exports ) {\n    // CommonJS\n    module.exports = factory(\n      require('outlayer'),\n      require('get-size')\n    );\n  } else {\n    // browser global\n    window.Masonry = factory(\n      window.Outlayer,\n      window.getSize\n    );\n  }\n\n}( window, function factory( Outlayer, getSize ) {\n\n'use strict';\n\n// -------------------------- masonryDefinition -------------------------- //\n\n  // create an Outlayer layout class\n  var Masonry = Outlayer.create('masonry');\n  // isFitWidth -> fitWidth\n  Masonry.compatOptions.fitWidth = 'isFitWidth';\n\n  var proto = Masonry.prototype;\n\n  proto._resetLayout = function() {\n    this.getSize();\n    this._getMeasurement( 'columnWidth', 'outerWidth' );\n    this._getMeasurement( 'gutter', 'outerWidth' );\n    this.measureColumns();\n\n    // reset column Y\n    this.colYs = [];\n    for ( var i=0; i < this.cols; i++ ) {\n      this.colYs.push( 0 );\n    }\n\n    this.maxY = 0;\n    this.horizontalColIndex = 0;\n  };\n\n  proto.measureColumns = function() {\n    this.getContainerWidth();\n    // if columnWidth is 0, default to outerWidth of first item\n    if ( !this.columnWidth ) {\n      var firstItem = this.items[0];\n      var firstItemElem = firstItem && firstItem.element;\n      // columnWidth fall back to item of first element\n      this.columnWidth = firstItemElem && getSize( firstItemElem ).outerWidth ||\n        // if first elem has no width, default to size of container\n        this.containerWidth;\n    }\n\n    var columnWidth = this.columnWidth += this.gutter;\n\n    // calculate columns\n    var containerWidth = this.containerWidth + this.gutter;\n    var cols = containerWidth / columnWidth;\n    // fix rounding errors, typically with gutters\n    var excess = columnWidth - containerWidth % columnWidth;\n    // if overshoot is less than a pixel, round up, otherwise floor it\n    var mathMethod = excess && excess < 1 ? 'round' : 'floor';\n    cols = Math[ mathMethod ]( cols );\n    this.cols = Math.max( cols, 1 );\n  };\n\n  proto.getContainerWidth = function() {\n    // container is parent if fit width\n    var isFitWidth = this._getOption('fitWidth');\n    var container = isFitWidth ? this.element.parentNode : this.element;\n    // check that this.size and size are there\n    // IE8 triggers resize on body size change, so they might not be\n    var size = getSize( container );\n    this.containerWidth = size && size.innerWidth;\n  };\n\n  proto._getItemLayoutPosition = function( item ) {\n    item.getSize();\n    // how many columns does this brick span\n    var remainder = item.size.outerWidth % this.columnWidth;\n    var mathMethod = remainder && remainder < 1 ? 'round' : 'ceil';\n    // round if off by 1 pixel, otherwise use ceil\n    var colSpan = Math[ mathMethod ]( item.size.outerWidth / this.columnWidth );\n    colSpan = Math.min( colSpan, this.cols );\n    // use horizontal or top column position\n    var colPosMethod = this.options.horizontalOrder ?\n      '_getHorizontalColPosition' : '_getTopColPosition';\n    var colPosition = this[ colPosMethod ]( colSpan, item );\n    // position the brick\n    var position = {\n      x: this.columnWidth * colPosition.col,\n      y: colPosition.y\n    };\n    // apply setHeight to necessary columns\n    var setHeight = colPosition.y + item.size.outerHeight;\n    var setMax = colSpan + colPosition.col;\n    for ( var i = colPosition.col; i < setMax; i++ ) {\n      this.colYs[i] = setHeight;\n    }\n\n    return position;\n  };\n\n  proto._getTopColPosition = function( colSpan ) {\n    var colGroup = this._getTopColGroup( colSpan );\n    // get the minimum Y value from the columns\n    var minimumY = Math.min.apply( Math, colGroup );\n\n    return {\n      col: colGroup.indexOf( minimumY ),\n      y: minimumY,\n    };\n  };\n\n  /**\n   * @param {Number} colSpan - number of columns the element spans\n   * @returns {Array} colGroup\n   */\n  proto._getTopColGroup = function( colSpan ) {\n    if ( colSpan < 2 ) {\n      // if brick spans only one column, use all the column Ys\n      return this.colYs;\n    }\n\n    var colGroup = [];\n    // how many different places could this brick fit horizontally\n    var groupCount = this.cols + 1 - colSpan;\n    // for each group potential horizontal position\n    for ( var i = 0; i < groupCount; i++ ) {\n      colGroup[i] = this._getColGroupY( i, colSpan );\n    }\n    return colGroup;\n  };\n\n  proto._getColGroupY = function( col, colSpan ) {\n    if ( colSpan < 2 ) {\n      return this.colYs[ col ];\n    }\n    // make an array of colY values for that one group\n    var groupColYs = this.colYs.slice( col, col + colSpan );\n    // and get the max value of the array\n    return Math.max.apply( Math, groupColYs );\n  };\n\n  // get column position based on horizontal index. #873\n  proto._getHorizontalColPosition = function( colSpan, item ) {\n    var col = this.horizontalColIndex % this.cols;\n    var isOver = colSpan > 1 && col + colSpan > this.cols;\n    // shift to next row if item can't fit on current row\n    col = isOver ? 0 : col;\n    // don't let zero-size items take up space\n    var hasSize = item.size.outerWidth && item.size.outerHeight;\n    this.horizontalColIndex = hasSize ? col + colSpan : this.horizontalColIndex;\n\n    return {\n      col: col,\n      y: this._getColGroupY( col, colSpan ),\n    };\n  };\n\n  proto._manageStamp = function( stamp ) {\n    var stampSize = getSize( stamp );\n    var offset = this._getElementOffset( stamp );\n    // get the columns that this stamp affects\n    var isOriginLeft = this._getOption('originLeft');\n    var firstX = isOriginLeft ? offset.left : offset.right;\n    var lastX = firstX + stampSize.outerWidth;\n    var firstCol = Math.floor( firstX / this.columnWidth );\n    firstCol = Math.max( 0, firstCol );\n    var lastCol = Math.floor( lastX / this.columnWidth );\n    // lastCol should not go over if multiple of columnWidth #425\n    lastCol -= lastX % this.columnWidth ? 0 : 1;\n    lastCol = Math.min( this.cols - 1, lastCol );\n    // set colYs to bottom of the stamp\n\n    var isOriginTop = this._getOption('originTop');\n    var stampMaxY = ( isOriginTop ? offset.top : offset.bottom ) +\n      stampSize.outerHeight;\n    for ( var i = firstCol; i <= lastCol; i++ ) {\n      this.colYs[i] = Math.max( stampMaxY, this.colYs[i] );\n    }\n  };\n\n  proto._getContainerSize = function() {\n    this.maxY = Math.max.apply( Math, this.colYs );\n    var size = {\n      height: this.maxY\n    };\n\n    if ( this._getOption('fitWidth') ) {\n      size.width = this._getContainerFitWidth();\n    }\n\n    return size;\n  };\n\n  proto._getContainerFitWidth = function() {\n    var unusedCols = 0;\n    // count unused columns\n    var i = this.cols;\n    while ( --i ) {\n      if ( this.colYs[i] !== 0 ) {\n        break;\n      }\n      unusedCols++;\n    }\n    // fit container to columns that have been used\n    return ( this.cols - unusedCols ) * this.columnWidth - this.gutter;\n  };\n\n  proto.needsResizeLayout = function() {\n    var previousWidth = this.containerWidth;\n    this.getContainerWidth();\n    return previousWidth != this.containerWidth;\n  };\n\n  return Masonry;\n\n}));\n","/**\n * Outlayer Item\n */\n\n( function( window, factory ) {\n  // universal module definition\n  /* jshint strict: false */ /* globals define, module, require */\n  if ( typeof define == 'function' && define.amd ) {\n    // AMD - RequireJS\n    define( [\n        'ev-emitter/ev-emitter',\n        'get-size/get-size'\n      ],\n      factory\n    );\n  } else if ( typeof module == 'object' && module.exports ) {\n    // CommonJS - Browserify, Webpack\n    module.exports = factory(\n      require('ev-emitter'),\n      require('get-size')\n    );\n  } else {\n    // browser global\n    window.Outlayer = {};\n    window.Outlayer.Item = factory(\n      window.EvEmitter,\n      window.getSize\n    );\n  }\n\n}( window, function factory( EvEmitter, getSize ) {\n'use strict';\n\n// ----- helpers ----- //\n\nfunction isEmptyObj( obj ) {\n  for ( var prop in obj ) {\n    return false;\n  }\n  prop = null;\n  return true;\n}\n\n// -------------------------- CSS3 support -------------------------- //\n\n\nvar docElemStyle = document.documentElement.style;\n\nvar transitionProperty = typeof docElemStyle.transition == 'string' ?\n  'transition' : 'WebkitTransition';\nvar transformProperty = typeof docElemStyle.transform == 'string' ?\n  'transform' : 'WebkitTransform';\n\nvar transitionEndEvent = {\n  WebkitTransition: 'webkitTransitionEnd',\n  transition: 'transitionend'\n}[ transitionProperty ];\n\n// cache all vendor properties that could have vendor prefix\nvar vendorProperties = {\n  transform: transformProperty,\n  transition: transitionProperty,\n  transitionDuration: transitionProperty + 'Duration',\n  transitionProperty: transitionProperty + 'Property',\n  transitionDelay: transitionProperty + 'Delay'\n};\n\n// -------------------------- Item -------------------------- //\n\nfunction Item( element, layout ) {\n  if ( !element ) {\n    return;\n  }\n\n  this.element = element;\n  // parent layout class, i.e. Masonry, Isotope, or Packery\n  this.layout = layout;\n  this.position = {\n    x: 0,\n    y: 0\n  };\n\n  this._create();\n}\n\n// inherit EvEmitter\nvar proto = Item.prototype = Object.create( EvEmitter.prototype );\nproto.constructor = Item;\n\nproto._create = function() {\n  // transition objects\n  this._transn = {\n    ingProperties: {},\n    clean: {},\n    onEnd: {}\n  };\n\n  this.css({\n    position: 'absolute'\n  });\n};\n\n// trigger specified handler for event type\nproto.handleEvent = function( event ) {\n  var method = 'on' + event.type;\n  if ( this[ method ] ) {\n    this[ method ]( event );\n  }\n};\n\nproto.getSize = function() {\n  this.size = getSize( this.element );\n};\n\n/**\n * apply CSS styles to element\n * @param {Object} style\n */\nproto.css = function( style ) {\n  var elemStyle = this.element.style;\n\n  for ( var prop in style ) {\n    // use vendor property if available\n    var supportedProp = vendorProperties[ prop ] || prop;\n    elemStyle[ supportedProp ] = style[ prop ];\n  }\n};\n\n // measure position, and sets it\nproto.getPosition = function() {\n  var style = getComputedStyle( this.element );\n  var isOriginLeft = this.layout._getOption('originLeft');\n  var isOriginTop = this.layout._getOption('originTop');\n  var xValue = style[ isOriginLeft ? 'left' : 'right' ];\n  var yValue = style[ isOriginTop ? 'top' : 'bottom' ];\n  var x = parseFloat( xValue );\n  var y = parseFloat( yValue );\n  // convert percent to pixels\n  var layoutSize = this.layout.size;\n  if ( xValue.indexOf('%') != -1 ) {\n    x = ( x / 100 ) * layoutSize.width;\n  }\n  if ( yValue.indexOf('%') != -1 ) {\n    y = ( y / 100 ) * layoutSize.height;\n  }\n  // clean up 'auto' or other non-integer values\n  x = isNaN( x ) ? 0 : x;\n  y = isNaN( y ) ? 0 : y;\n  // remove padding from measurement\n  x -= isOriginLeft ? layoutSize.paddingLeft : layoutSize.paddingRight;\n  y -= isOriginTop ? layoutSize.paddingTop : layoutSize.paddingBottom;\n\n  this.position.x = x;\n  this.position.y = y;\n};\n\n// set settled position, apply padding\nproto.layoutPosition = function() {\n  var layoutSize = this.layout.size;\n  var style = {};\n  var isOriginLeft = this.layout._getOption('originLeft');\n  var isOriginTop = this.layout._getOption('originTop');\n\n  // x\n  var xPadding = isOriginLeft ? 'paddingLeft' : 'paddingRight';\n  var xProperty = isOriginLeft ? 'left' : 'right';\n  var xResetProperty = isOriginLeft ? 'right' : 'left';\n\n  var x = this.position.x + layoutSize[ xPadding ];\n  // set in percentage or pixels\n  style[ xProperty ] = this.getXValue( x );\n  // reset other property\n  style[ xResetProperty ] = '';\n\n  // y\n  var yPadding = isOriginTop ? 'paddingTop' : 'paddingBottom';\n  var yProperty = isOriginTop ? 'top' : 'bottom';\n  var yResetProperty = isOriginTop ? 'bottom' : 'top';\n\n  var y = this.position.y + layoutSize[ yPadding ];\n  // set in percentage or pixels\n  style[ yProperty ] = this.getYValue( y );\n  // reset other property\n  style[ yResetProperty ] = '';\n\n  this.css( style );\n  this.emitEvent( 'layout', [ this ] );\n};\n\nproto.getXValue = function( x ) {\n  var isHorizontal = this.layout._getOption('horizontal');\n  return this.layout.options.percentPosition && !isHorizontal ?\n    ( ( x / this.layout.size.width ) * 100 ) + '%' : x + 'px';\n};\n\nproto.getYValue = function( y ) {\n  var isHorizontal = this.layout._getOption('horizontal');\n  return this.layout.options.percentPosition && isHorizontal ?\n    ( ( y / this.layout.size.height ) * 100 ) + '%' : y + 'px';\n};\n\nproto._transitionTo = function( x, y ) {\n  this.getPosition();\n  // get current x & y from top/left\n  var curX = this.position.x;\n  var curY = this.position.y;\n\n  var didNotMove = x == this.position.x && y == this.position.y;\n\n  // save end position\n  this.setPosition( x, y );\n\n  // if did not move and not transitioning, just go to layout\n  if ( didNotMove && !this.isTransitioning ) {\n    this.layoutPosition();\n    return;\n  }\n\n  var transX = x - curX;\n  var transY = y - curY;\n  var transitionStyle = {};\n  transitionStyle.transform = this.getTranslate( transX, transY );\n\n  this.transition({\n    to: transitionStyle,\n    onTransitionEnd: {\n      transform: this.layoutPosition\n    },\n    isCleaning: true\n  });\n};\n\nproto.getTranslate = function( x, y ) {\n  // flip cooridinates if origin on right or bottom\n  var isOriginLeft = this.layout._getOption('originLeft');\n  var isOriginTop = this.layout._getOption('originTop');\n  x = isOriginLeft ? x : -x;\n  y = isOriginTop ? y : -y;\n  return 'translate3d(' + x + 'px, ' + y + 'px, 0)';\n};\n\n// non transition + transform support\nproto.goTo = function( x, y ) {\n  this.setPosition( x, y );\n  this.layoutPosition();\n};\n\nproto.moveTo = proto._transitionTo;\n\nproto.setPosition = function( x, y ) {\n  this.position.x = parseFloat( x );\n  this.position.y = parseFloat( y );\n};\n\n// ----- transition ----- //\n\n/**\n * @param {Object} style - CSS\n * @param {Function} onTransitionEnd\n */\n\n// non transition, just trigger callback\nproto._nonTransition = function( args ) {\n  this.css( args.to );\n  if ( args.isCleaning ) {\n    this._removeStyles( args.to );\n  }\n  for ( var prop in args.onTransitionEnd ) {\n    args.onTransitionEnd[ prop ].call( this );\n  }\n};\n\n/**\n * proper transition\n * @param {Object} args - arguments\n *   @param {Object} to - style to transition to\n *   @param {Object} from - style to start transition from\n *   @param {Boolean} isCleaning - removes transition styles after transition\n *   @param {Function} onTransitionEnd - callback\n */\nproto.transition = function( args ) {\n  // redirect to nonTransition if no transition duration\n  if ( !parseFloat( this.layout.options.transitionDuration ) ) {\n    this._nonTransition( args );\n    return;\n  }\n\n  var _transition = this._transn;\n  // keep track of onTransitionEnd callback by css property\n  for ( var prop in args.onTransitionEnd ) {\n    _transition.onEnd[ prop ] = args.onTransitionEnd[ prop ];\n  }\n  // keep track of properties that are transitioning\n  for ( prop in args.to ) {\n    _transition.ingProperties[ prop ] = true;\n    // keep track of properties to clean up when transition is done\n    if ( args.isCleaning ) {\n      _transition.clean[ prop ] = true;\n    }\n  }\n\n  // set from styles\n  if ( args.from ) {\n    this.css( args.from );\n    // force redraw. http://blog.alexmaccaw.com/css-transitions\n    var h = this.element.offsetHeight;\n    // hack for JSHint to hush about unused var\n    h = null;\n  }\n  // enable transition\n  this.enableTransition( args.to );\n  // set styles that are transitioning\n  this.css( args.to );\n\n  this.isTransitioning = true;\n\n};\n\n// dash before all cap letters, including first for\n// WebkitTransform => -webkit-transform\nfunction toDashedAll( str ) {\n  return str.replace( /([A-Z])/g, function( $1 ) {\n    return '-' + $1.toLowerCase();\n  });\n}\n\nvar transitionProps = 'opacity,' + toDashedAll( transformProperty );\n\nproto.enableTransition = function(/* style */) {\n  // HACK changing transitionProperty during a transition\n  // will cause transition to jump\n  if ( this.isTransitioning ) {\n    return;\n  }\n\n  // make `transition: foo, bar, baz` from style object\n  // HACK un-comment this when enableTransition can work\n  // while a transition is happening\n  // var transitionValues = [];\n  // for ( var prop in style ) {\n  //   // dash-ify camelCased properties like WebkitTransition\n  //   prop = vendorProperties[ prop ] || prop;\n  //   transitionValues.push( toDashedAll( prop ) );\n  // }\n  // munge number to millisecond, to match stagger\n  var duration = this.layout.options.transitionDuration;\n  duration = typeof duration == 'number' ? duration + 'ms' : duration;\n  // enable transition styles\n  this.css({\n    transitionProperty: transitionProps,\n    transitionDuration: duration,\n    transitionDelay: this.staggerDelay || 0\n  });\n  // listen for transition end event\n  this.element.addEventListener( transitionEndEvent, this, false );\n};\n\n// ----- events ----- //\n\nproto.onwebkitTransitionEnd = function( event ) {\n  this.ontransitionend( event );\n};\n\nproto.onotransitionend = function( event ) {\n  this.ontransitionend( event );\n};\n\n// properties that I munge to make my life easier\nvar dashedVendorProperties = {\n  '-webkit-transform': 'transform'\n};\n\nproto.ontransitionend = function( event ) {\n  // disregard bubbled events from children\n  if ( event.target !== this.element ) {\n    return;\n  }\n  var _transition = this._transn;\n  // get property name of transitioned property, convert to prefix-free\n  var propertyName = dashedVendorProperties[ event.propertyName ] || event.propertyName;\n\n  // remove property that has completed transitioning\n  delete _transition.ingProperties[ propertyName ];\n  // check if any properties are still transitioning\n  if ( isEmptyObj( _transition.ingProperties ) ) {\n    // all properties have completed transitioning\n    this.disableTransition();\n  }\n  // clean style\n  if ( propertyName in _transition.clean ) {\n    // clean up style\n    this.element.style[ event.propertyName ] = '';\n    delete _transition.clean[ propertyName ];\n  }\n  // trigger onTransitionEnd callback\n  if ( propertyName in _transition.onEnd ) {\n    var onTransitionEnd = _transition.onEnd[ propertyName ];\n    onTransitionEnd.call( this );\n    delete _transition.onEnd[ propertyName ];\n  }\n\n  this.emitEvent( 'transitionEnd', [ this ] );\n};\n\nproto.disableTransition = function() {\n  this.removeTransitionStyles();\n  this.element.removeEventListener( transitionEndEvent, this, false );\n  this.isTransitioning = false;\n};\n\n/**\n * removes style property from element\n * @param {Object} style\n**/\nproto._removeStyles = function( style ) {\n  // clean up transition styles\n  var cleanStyle = {};\n  for ( var prop in style ) {\n    cleanStyle[ prop ] = '';\n  }\n  this.css( cleanStyle );\n};\n\nvar cleanTransitionStyle = {\n  transitionProperty: '',\n  transitionDuration: '',\n  transitionDelay: ''\n};\n\nproto.removeTransitionStyles = function() {\n  // remove transition\n  this.css( cleanTransitionStyle );\n};\n\n// ----- stagger ----- //\n\nproto.stagger = function( delay ) {\n  delay = isNaN( delay ) ? 0 : delay;\n  this.staggerDelay = delay + 'ms';\n};\n\n// ----- show/hide/remove ----- //\n\n// remove element from DOM\nproto.removeElem = function() {\n  this.element.parentNode.removeChild( this.element );\n  // remove display: none\n  this.css({ display: '' });\n  this.emitEvent( 'remove', [ this ] );\n};\n\nproto.remove = function() {\n  // just remove element if no transition support or no transition\n  if ( !transitionProperty || !parseFloat( this.layout.options.transitionDuration ) ) {\n    this.removeElem();\n    return;\n  }\n\n  // start transition\n  this.once( 'transitionEnd', function() {\n    this.removeElem();\n  });\n  this.hide();\n};\n\nproto.reveal = function() {\n  delete this.isHidden;\n  // remove display: none\n  this.css({ display: '' });\n\n  var options = this.layout.options;\n\n  var onTransitionEnd = {};\n  var transitionEndProperty = this.getHideRevealTransitionEndProperty('visibleStyle');\n  onTransitionEnd[ transitionEndProperty ] = this.onRevealTransitionEnd;\n\n  this.transition({\n    from: options.hiddenStyle,\n    to: options.visibleStyle,\n    isCleaning: true,\n    onTransitionEnd: onTransitionEnd\n  });\n};\n\nproto.onRevealTransitionEnd = function() {\n  // check if still visible\n  // during transition, item may have been hidden\n  if ( !this.isHidden ) {\n    this.emitEvent('reveal');\n  }\n};\n\n/**\n * get style property use for hide/reveal transition end\n * @param {String} styleProperty - hiddenStyle/visibleStyle\n * @returns {String}\n */\nproto.getHideRevealTransitionEndProperty = function( styleProperty ) {\n  var optionStyle = this.layout.options[ styleProperty ];\n  // use opacity\n  if ( optionStyle.opacity ) {\n    return 'opacity';\n  }\n  // get first property\n  for ( var prop in optionStyle ) {\n    return prop;\n  }\n};\n\nproto.hide = function() {\n  // set flag\n  this.isHidden = true;\n  // remove display: none\n  this.css({ display: '' });\n\n  var options = this.layout.options;\n\n  var onTransitionEnd = {};\n  var transitionEndProperty = this.getHideRevealTransitionEndProperty('hiddenStyle');\n  onTransitionEnd[ transitionEndProperty ] = this.onHideTransitionEnd;\n\n  this.transition({\n    from: options.visibleStyle,\n    to: options.hiddenStyle,\n    // keep hidden stuff hidden\n    isCleaning: true,\n    onTransitionEnd: onTransitionEnd\n  });\n};\n\nproto.onHideTransitionEnd = function() {\n  // check if still hidden\n  // during transition, item may have been un-hidden\n  if ( this.isHidden ) {\n    this.css({ display: 'none' });\n    this.emitEvent('hide');\n  }\n};\n\nproto.destroy = function() {\n  this.css({\n    position: '',\n    left: '',\n    right: '',\n    top: '',\n    bottom: '',\n    transition: '',\n    transform: ''\n  });\n};\n\nreturn Item;\n\n}));\n","/*!\n * Outlayer v2.1.1\n * the brains and guts of a layout library\n * MIT license\n */\n\n( function( window, factory ) {\n  'use strict';\n  // universal module definition\n  /* jshint strict: false */ /* globals define, module, require */\n  if ( typeof define == 'function' && define.amd ) {\n    // AMD - RequireJS\n    define( [\n        'ev-emitter/ev-emitter',\n        'get-size/get-size',\n        'fizzy-ui-utils/utils',\n        './item'\n      ],\n      function( EvEmitter, getSize, utils, Item ) {\n        return factory( window, EvEmitter, getSize, utils, Item);\n      }\n    );\n  } else if ( typeof module == 'object' && module.exports ) {\n    // CommonJS - Browserify, Webpack\n    module.exports = factory(\n      window,\n      require('ev-emitter'),\n      require('get-size'),\n      require('fizzy-ui-utils'),\n      require('./item')\n    );\n  } else {\n    // browser global\n    window.Outlayer = factory(\n      window,\n      window.EvEmitter,\n      window.getSize,\n      window.fizzyUIUtils,\n      window.Outlayer.Item\n    );\n  }\n\n}( window, function factory( window, EvEmitter, getSize, utils, Item ) {\n'use strict';\n\n// ----- vars ----- //\n\nvar console = window.console;\nvar jQuery = window.jQuery;\nvar noop = function() {};\n\n// -------------------------- Outlayer -------------------------- //\n\n// globally unique identifiers\nvar GUID = 0;\n// internal store of all Outlayer intances\nvar instances = {};\n\n\n/**\n * @param {Element, String} element\n * @param {Object} options\n * @constructor\n */\nfunction Outlayer( element, options ) {\n  var queryElement = utils.getQueryElement( element );\n  if ( !queryElement ) {\n    if ( console ) {\n      console.error( 'Bad element for ' + this.constructor.namespace +\n        ': ' + ( queryElement || element ) );\n    }\n    return;\n  }\n  this.element = queryElement;\n  // add jQuery\n  if ( jQuery ) {\n    this.$element = jQuery( this.element );\n  }\n\n  // options\n  this.options = utils.extend( {}, this.constructor.defaults );\n  this.option( options );\n\n  // add id for Outlayer.getFromElement\n  var id = ++GUID;\n  this.element.outlayerGUID = id; // expando\n  instances[ id ] = this; // associate via id\n\n  // kick it off\n  this._create();\n\n  var isInitLayout = this._getOption('initLayout');\n  if ( isInitLayout ) {\n    this.layout();\n  }\n}\n\n// settings are for internal use only\nOutlayer.namespace = 'outlayer';\nOutlayer.Item = Item;\n\n// default options\nOutlayer.defaults = {\n  containerStyle: {\n    position: 'relative'\n  },\n  initLayout: true,\n  originLeft: true,\n  originTop: true,\n  resize: true,\n  resizeContainer: true,\n  // item options\n  transitionDuration: '0.4s',\n  hiddenStyle: {\n    opacity: 0,\n    transform: 'scale(0.001)'\n  },\n  visibleStyle: {\n    opacity: 1,\n    transform: 'scale(1)'\n  }\n};\n\nvar proto = Outlayer.prototype;\n// inherit EvEmitter\nutils.extend( proto, EvEmitter.prototype );\n\n/**\n * set options\n * @param {Object} opts\n */\nproto.option = function( opts ) {\n  utils.extend( this.options, opts );\n};\n\n/**\n * get backwards compatible option value, check old name\n */\nproto._getOption = function( option ) {\n  var oldOption = this.constructor.compatOptions[ option ];\n  return oldOption && this.options[ oldOption ] !== undefined ?\n    this.options[ oldOption ] : this.options[ option ];\n};\n\nOutlayer.compatOptions = {\n  // currentName: oldName\n  initLayout: 'isInitLayout',\n  horizontal: 'isHorizontal',\n  layoutInstant: 'isLayoutInstant',\n  originLeft: 'isOriginLeft',\n  originTop: 'isOriginTop',\n  resize: 'isResizeBound',\n  resizeContainer: 'isResizingContainer'\n};\n\nproto._create = function() {\n  // get items from children\n  this.reloadItems();\n  // elements that affect layout, but are not laid out\n  this.stamps = [];\n  this.stamp( this.options.stamp );\n  // set container style\n  utils.extend( this.element.style, this.options.containerStyle );\n\n  // bind resize method\n  var canBindResize = this._getOption('resize');\n  if ( canBindResize ) {\n    this.bindResize();\n  }\n};\n\n// goes through all children again and gets bricks in proper order\nproto.reloadItems = function() {\n  // collection of item elements\n  this.items = this._itemize( this.element.children );\n};\n\n\n/**\n * turn elements into Outlayer.Items to be used in layout\n * @param {Array or NodeList or HTMLElement} elems\n * @returns {Array} items - collection of new Outlayer Items\n */\nproto._itemize = function( elems ) {\n\n  var itemElems = this._filterFindItemElements( elems );\n  var Item = this.constructor.Item;\n\n  // create new Outlayer Items for collection\n  var items = [];\n  for ( var i=0; i < itemElems.length; i++ ) {\n    var elem = itemElems[i];\n    var item = new Item( elem, this );\n    items.push( item );\n  }\n\n  return items;\n};\n\n/**\n * get item elements to be used in layout\n * @param {Array or NodeList or HTMLElement} elems\n * @returns {Array} items - item elements\n */\nproto._filterFindItemElements = function( elems ) {\n  return utils.filterFindElements( elems, this.options.itemSelector );\n};\n\n/**\n * getter method for getting item elements\n * @returns {Array} elems - collection of item elements\n */\nproto.getItemElements = function() {\n  return this.items.map( function( item ) {\n    return item.element;\n  });\n};\n\n// ----- init & layout ----- //\n\n/**\n * lays out all items\n */\nproto.layout = function() {\n  this._resetLayout();\n  this._manageStamps();\n\n  // don't animate first layout\n  var layoutInstant = this._getOption('layoutInstant');\n  var isInstant = layoutInstant !== undefined ?\n    layoutInstant : !this._isLayoutInited;\n  this.layoutItems( this.items, isInstant );\n\n  // flag for initalized\n  this._isLayoutInited = true;\n};\n\n// _init is alias for layout\nproto._init = proto.layout;\n\n/**\n * logic before any new layout\n */\nproto._resetLayout = function() {\n  this.getSize();\n};\n\n\nproto.getSize = function() {\n  this.size = getSize( this.element );\n};\n\n/**\n * get measurement from option, for columnWidth, rowHeight, gutter\n * if option is String -> get element from selector string, & get size of element\n * if option is Element -> get size of element\n * else use option as a number\n *\n * @param {String} measurement\n * @param {String} size - width or height\n * @private\n */\nproto._getMeasurement = function( measurement, size ) {\n  var option = this.options[ measurement ];\n  var elem;\n  if ( !option ) {\n    // default to 0\n    this[ measurement ] = 0;\n  } else {\n    // use option as an element\n    if ( typeof option == 'string' ) {\n      elem = this.element.querySelector( option );\n    } else if ( option instanceof HTMLElement ) {\n      elem = option;\n    }\n    // use size of element, if element\n    this[ measurement ] = elem ? getSize( elem )[ size ] : option;\n  }\n};\n\n/**\n * layout a collection of item elements\n * @api public\n */\nproto.layoutItems = function( items, isInstant ) {\n  items = this._getItemsForLayout( items );\n\n  this._layoutItems( items, isInstant );\n\n  this._postLayout();\n};\n\n/**\n * get the items to be laid out\n * you may want to skip over some items\n * @param {Array} items\n * @returns {Array} items\n */\nproto._getItemsForLayout = function( items ) {\n  return items.filter( function( item ) {\n    return !item.isIgnored;\n  });\n};\n\n/**\n * layout items\n * @param {Array} items\n * @param {Boolean} isInstant\n */\nproto._layoutItems = function( items, isInstant ) {\n  this._emitCompleteOnItems( 'layout', items );\n\n  if ( !items || !items.length ) {\n    // no items, emit event with empty array\n    return;\n  }\n\n  var queue = [];\n\n  items.forEach( function( item ) {\n    // get x/y object from method\n    var position = this._getItemLayoutPosition( item );\n    // enqueue\n    position.item = item;\n    position.isInstant = isInstant || item.isLayoutInstant;\n    queue.push( position );\n  }, this );\n\n  this._processLayoutQueue( queue );\n};\n\n/**\n * get item layout position\n * @param {Outlayer.Item} item\n * @returns {Object} x and y position\n */\nproto._getItemLayoutPosition = function( /* item */ ) {\n  return {\n    x: 0,\n    y: 0\n  };\n};\n\n/**\n * iterate over array and position each item\n * Reason being - separating this logic prevents 'layout invalidation'\n * thx @paul_irish\n * @param {Array} queue\n */\nproto._processLayoutQueue = function( queue ) {\n  this.updateStagger();\n  queue.forEach( function( obj, i ) {\n    this._positionItem( obj.item, obj.x, obj.y, obj.isInstant, i );\n  }, this );\n};\n\n// set stagger from option in milliseconds number\nproto.updateStagger = function() {\n  var stagger = this.options.stagger;\n  if ( stagger === null || stagger === undefined ) {\n    this.stagger = 0;\n    return;\n  }\n  this.stagger = getMilliseconds( stagger );\n  return this.stagger;\n};\n\n/**\n * Sets position of item in DOM\n * @param {Outlayer.Item} item\n * @param {Number} x - horizontal position\n * @param {Number} y - vertical position\n * @param {Boolean} isInstant - disables transitions\n */\nproto._positionItem = function( item, x, y, isInstant, i ) {\n  if ( isInstant ) {\n    // if not transition, just set CSS\n    item.goTo( x, y );\n  } else {\n    item.stagger( i * this.stagger );\n    item.moveTo( x, y );\n  }\n};\n\n/**\n * Any logic you want to do after each layout,\n * i.e. size the container\n */\nproto._postLayout = function() {\n  this.resizeContainer();\n};\n\nproto.resizeContainer = function() {\n  var isResizingContainer = this._getOption('resizeContainer');\n  if ( !isResizingContainer ) {\n    return;\n  }\n  var size = this._getContainerSize();\n  if ( size ) {\n    this._setContainerMeasure( size.width, true );\n    this._setContainerMeasure( size.height, false );\n  }\n};\n\n/**\n * Sets width or height of container if returned\n * @returns {Object} size\n *   @param {Number} width\n *   @param {Number} height\n */\nproto._getContainerSize = noop;\n\n/**\n * @param {Number} measure - size of width or height\n * @param {Boolean} isWidth\n */\nproto._setContainerMeasure = function( measure, isWidth ) {\n  if ( measure === undefined ) {\n    return;\n  }\n\n  var elemSize = this.size;\n  // add padding and border width if border box\n  if ( elemSize.isBorderBox ) {\n    measure += isWidth ? elemSize.paddingLeft + elemSize.paddingRight +\n      elemSize.borderLeftWidth + elemSize.borderRightWidth :\n      elemSize.paddingBottom + elemSize.paddingTop +\n      elemSize.borderTopWidth + elemSize.borderBottomWidth;\n  }\n\n  measure = Math.max( measure, 0 );\n  this.element.style[ isWidth ? 'width' : 'height' ] = measure + 'px';\n};\n\n/**\n * emit eventComplete on a collection of items events\n * @param {String} eventName\n * @param {Array} items - Outlayer.Items\n */\nproto._emitCompleteOnItems = function( eventName, items ) {\n  var _this = this;\n  function onComplete() {\n    _this.dispatchEvent( eventName + 'Complete', null, [ items ] );\n  }\n\n  var count = items.length;\n  if ( !items || !count ) {\n    onComplete();\n    return;\n  }\n\n  var doneCount = 0;\n  function tick() {\n    doneCount++;\n    if ( doneCount == count ) {\n      onComplete();\n    }\n  }\n\n  // bind callback\n  items.forEach( function( item ) {\n    item.once( eventName, tick );\n  });\n};\n\n/**\n * emits events via EvEmitter and jQuery events\n * @param {String} type - name of event\n * @param {Event} event - original event\n * @param {Array} args - extra arguments\n */\nproto.dispatchEvent = function( type, event, args ) {\n  // add original event to arguments\n  var emitArgs = event ? [ event ].concat( args ) : args;\n  this.emitEvent( type, emitArgs );\n\n  if ( jQuery ) {\n    // set this.$element\n    this.$element = this.$element || jQuery( this.element );\n    if ( event ) {\n      // create jQuery event\n      var $event = jQuery.Event( event );\n      $event.type = type;\n      this.$element.trigger( $event, args );\n    } else {\n      // just trigger with type if no event available\n      this.$element.trigger( type, args );\n    }\n  }\n};\n\n// -------------------------- ignore & stamps -------------------------- //\n\n\n/**\n * keep item in collection, but do not lay it out\n * ignored items do not get skipped in layout\n * @param {Element} elem\n */\nproto.ignore = function( elem ) {\n  var item = this.getItem( elem );\n  if ( item ) {\n    item.isIgnored = true;\n  }\n};\n\n/**\n * return item to layout collection\n * @param {Element} elem\n */\nproto.unignore = function( elem ) {\n  var item = this.getItem( elem );\n  if ( item ) {\n    delete item.isIgnored;\n  }\n};\n\n/**\n * adds elements to stamps\n * @param {NodeList, Array, Element, or String} elems\n */\nproto.stamp = function( elems ) {\n  elems = this._find( elems );\n  if ( !elems ) {\n    return;\n  }\n\n  this.stamps = this.stamps.concat( elems );\n  // ignore\n  elems.forEach( this.ignore, this );\n};\n\n/**\n * removes elements to stamps\n * @param {NodeList, Array, or Element} elems\n */\nproto.unstamp = function( elems ) {\n  elems = this._find( elems );\n  if ( !elems ){\n    return;\n  }\n\n  elems.forEach( function( elem ) {\n    // filter out removed stamp elements\n    utils.removeFrom( this.stamps, elem );\n    this.unignore( elem );\n  }, this );\n};\n\n/**\n * finds child elements\n * @param {NodeList, Array, Element, or String} elems\n * @returns {Array} elems\n */\nproto._find = function( elems ) {\n  if ( !elems ) {\n    return;\n  }\n  // if string, use argument as selector string\n  if ( typeof elems == 'string' ) {\n    elems = this.element.querySelectorAll( elems );\n  }\n  elems = utils.makeArray( elems );\n  return elems;\n};\n\nproto._manageStamps = function() {\n  if ( !this.stamps || !this.stamps.length ) {\n    return;\n  }\n\n  this._getBoundingRect();\n\n  this.stamps.forEach( this._manageStamp, this );\n};\n\n// update boundingLeft / Top\nproto._getBoundingRect = function() {\n  // get bounding rect for container element\n  var boundingRect = this.element.getBoundingClientRect();\n  var size = this.size;\n  this._boundingRect = {\n    left: boundingRect.left + size.paddingLeft + size.borderLeftWidth,\n    top: boundingRect.top + size.paddingTop + size.borderTopWidth,\n    right: boundingRect.right - ( size.paddingRight + size.borderRightWidth ),\n    bottom: boundingRect.bottom - ( size.paddingBottom + size.borderBottomWidth )\n  };\n};\n\n/**\n * @param {Element} stamp\n**/\nproto._manageStamp = noop;\n\n/**\n * get x/y position of element relative to container element\n * @param {Element} elem\n * @returns {Object} offset - has left, top, right, bottom\n */\nproto._getElementOffset = function( elem ) {\n  var boundingRect = elem.getBoundingClientRect();\n  var thisRect = this._boundingRect;\n  var size = getSize( elem );\n  var offset = {\n    left: boundingRect.left - thisRect.left - size.marginLeft,\n    top: boundingRect.top - thisRect.top - size.marginTop,\n    right: thisRect.right - boundingRect.right - size.marginRight,\n    bottom: thisRect.bottom - boundingRect.bottom - size.marginBottom\n  };\n  return offset;\n};\n\n// -------------------------- resize -------------------------- //\n\n// enable event handlers for listeners\n// i.e. resize -> onresize\nproto.handleEvent = utils.handleEvent;\n\n/**\n * Bind layout to window resizing\n */\nproto.bindResize = function() {\n  window.addEventListener( 'resize', this );\n  this.isResizeBound = true;\n};\n\n/**\n * Unbind layout to window resizing\n */\nproto.unbindResize = function() {\n  window.removeEventListener( 'resize', this );\n  this.isResizeBound = false;\n};\n\nproto.onresize = function() {\n  this.resize();\n};\n\nutils.debounceMethod( Outlayer, 'onresize', 100 );\n\nproto.resize = function() {\n  // don't trigger if size did not change\n  // or if resize was unbound. See #9\n  if ( !this.isResizeBound || !this.needsResizeLayout() ) {\n    return;\n  }\n\n  this.layout();\n};\n\n/**\n * check if layout is needed post layout\n * @returns Boolean\n */\nproto.needsResizeLayout = function() {\n  var size = getSize( this.element );\n  // check that this.size and size are there\n  // IE8 triggers resize on body size change, so they might not be\n  var hasSizes = this.size && size;\n  return hasSizes && size.innerWidth !== this.size.innerWidth;\n};\n\n// -------------------------- methods -------------------------- //\n\n/**\n * add items to Outlayer instance\n * @param {Array or NodeList or Element} elems\n * @returns {Array} items - Outlayer.Items\n**/\nproto.addItems = function( elems ) {\n  var items = this._itemize( elems );\n  // add items to collection\n  if ( items.length ) {\n    this.items = this.items.concat( items );\n  }\n  return items;\n};\n\n/**\n * Layout newly-appended item elements\n * @param {Array or NodeList or Element} elems\n */\nproto.appended = function( elems ) {\n  var items = this.addItems( elems );\n  if ( !items.length ) {\n    return;\n  }\n  // layout and reveal just the new items\n  this.layoutItems( items, true );\n  this.reveal( items );\n};\n\n/**\n * Layout prepended elements\n * @param {Array or NodeList or Element} elems\n */\nproto.prepended = function( elems ) {\n  var items = this._itemize( elems );\n  if ( !items.length ) {\n    return;\n  }\n  // add items to beginning of collection\n  var previousItems = this.items.slice(0);\n  this.items = items.concat( previousItems );\n  // start new layout\n  this._resetLayout();\n  this._manageStamps();\n  // layout new stuff without transition\n  this.layoutItems( items, true );\n  this.reveal( items );\n  // layout previous items\n  this.layoutItems( previousItems );\n};\n\n/**\n * reveal a collection of items\n * @param {Array of Outlayer.Items} items\n */\nproto.reveal = function( items ) {\n  this._emitCompleteOnItems( 'reveal', items );\n  if ( !items || !items.length ) {\n    return;\n  }\n  var stagger = this.updateStagger();\n  items.forEach( function( item, i ) {\n    item.stagger( i * stagger );\n    item.reveal();\n  });\n};\n\n/**\n * hide a collection of items\n * @param {Array of Outlayer.Items} items\n */\nproto.hide = function( items ) {\n  this._emitCompleteOnItems( 'hide', items );\n  if ( !items || !items.length ) {\n    return;\n  }\n  var stagger = this.updateStagger();\n  items.forEach( function( item, i ) {\n    item.stagger( i * stagger );\n    item.hide();\n  });\n};\n\n/**\n * reveal item elements\n * @param {Array}, {Element}, {NodeList} items\n */\nproto.revealItemElements = function( elems ) {\n  var items = this.getItems( elems );\n  this.reveal( items );\n};\n\n/**\n * hide item elements\n * @param {Array}, {Element}, {NodeList} items\n */\nproto.hideItemElements = function( elems ) {\n  var items = this.getItems( elems );\n  this.hide( items );\n};\n\n/**\n * get Outlayer.Item, given an Element\n * @param {Element} elem\n * @param {Function} callback\n * @returns {Outlayer.Item} item\n */\nproto.getItem = function( elem ) {\n  // loop through items to get the one that matches\n  for ( var i=0; i < this.items.length; i++ ) {\n    var item = this.items[i];\n    if ( item.element == elem ) {\n      // return item\n      return item;\n    }\n  }\n};\n\n/**\n * get collection of Outlayer.Items, given Elements\n * @param {Array} elems\n * @returns {Array} items - Outlayer.Items\n */\nproto.getItems = function( elems ) {\n  elems = utils.makeArray( elems );\n  var items = [];\n  elems.forEach( function( elem ) {\n    var item = this.getItem( elem );\n    if ( item ) {\n      items.push( item );\n    }\n  }, this );\n\n  return items;\n};\n\n/**\n * remove element(s) from instance and DOM\n * @param {Array or NodeList or Element} elems\n */\nproto.remove = function( elems ) {\n  var removeItems = this.getItems( elems );\n\n  this._emitCompleteOnItems( 'remove', removeItems );\n\n  // bail if no items to remove\n  if ( !removeItems || !removeItems.length ) {\n    return;\n  }\n\n  removeItems.forEach( function( item ) {\n    item.remove();\n    // remove item from collection\n    utils.removeFrom( this.items, item );\n  }, this );\n};\n\n// ----- destroy ----- //\n\n// remove and disable Outlayer instance\nproto.destroy = function() {\n  // clean up dynamic styles\n  var style = this.element.style;\n  style.height = '';\n  style.position = '';\n  style.width = '';\n  // destroy items\n  this.items.forEach( function( item ) {\n    item.destroy();\n  });\n\n  this.unbindResize();\n\n  var id = this.element.outlayerGUID;\n  delete instances[ id ]; // remove reference to instance by id\n  delete this.element.outlayerGUID;\n  // remove data for jQuery\n  if ( jQuery ) {\n    jQuery.removeData( this.element, this.constructor.namespace );\n  }\n\n};\n\n// -------------------------- data -------------------------- //\n\n/**\n * get Outlayer instance from element\n * @param {Element} elem\n * @returns {Outlayer}\n */\nOutlayer.data = function( elem ) {\n  elem = utils.getQueryElement( elem );\n  var id = elem && elem.outlayerGUID;\n  return id && instances[ id ];\n};\n\n\n// -------------------------- create Outlayer class -------------------------- //\n\n/**\n * create a layout class\n * @param {String} namespace\n */\nOutlayer.create = function( namespace, options ) {\n  // sub-class Outlayer\n  var Layout = subclass( Outlayer );\n  // apply new options and compatOptions\n  Layout.defaults = utils.extend( {}, Outlayer.defaults );\n  utils.extend( Layout.defaults, options );\n  Layout.compatOptions = utils.extend( {}, Outlayer.compatOptions  );\n\n  Layout.namespace = namespace;\n\n  Layout.data = Outlayer.data;\n\n  // sub-class Item\n  Layout.Item = subclass( Item );\n\n  // -------------------------- declarative -------------------------- //\n\n  utils.htmlInit( Layout, namespace );\n\n  // -------------------------- jQuery bridge -------------------------- //\n\n  // make into jQuery plugin\n  if ( jQuery && jQuery.bridget ) {\n    jQuery.bridget( namespace, Layout );\n  }\n\n  return Layout;\n};\n\nfunction subclass( Parent ) {\n  function SubClass() {\n    Parent.apply( this, arguments );\n  }\n\n  SubClass.prototype = Object.create( Parent.prototype );\n  SubClass.prototype.constructor = SubClass;\n\n  return SubClass;\n}\n\n// ----- helpers ----- //\n\n// how many milliseconds are in each unit\nvar msUnits = {\n  ms: 1,\n  s: 1000\n};\n\n// munge time-like parameter into millisecond number\n// '0.4s' -> 40\nfunction getMilliseconds( time ) {\n  if ( typeof time == 'number' ) {\n    return time;\n  }\n  var matches = time.match( /(^\\d*\\.?\\d*)(\\w*)/ );\n  var num = matches && matches[1];\n  var unit = matches && matches[2];\n  if ( !num.length ) {\n    return 0;\n  }\n  num = parseFloat( num );\n  var mult = msUnits[ unit ] || 1;\n  return num * mult;\n}\n\n// ----- fin ----- //\n\n// back in global\nOutlayer.Item = Item;\n\nreturn Outlayer;\n\n}));\n","module.exports = jQuery;"],"sourceRoot":""}